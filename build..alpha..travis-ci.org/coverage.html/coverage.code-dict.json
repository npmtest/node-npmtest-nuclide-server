{"/home/travis/build/npmtest/node-npmtest-nuclide-server/test.js":"/* istanbul instrument in package npmtest_nuclide_server */\n/*jslint\n    bitwise: true,\n    browser: true,\n    maxerr: 8,\n    maxlen: 96,\n    node: true,\n    nomen: true,\n    regexp: true,\n    stupid: true\n*/\n(function () {\n    'use strict';\n    var local;\n\n\n\n    // run shared js-env code - pre-init\n    (function () {\n        // init local\n        local = {};\n        // init modeJs\n        local.modeJs = (function () {\n            try {\n                return typeof navigator.userAgent === 'string' &&\n                    typeof document.querySelector('body') === 'object' &&\n                    typeof XMLHttpRequest.prototype.open === 'function' &&\n                    'browser';\n            } catch (errorCaughtBrowser) {\n                return module.exports &&\n                    typeof process.versions.node === 'string' &&\n                    typeof require('http').createServer === 'function' &&\n                    'node';\n            }\n        }());\n        // init global\n        local.global = local.modeJs === 'browser'\n            ? window\n            : global;\n        switch (local.modeJs) {\n        // re-init local from window.local\n        case 'browser':\n            local = local.global.utility2.objectSetDefault(\n                local.global.utility2_rollup || local.global.local,\n                local.global.utility2\n            );\n            break;\n        // re-init local from example.js\n        case 'node':\n            local = (local.global.utility2_rollup || require('utility2'))\n                .requireReadme();\n            break;\n        }\n        // export local\n        local.global.local = local;\n    }());\n\n\n\n    // run shared js-env code - function\n    (function () {\n        return;\n    }());\n    switch (local.modeJs) {\n\n\n\n    // run browser js-env code - function\n    case 'browser':\n        break;\n\n\n\n    // run node js-env code - function\n    case 'node':\n        break;\n    }\n\n\n\n    // run shared js-env code - post-init\n    (function () {\n        return;\n    }());\n    switch (local.modeJs) {\n\n\n\n    // run browser js-env code - post-init\n    case 'browser':\n        local.testCase_browser_nullCase = local.testCase_browser_nullCase || function (\n            options,\n            onError\n        ) {\n        /*\n         * this function will test browsers's null-case handling-behavior-behavior\n         */\n            onError(null, options);\n        };\n\n        // run tests\n        local.nop(local.modeTest &&\n            document.querySelector('#testRunButton1') &&\n            document.querySelector('#testRunButton1').click());\n        break;\n\n\n\n    // run node js-env code - post-init\n    /* istanbul ignore next */\n    case 'node':\n        local.testCase_buildApidoc_default = local.testCase_buildApidoc_default || function (\n            options,\n            onError\n        ) {\n        /*\n         * this function will test buildApidoc's default handling-behavior-behavior\n         */\n            options = { modulePathList: module.paths };\n            local.buildApidoc(options, onError);\n        };\n\n        local.testCase_buildApp_default = local.testCase_buildApp_default || function (\n            options,\n            onError\n        ) {\n        /*\n         * this function will test buildApp's default handling-behavior-behavior\n         */\n            local.testCase_buildReadme_default(options, local.onErrorThrow);\n            local.testCase_buildLib_default(options, local.onErrorThrow);\n            local.testCase_buildTest_default(options, local.onErrorThrow);\n            local.testCase_buildCustomOrg_default(options, local.onErrorThrow);\n            options = [];\n            local.buildApp(options, onError);\n        };\n\n        local.testCase_buildCustomOrg_default = local.testCase_buildCustomOrg_default ||\n            function (options, onError) {\n            /*\n             * this function will test buildCustomOrg's default handling-behavior\n             */\n                options = {};\n                local.buildCustomOrg(options, onError);\n            };\n\n        local.testCase_buildLib_default = local.testCase_buildLib_default || function (\n            options,\n            onError\n        ) {\n        /*\n         * this function will test buildLib's default handling-behavior\n         */\n            options = {};\n            local.buildLib(options, onError);\n        };\n\n        local.testCase_buildReadme_default = local.testCase_buildReadme_default || function (\n            options,\n            onError\n        ) {\n        /*\n         * this function will test buildReadme's default handling-behavior-behavior\n         */\n            options = {};\n            local.buildReadme(options, onError);\n        };\n\n        local.testCase_buildTest_default = local.testCase_buildTest_default || function (\n            options,\n            onError\n        ) {\n        /*\n         * this function will test buildTest's default handling-behavior\n         */\n            options = {};\n            local.buildTest(options, onError);\n        };\n\n        local.testCase_webpage_default = local.testCase_webpage_default || function (\n            options,\n            onError\n        ) {\n        /*\n         * this function will test webpage's default handling-behavior\n         */\n            options = { modeCoverageMerge: true, url: local.serverLocalHost + '?modeTest=1' };\n            local.browserTest(options, onError);\n        };\n\n        // run test-server\n        local.testRunServer(local);\n        break;\n    }\n}());\n","/home/travis/build/npmtest/node-npmtest-nuclide-server/lib.npmtest_nuclide_server.js":"/* istanbul instrument in package npmtest_nuclide_server */\n/*jslint\n    bitwise: true,\n    browser: true,\n    maxerr: 8,\n    maxlen: 96,\n    node: true,\n    nomen: true,\n    regexp: true,\n    stupid: true\n*/\n(function () {\n    'use strict';\n    var local;\n\n\n\n    // run shared js-env code - pre-init\n    (function () {\n        // init local\n        local = {};\n        // init modeJs\n        local.modeJs = (function () {\n            try {\n                return typeof navigator.userAgent === 'string' &&\n                    typeof document.querySelector('body') === 'object' &&\n                    typeof XMLHttpRequest.prototype.open === 'function' &&\n                    'browser';\n            } catch (errorCaughtBrowser) {\n                return module.exports &&\n                    typeof process.versions.node === 'string' &&\n                    typeof require('http').createServer === 'function' &&\n                    'node';\n            }\n        }());\n        // init global\n        local.global = local.modeJs === 'browser'\n            ? window\n            : global;\n        // init utility2_rollup\n        local = local.global.utility2_rollup || local;\n        // init lib\n        local.local = local.npmtest_nuclide_server = local;\n        // init exports\n        if (local.modeJs === 'browser') {\n            local.global.utility2_npmtest_nuclide_server = local;\n        } else {\n            module.exports = local;\n            module.exports.__dirname = __dirname;\n            module.exports.module = module;\n        }\n    }());\n}());\n","/home/travis/build/npmtest/node-npmtest-nuclide-server/example.js":"/*\nexample.js\n\nquickstart example\n\ninstruction\n    1. save this script as example.js\n    2. run the shell command:\n        $ npm install npmtest-nuclide-server && PORT=8081 node example.js\n    3. play with the browser-demo on http://127.0.0.1:8081\n*/\n\n\n\n/* istanbul instrument in package npmtest_nuclide_server */\n/*jslint\n    bitwise: true,\n    browser: true,\n    maxerr: 8,\n    maxlen: 96,\n    node: true,\n    nomen: true,\n    regexp: true,\n    stupid: true\n*/\n(function () {\n    'use strict';\n    var local;\n\n\n\n    // run shared js-env code - pre-init\n    (function () {\n        // init local\n        local = {};\n        // init modeJs\n        local.modeJs = (function () {\n            try {\n                return typeof navigator.userAgent === 'string' &&\n                    typeof document.querySelector('body') === 'object' &&\n                    typeof XMLHttpRequest.prototype.open === 'function' &&\n                    'browser';\n            } catch (errorCaughtBrowser) {\n                return module.exports &&\n                    typeof process.versions.node === 'string' &&\n                    typeof require('http').createServer === 'function' &&\n                    'node';\n            }\n        }());\n        // init global\n        local.global = local.modeJs === 'browser'\n            ? window\n            : global;\n        // init utility2_rollup\n        local = local.global.utility2_rollup || (local.modeJs === 'browser'\n            ? local.global.utility2_npmtest_nuclide_server\n            : global.utility2_moduleExports);\n        // export local\n        local.global.local = local;\n    }());\n    switch (local.modeJs) {\n\n\n\n    // post-init\n    // run browser js-env code - post-init\n    /* istanbul ignore next */\n    case 'browser':\n        local.testRunBrowser = function (event) {\n            if (!event || (event &&\n                    event.currentTarget &&\n                    event.currentTarget.className &&\n                    event.currentTarget.className.includes &&\n                    event.currentTarget.className.includes('onreset'))) {\n                // reset output\n                Array.from(\n                    document.querySelectorAll('body > .resettable')\n                ).forEach(function (element) {\n                    switch (element.tagName) {\n                    case 'INPUT':\n                    case 'TEXTAREA':\n                        element.value = '';\n                        break;\n                    default:\n                        element.textContent = '';\n                    }\n                });\n            }\n            switch (event && event.currentTarget && event.currentTarget.id) {\n            case 'testRunButton1':\n                // show tests\n                if (document.querySelector('#testReportDiv1').style.display === 'none') {\n                    document.querySelector('#testReportDiv1').style.display = 'block';\n                    document.querySelector('#testRunButton1').textContent =\n                        'hide internal test';\n                    local.modeTest = true;\n                    local.testRunDefault(local);\n                // hide tests\n                } else {\n                    document.querySelector('#testReportDiv1').style.display = 'none';\n                    document.querySelector('#testRunButton1').textContent = 'run internal test';\n                }\n                break;\n            // custom-case\n            default:\n                break;\n            }\n            if (document.querySelector('#inputTextareaEval1') && (!event || (event &&\n                    event.currentTarget &&\n                    event.currentTarget.className &&\n                    event.currentTarget.className.includes &&\n                    event.currentTarget.className.includes('oneval')))) {\n                // try to eval input-code\n                try {\n                    /*jslint evil: true*/\n                    eval(document.querySelector('#inputTextareaEval1').value);\n                } catch (errorCaught) {\n                    console.error(errorCaught);\n                }\n            }\n        };\n        // log stderr and stdout to #outputTextareaStdout1\n        ['error', 'log'].forEach(function (key) {\n            console[key + '_original'] = console[key];\n            console[key] = function () {\n                var element;\n                console[key + '_original'].apply(console, arguments);\n                element = document.querySelector('#outputTextareaStdout1');\n                if (!element) {\n                    return;\n                }\n                // append text to #outputTextareaStdout1\n                element.value += Array.from(arguments).map(function (arg) {\n                    return typeof arg === 'string'\n                        ? arg\n                        : JSON.stringify(arg, null, 4);\n                }).join(' ') + '\\n';\n                // scroll textarea to bottom\n                element.scrollTop = element.scrollHeight;\n            };\n        });\n        // init event-handling\n        ['change', 'click', 'keyup'].forEach(function (event) {\n            Array.from(document.querySelectorAll('.on' + event)).forEach(function (element) {\n                element.addEventListener(event, local.testRunBrowser);\n            });\n        });\n        // run tests\n        local.testRunBrowser();\n        break;\n\n\n\n    // run node js-env code - post-init\n    /* istanbul ignore next */\n    case 'node':\n        // export local\n        module.exports = local;\n        // require modules\n        local.fs = require('fs');\n        local.http = require('http');\n        local.url = require('url');\n        // init assets\n        local.assetsDict = local.assetsDict || {};\n        /* jslint-ignore-begin */\n        local.assetsDict['/assets.index.template.html'] = '\\\n<!doctype html>\\n\\\n<html lang=\"en\">\\n\\\n<head>\\n\\\n<meta charset=\"UTF-8\">\\n\\\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\\n\\\n<title>{{env.npm_package_name}} (v{{env.npm_package_version}})</title>\\n\\\n<style>\\n\\\n/*csslint\\n\\\n    box-sizing: false,\\n\\\n    universal-selector: false\\n\\\n*/\\n\\\n* {\\n\\\n    box-sizing: border-box;\\n\\\n}\\n\\\nbody {\\n\\\n    background: #dde;\\n\\\n    font-family: Arial, Helvetica, sans-serif;\\n\\\n    margin: 2rem;\\n\\\n}\\n\\\nbody > * {\\n\\\n    margin-bottom: 1rem;\\n\\\n}\\n\\\n.utility2FooterDiv {\\n\\\n    margin-top: 20px;\\n\\\n    text-align: center;\\n\\\n}\\n\\\n</style>\\n\\\n<style>\\n\\\n/*csslint\\n\\\n*/\\n\\\ntextarea {\\n\\\n    font-family: monospace;\\n\\\n    height: 10rem;\\n\\\n    width: 100%;\\n\\\n}\\n\\\ntextarea[readonly] {\\n\\\n    background: #ddd;\\n\\\n}\\n\\\n</style>\\n\\\n</head>\\n\\\n<body>\\n\\\n<!-- utility2-comment\\n\\\n<div id=\"ajaxProgressDiv1\" style=\"background: #d00; height: 2px; left: 0; margin: 0; padding: 0; position: fixed; top: 0; transition: background 0.5s, width 1.5s; width: 25%;\"></div>\\n\\\nutility2-comment -->\\n\\\n<h1>\\n\\\n<!-- utility2-comment\\n\\\n    <a\\n\\\n        {{#if env.npm_package_homepage}}\\n\\\n        href=\"{{env.npm_package_homepage}}\"\\n\\\n        {{/if env.npm_package_homepage}}\\n\\\n        target=\"_blank\"\\n\\\n    >\\n\\\nutility2-comment -->\\n\\\n        {{env.npm_package_name}} (v{{env.npm_package_version}})\\n\\\n<!-- utility2-comment\\n\\\n    </a>\\n\\\nutility2-comment -->\\n\\\n</h1>\\n\\\n<h3>{{env.npm_package_description}}</h3>\\n\\\n<!-- utility2-comment\\n\\\n<h4><a download href=\"assets.app.js\">download standalone app</a></h4>\\n\\\n<button class=\"onclick onreset\" id=\"testRunButton1\">run internal test</button><br>\\n\\\n<div id=\"testReportDiv1\" style=\"display: none;\"></div>\\n\\\nutility2-comment -->\\n\\\n\\n\\\n\\n\\\n\\n\\\n<label>stderr and stdout</label>\\n\\\n<textarea class=\"resettable\" id=\"outputTextareaStdout1\" readonly></textarea>\\n\\\n<!-- utility2-comment\\n\\\n{{#if isRollup}}\\n\\\n<script src=\"assets.app.js\"></script>\\n\\\n{{#unless isRollup}}\\n\\\nutility2-comment -->\\n\\\n<script src=\"assets.utility2.rollup.js\"></script>\\n\\\n<script src=\"jsonp.utility2._stateInit?callback=window.utility2._stateInit\"></script>\\n\\\n<script src=\"assets.npmtest_nuclide_server.rollup.js\"></script>\\n\\\n<script src=\"assets.example.js\"></script>\\n\\\n<script src=\"assets.test.js\"></script>\\n\\\n<!-- utility2-comment\\n\\\n{{/if isRollup}}\\n\\\nutility2-comment -->\\n\\\n<div class=\"utility2FooterDiv\">\\n\\\n    [ this app was created with\\n\\\n    <a href=\"https://github.com/kaizhu256/node-utility2\" target=\"_blank\">utility2</a>\\n\\\n    ]\\n\\\n</div>\\n\\\n</body>\\n\\\n</html>\\n\\\n';\n        /* jslint-ignore-end */\n        if (local.templateRender) {\n            local.assetsDict['/'] = local.templateRender(\n                local.assetsDict['/assets.index.template.html'],\n                {\n                    env: local.objectSetDefault(local.env, {\n                        npm_package_description: 'the greatest app in the world!',\n                        npm_package_name: 'my-app',\n                        npm_package_nameAlias: 'my_app',\n                        npm_package_version: '0.0.1'\n                    })\n                }\n            );\n        } else {\n            local.assetsDict['/'] = local.assetsDict['/assets.index.template.html']\n                .replace((/\\{\\{env\\.(\\w+?)\\}\\}/g), function (match0, match1) {\n                    // jslint-hack\n                    String(match0);\n                    switch (match1) {\n                    case 'npm_package_description':\n                        return 'the greatest app in the world!';\n                    case 'npm_package_name':\n                        return 'my-app';\n                    case 'npm_package_nameAlias':\n                        return 'my_app';\n                    case 'npm_package_version':\n                        return '0.0.1';\n                    }\n                });\n        }\n        // run the cli\n        if (local.global.utility2_rollup || module !== require.main) {\n            break;\n        }\n        local.assetsDict['/assets.example.js'] =\n            local.assetsDict['/assets.example.js'] ||\n            local.fs.readFileSync(__filename, 'utf8');\n        // bug-workaround - long $npm_package_buildCustomOrg\n        /* jslint-ignore-begin */\n        local.assetsDict['/assets.npmtest_nuclide_server.rollup.js'] =\n            local.assetsDict['/assets.npmtest_nuclide_server.rollup.js'] ||\n            local.fs.readFileSync(\n                local.npmtest_nuclide_server.__dirname + '/lib.npmtest_nuclide_server.js',\n                'utf8'\n            ).replace((/^#!/), '//');\n        /* jslint-ignore-end */\n        local.assetsDict['/favicon.ico'] = local.assetsDict['/favicon.ico'] || '';\n        // if $npm_config_timeout_exit exists,\n        // then exit this process after $npm_config_timeout_exit ms\n        if (Number(process.env.npm_config_timeout_exit)) {\n            setTimeout(process.exit, Number(process.env.npm_config_timeout_exit));\n        }\n        // start server\n        if (local.global.utility2_serverHttp1) {\n            break;\n        }\n        process.env.PORT = process.env.PORT || '8081';\n        console.error('server starting on port ' + process.env.PORT);\n        local.http.createServer(function (request, response) {\n            request.urlParsed = local.url.parse(request.url);\n            if (local.assetsDict[request.urlParsed.pathname] !== undefined) {\n                response.end(local.assetsDict[request.urlParsed.pathname]);\n                return;\n            }\n            response.statusCode = 404;\n            response.end();\n        }).listen(process.env.PORT);\n        break;\n    }\n}());\n","/home/travis/build/npmtest/node-npmtest-nuclide-server/node_modules/nuclide-server/nuclide-start-server":"#!/bin/bash\n\n# Copyright (c) 2015-present, Facebook, Inc.\n# All rights reserved.\n#\n# This source code is licensed under the license found in the LICENSE file in\n# the root directory of this source tree.\n\n# This will make the current directory the real path this script lives in\ncd \"$( cd \"$(dirname $0)\" ; pwd -P )\" > /dev/null 2>&1\n# This will make the current directory the path that contains the scripts dir\ncd \"$(dirname \"$(readlink \"$0\" || printf %s \"$0\")\")\" > /dev/null 2>&1\nscripts/nuclide_server_manager.py \"$@\"\n","/home/travis/build/npmtest/node-npmtest-nuclide-server/node_modules/nuclide-server/lib/blocked.js":"\n/*\n * Copyright (c) 2015-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the license found in the LICENSE file in\n * the root directory of this source tree.\n */\n\n/**\n * Copy of the npm package: blocked, but without the unref, because that doesn't work in apm tests.\n * https://github.com/tj/node-blocked/blob/master/index.js\n *\n * The blocked module checks and reports every event loop block time over a given threshold.\n * @return the interval handler.\n * To cancel, call clearInterval on the returned interval handler.\n */\nmodule.exports = function (fn) {\n  var intervalMs = arguments.length <= 1 || arguments[1] === undefined ? 100 : arguments[1];\n  var thresholdMs = arguments.length <= 2 || arguments[2] === undefined ? 50 : arguments[2];\n\n  var start = Date.now();\n\n  return setInterval(function () {\n    var deltaMs = Date.now() - start;\n    var blockTimeMs = deltaMs - intervalMs;\n    if (blockTimeMs > thresholdMs) {\n      fn(blockTimeMs);\n    }\n    start = Date.now();\n  }, intervalMs);\n};\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi92YXIvZm9sZGVycy94Zi9yc3BoNF9jNTczMTVyczU3eHhzZHNrcnhudjM2dDAvVC90bXBwZmw1Mm5wdWJsaXNoX3BhY2thZ2VzL25wbS9udWNsaWRlLXNlcnZlci9saWIvYmxvY2tlZC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxXQUFXLENBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQW1CWixNQUFNLENBQUMsT0FBTyxHQUFHLFVBQUMsRUFBRSxFQUErRDtNQUF2QyxVQUFVLHlEQUFHLEdBQUc7TUFBRSxXQUFXLHlEQUFHLEVBQUU7O0FBQzVFLE1BQUksS0FBSyxHQUFHLElBQUksQ0FBQyxHQUFHLEVBQUUsQ0FBQzs7QUFFdkIsU0FBTyxXQUFXLENBQUMsWUFBTTtBQUN2QixRQUFNLE9BQU8sR0FBRyxJQUFJLENBQUMsR0FBRyxFQUFFLEdBQUcsS0FBSyxDQUFDO0FBQ25DLFFBQU0sV0FBVyxHQUFHLE9BQU8sR0FBRyxVQUFVLENBQUM7QUFDekMsUUFBSSxXQUFXLEdBQUcsV0FBVyxFQUFFO0FBQzdCLFFBQUUsQ0FBQyxXQUFXLENBQUMsQ0FBQztLQUNqQjtBQUNELFNBQUssR0FBRyxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUM7R0FDcEIsRUFBRSxVQUFVLENBQUMsQ0FBQztDQUNoQixDQUFDIiwiZmlsZSI6Ii92YXIvZm9sZGVycy94Zi9yc3BoNF9jNTczMTVyczU3eHhzZHNrcnhudjM2dDAvVC90bXBwZmw1Mm5wdWJsaXNoX3BhY2thZ2VzL25wbS9udWNsaWRlLXNlcnZlci9saWIvYmxvY2tlZC5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2UgYmFiZWwnO1xuLyogQGZsb3cgKi9cblxuLypcbiAqIENvcHlyaWdodCAoYykgMjAxNS1wcmVzZW50LCBGYWNlYm9vaywgSW5jLlxuICogQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBsaWNlbnNlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUgaW5cbiAqIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICovXG5cbi8qKlxuICogQ29weSBvZiB0aGUgbnBtIHBhY2thZ2U6IGJsb2NrZWQsIGJ1dCB3aXRob3V0IHRoZSB1bnJlZiwgYmVjYXVzZSB0aGF0IGRvZXNuJ3Qgd29yayBpbiBhcG0gdGVzdHMuXG4gKiBodHRwczovL2dpdGh1Yi5jb20vdGovbm9kZS1ibG9ja2VkL2Jsb2IvbWFzdGVyL2luZGV4LmpzXG4gKlxuICogVGhlIGJsb2NrZWQgbW9kdWxlIGNoZWNrcyBhbmQgcmVwb3J0cyBldmVyeSBldmVudCBsb29wIGJsb2NrIHRpbWUgb3ZlciBhIGdpdmVuIHRocmVzaG9sZC5cbiAqIEByZXR1cm4gdGhlIGludGVydmFsIGhhbmRsZXIuXG4gKiBUbyBjYW5jZWwsIGNhbGwgY2xlYXJJbnRlcnZhbCBvbiB0aGUgcmV0dXJuZWQgaW50ZXJ2YWwgaGFuZGxlci5cbiAqL1xubW9kdWxlLmV4cG9ydHMgPSAoZm46IChtczogbnVtYmVyKSA9PiB2b2lkLCBpbnRlcnZhbE1zID0gMTAwLCB0aHJlc2hvbGRNcyA9IDUwKSA9PiB7XG4gIGxldCBzdGFydCA9IERhdGUubm93KCk7XG5cbiAgcmV0dXJuIHNldEludGVydmFsKCgpID0+IHtcbiAgICBjb25zdCBkZWx0YU1zID0gRGF0ZS5ub3coKSAtIHN0YXJ0O1xuICAgIGNvbnN0IGJsb2NrVGltZU1zID0gZGVsdGFNcyAtIGludGVydmFsTXM7XG4gICAgaWYgKGJsb2NrVGltZU1zID4gdGhyZXNob2xkTXMpIHtcbiAgICAgIGZuKGJsb2NrVGltZU1zKTtcbiAgICB9XG4gICAgc3RhcnQgPSBEYXRlLm5vdygpO1xuICB9LCBpbnRlcnZhbE1zKTtcbn07XG4iXX0=\n","/home/travis/build/npmtest/node-npmtest-nuclide-server/node_modules/nuclide-server/lib/config.js":"\n/*\n * Copyright (c) 2015-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the license found in the LICENSE file in\n * the root directory of this source tree.\n */\n/**\n  * Currently we have two different ways to config a service in service-config.json:\n  *   1. `{\"useServiceFramework\": false, \"path\": \"path/to/service/file\"}`, a old fashioned way\n  *      to config a service and it is deprecated.\n  *   2. `{\"useServiceFramework\": true,\n  *        \"definition\": \"path/to/service/defintion\",\n  *        \"implementation\": \"path/to/local/implementation\"}, use service framework to config\n  *      a service definition and a local implementation.\n  */\n\nvar fs = require('fs-plus');\nvar path = require('path');\n\nvar PACKAGE_ROOT = path.resolve(__dirname, '..');\n\n// Custom services path is defined in \"package.json\", which is always in the root, so resolve\n// the path to the custom services config from the root as well.\nvar CUSTOM_SERVICES_CONFIG_PATH = path.resolve(PACKAGE_ROOT, require(path.resolve(PACKAGE_ROOT, 'package.json'))['nuclide']['customServices']);\nvar HEARTBEAT_CHANNEL = 'heartbeat';\nvar SERVICE_FRAMEWORK_EVENT_CHANNEL = 'service_framework_event';\nvar SERVICE_FRAMEWORK_RPC_CHANNEL = 'service_framework_rpc';\nvar SERVICE_FRAMEWORK3_CHANNEL = 'service_framework3_rpc';\n\nvar SERVICE_FRAMEWORK_RPC_TIMEOUT_MS = 60 * 1000;\nvar SERVICES_CONFIG_PATH = path.resolve(PACKAGE_ROOT, 'services-config.json');\n\nfunction loadConfigs() {\n  var configList = require(SERVICES_CONFIG_PATH);\n\n  if (fs.isFileSync(CUSTOM_SERVICES_CONFIG_PATH)) {\n    var customConfigs = require(CUSTOM_SERVICES_CONFIG_PATH);\n    configList = configList.concat(customConfigs);\n  }\n\n  return configList;\n}\n\nfunction loadConfigsOfServiceWithServiceFramework() {\n  return loadConfigs().filter(function (config) {\n    return config.useServiceFramework;\n  }).map(function (config) {\n    return {\n      name: config.name,\n      definition: _resolveServiceConfigPath(config.definition),\n      implementation: _resolveServiceConfigPath(config.implementation)\n    };\n  });\n}\n\nfunction loadConfigsOfServiceWithoutServiceFramework() {\n  return loadConfigs().filter(function (config) {\n    return !config.useServiceFramework;\n  }).map(function (config) {\n    return _resolveServiceConfigPath(config.path);\n  });\n}\n\n/**\n  * Resolve service path defined in service-config.json to absolute path. The service path could\n  * be in one of following forms:\n  *   1. A path relative to the folder contains `service-config.json`.\n  *   2. An absolute path.\n  *   3. A path in form of `$dependency_package/path/to/service`. For example,\n  *      'nuclide-commons/lib/array.js'.\n  */\nfunction _resolveServiceConfigPath(serviceConfigPath) {\n  try {\n    return require.resolve(serviceConfigPath);\n  } catch (e) {\n    return path.resolve(path.dirname(SERVICES_CONFIG_PATH), serviceConfigPath);\n  }\n}\n\nmodule.exports = {\n  loadConfigsOfServiceWithoutServiceFramework: loadConfigsOfServiceWithoutServiceFramework,\n  loadConfigsOfServiceWithServiceFramework: loadConfigsOfServiceWithServiceFramework,\n  HEARTBEAT_CHANNEL: HEARTBEAT_CHANNEL,\n  SERVICE_FRAMEWORK_EVENT_CHANNEL: SERVICE_FRAMEWORK_EVENT_CHANNEL,\n  SERVICE_FRAMEWORK_RPC_CHANNEL: SERVICE_FRAMEWORK_RPC_CHANNEL,\n  SERVICE_FRAMEWORK_RPC_TIMEOUT_MS: SERVICE_FRAMEWORK_RPC_TIMEOUT_MS,\n  SERVICE_FRAMEWORK3_CHANNEL: SERVICE_FRAMEWORK3_CHANNEL\n};\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi92YXIvZm9sZGVycy94Zi9yc3BoNF9jNTczMTVyczU3eHhzZHNrcnhudjM2dDAvVC90bXBwZmw1Mm5wdWJsaXNoX3BhY2thZ2VzL25wbS9udWNsaWRlLXNlcnZlci9saWIvY29uZmlnLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLFdBQVcsQ0FBQzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQW9CWixJQUFNLEVBQUUsR0FBRyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUM7QUFDOUIsSUFBTSxJQUFJLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDOztBQUU3QixJQUFNLFlBQVksR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLFNBQVMsRUFBRSxJQUFJLENBQUMsQ0FBQzs7OztBQUluRCxJQUFNLDJCQUEyQixHQUFHLElBQUksQ0FBQyxPQUFPLENBQzlDLFlBQVksRUFDWixPQUFPLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxZQUFZLEVBQUUsY0FBYyxDQUFDLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxnQkFBZ0IsQ0FBQyxDQUNqRixDQUFDO0FBQ0YsSUFBTSxpQkFBaUIsR0FBRyxXQUFXLENBQUM7QUFDdEMsSUFBTSwrQkFBK0IsR0FBRyx5QkFBeUIsQ0FBQztBQUNsRSxJQUFNLDZCQUE2QixHQUFHLHVCQUF1QixDQUFDO0FBQzlELElBQU0sMEJBQTBCLEdBQUcsd0JBQXdCLENBQUM7O0FBRTVELElBQU0sZ0NBQWdDLEdBQUcsRUFBRSxHQUFHLElBQUksQ0FBQztBQUNuRCxJQUFNLG9CQUFvQixHQUFHLElBQUksQ0FBQyxPQUFPLENBQUMsWUFBWSxFQUFFLHNCQUFzQixDQUFDLENBQUM7O0FBRWhGLFNBQVMsV0FBVyxHQUFlO0FBQ2pDLE1BQUksVUFBVSxHQUFHLE9BQU8sQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDOztBQUUvQyxNQUFJLEVBQUUsQ0FBQyxVQUFVLENBQUMsMkJBQTJCLENBQUMsRUFBRTtBQUM5QyxRQUFNLGFBQWEsR0FBRyxPQUFPLENBQUMsMkJBQTJCLENBQUMsQ0FBQztBQUMzRCxjQUFVLEdBQUcsVUFBVSxDQUFDLE1BQU0sQ0FBQyxhQUFhLENBQUMsQ0FBQztHQUMvQzs7QUFFRCxTQUFPLFVBQVUsQ0FBQztDQUNuQjs7QUFFRCxTQUFTLHdDQUF3QyxHQUFlO0FBQzlELFNBQU8sV0FBVyxFQUFFLENBQ2pCLE1BQU0sQ0FBQyxVQUFBLE1BQU07V0FBSSxNQUFNLENBQUMsbUJBQW1CO0dBQUEsQ0FBQyxDQUM1QyxHQUFHLENBQUMsVUFBQSxNQUFNLEVBQUk7QUFDYixXQUFPO0FBQ0wsVUFBSSxFQUFFLE1BQU0sQ0FBQyxJQUFJO0FBQ2pCLGdCQUFVLEVBQUUseUJBQXlCLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQztBQUN4RCxvQkFBYyxFQUFFLHlCQUF5QixDQUFDLE1BQU0sQ0FBQyxjQUFjLENBQUM7S0FDakUsQ0FBQztHQUNILENBQUMsQ0FBQztDQUNOOztBQUVELFNBQVMsMkNBQTJDLEdBQWtCO0FBQ3BFLFNBQU8sV0FBVyxFQUFFLENBQ2pCLE1BQU0sQ0FBQyxVQUFBLE1BQU07V0FBSSxDQUFDLE1BQU0sQ0FBQyxtQkFBbUI7R0FBQSxDQUFDLENBQzdDLEdBQUcsQ0FBQyxVQUFBLE1BQU07V0FBSSx5QkFBeUIsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDO0dBQUEsQ0FBQyxDQUFDO0NBQzFEOzs7Ozs7Ozs7O0FBVUQsU0FBUyx5QkFBeUIsQ0FBQyxpQkFBeUIsRUFBVTtBQUNwRSxNQUFJO0FBQ0YsV0FBTyxPQUFPLENBQUMsT0FBTyxDQUFDLGlCQUFpQixDQUFDLENBQUM7R0FDM0MsQ0FBQyxPQUFPLENBQUMsRUFBRTtBQUNWLFdBQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLG9CQUFvQixDQUFDLEVBQUUsaUJBQWlCLENBQUMsQ0FBQztHQUM1RTtDQUNGOztBQUVELE1BQU0sQ0FBQyxPQUFPLEdBQUc7QUFDZiw2Q0FBMkMsRUFBM0MsMkNBQTJDO0FBQzNDLDBDQUF3QyxFQUF4Qyx3Q0FBd0M7QUFDeEMsbUJBQWlCLEVBQWpCLGlCQUFpQjtBQUNqQixpQ0FBK0IsRUFBL0IsK0JBQStCO0FBQy9CLCtCQUE2QixFQUE3Qiw2QkFBNkI7QUFDN0Isa0NBQWdDLEVBQWhDLGdDQUFnQztBQUNoQyw0QkFBMEIsRUFBMUIsMEJBQTBCO0NBQzNCLENBQUMiLCJmaWxlIjoiL3Zhci9mb2xkZXJzL3hmL3JzcGg0X2M1NzMxNXJzNTd4eHNkc2tyeG52MzZ0MC9UL3RtcHBmbDUybnB1Ymxpc2hfcGFja2FnZXMvbnBtL251Y2xpZGUtc2VydmVyL2xpYi9jb25maWcuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIGJhYmVsJztcbi8qIEBmbG93ICovXG5cbi8qXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTUtcHJlc2VudCwgRmFjZWJvb2ssIEluYy5cbiAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgbGljZW5zZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlIGluXG4gKiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqL1xuLyoqXG4gICogQ3VycmVudGx5IHdlIGhhdmUgdHdvIGRpZmZlcmVudCB3YXlzIHRvIGNvbmZpZyBhIHNlcnZpY2UgaW4gc2VydmljZS1jb25maWcuanNvbjpcbiAgKiAgIDEuIGB7XCJ1c2VTZXJ2aWNlRnJhbWV3b3JrXCI6IGZhbHNlLCBcInBhdGhcIjogXCJwYXRoL3RvL3NlcnZpY2UvZmlsZVwifWAsIGEgb2xkIGZhc2hpb25lZCB3YXlcbiAgKiAgICAgIHRvIGNvbmZpZyBhIHNlcnZpY2UgYW5kIGl0IGlzIGRlcHJlY2F0ZWQuXG4gICogICAyLiBge1widXNlU2VydmljZUZyYW1ld29ya1wiOiB0cnVlLFxuICAqICAgICAgICBcImRlZmluaXRpb25cIjogXCJwYXRoL3RvL3NlcnZpY2UvZGVmaW50aW9uXCIsXG4gICogICAgICAgIFwiaW1wbGVtZW50YXRpb25cIjogXCJwYXRoL3RvL2xvY2FsL2ltcGxlbWVudGF0aW9uXCJ9LCB1c2Ugc2VydmljZSBmcmFtZXdvcmsgdG8gY29uZmlnXG4gICogICAgICBhIHNlcnZpY2UgZGVmaW5pdGlvbiBhbmQgYSBsb2NhbCBpbXBsZW1lbnRhdGlvbi5cbiAgKi9cblxuY29uc3QgZnMgPSByZXF1aXJlKCdmcy1wbHVzJyk7XG5jb25zdCBwYXRoID0gcmVxdWlyZSgncGF0aCcpO1xuXG5jb25zdCBQQUNLQUdFX1JPT1QgPSBwYXRoLnJlc29sdmUoX19kaXJuYW1lLCAnLi4nKTtcblxuLy8gQ3VzdG9tIHNlcnZpY2VzIHBhdGggaXMgZGVmaW5lZCBpbiBcInBhY2thZ2UuanNvblwiLCB3aGljaCBpcyBhbHdheXMgaW4gdGhlIHJvb3QsIHNvIHJlc29sdmVcbi8vIHRoZSBwYXRoIHRvIHRoZSBjdXN0b20gc2VydmljZXMgY29uZmlnIGZyb20gdGhlIHJvb3QgYXMgd2VsbC5cbmNvbnN0IENVU1RPTV9TRVJWSUNFU19DT05GSUdfUEFUSCA9IHBhdGgucmVzb2x2ZShcbiAgUEFDS0FHRV9ST09ULFxuICByZXF1aXJlKHBhdGgucmVzb2x2ZShQQUNLQUdFX1JPT1QsICdwYWNrYWdlLmpzb24nKSlbJ251Y2xpZGUnXVsnY3VzdG9tU2VydmljZXMnXVxuKTtcbmNvbnN0IEhFQVJUQkVBVF9DSEFOTkVMID0gJ2hlYXJ0YmVhdCc7XG5jb25zdCBTRVJWSUNFX0ZSQU1FV09SS19FVkVOVF9DSEFOTkVMID0gJ3NlcnZpY2VfZnJhbWV3b3JrX2V2ZW50JztcbmNvbnN0IFNFUlZJQ0VfRlJBTUVXT1JLX1JQQ19DSEFOTkVMID0gJ3NlcnZpY2VfZnJhbWV3b3JrX3JwYyc7XG5jb25zdCBTRVJWSUNFX0ZSQU1FV09SSzNfQ0hBTk5FTCA9ICdzZXJ2aWNlX2ZyYW1ld29yazNfcnBjJztcblxuY29uc3QgU0VSVklDRV9GUkFNRVdPUktfUlBDX1RJTUVPVVRfTVMgPSA2MCAqIDEwMDA7XG5jb25zdCBTRVJWSUNFU19DT05GSUdfUEFUSCA9IHBhdGgucmVzb2x2ZShQQUNLQUdFX1JPT1QsICdzZXJ2aWNlcy1jb25maWcuanNvbicpO1xuXG5mdW5jdGlvbiBsb2FkQ29uZmlncygpOiBBcnJheTxhbnk+IHtcbiAgbGV0IGNvbmZpZ0xpc3QgPSByZXF1aXJlKFNFUlZJQ0VTX0NPTkZJR19QQVRIKTtcblxuICBpZiAoZnMuaXNGaWxlU3luYyhDVVNUT01fU0VSVklDRVNfQ09ORklHX1BBVEgpKSB7XG4gICAgY29uc3QgY3VzdG9tQ29uZmlncyA9IHJlcXVpcmUoQ1VTVE9NX1NFUlZJQ0VTX0NPTkZJR19QQVRIKTtcbiAgICBjb25maWdMaXN0ID0gY29uZmlnTGlzdC5jb25jYXQoY3VzdG9tQ29uZmlncyk7XG4gIH1cblxuICByZXR1cm4gY29uZmlnTGlzdDtcbn1cblxuZnVuY3Rpb24gbG9hZENvbmZpZ3NPZlNlcnZpY2VXaXRoU2VydmljZUZyYW1ld29yaygpOiBBcnJheTxhbnk+IHtcbiAgcmV0dXJuIGxvYWRDb25maWdzKClcbiAgICAuZmlsdGVyKGNvbmZpZyA9PiBjb25maWcudXNlU2VydmljZUZyYW1ld29yaylcbiAgICAubWFwKGNvbmZpZyA9PiB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBuYW1lOiBjb25maWcubmFtZSxcbiAgICAgICAgZGVmaW5pdGlvbjogX3Jlc29sdmVTZXJ2aWNlQ29uZmlnUGF0aChjb25maWcuZGVmaW5pdGlvbiksXG4gICAgICAgIGltcGxlbWVudGF0aW9uOiBfcmVzb2x2ZVNlcnZpY2VDb25maWdQYXRoKGNvbmZpZy5pbXBsZW1lbnRhdGlvbiksXG4gICAgICB9O1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBsb2FkQ29uZmlnc09mU2VydmljZVdpdGhvdXRTZXJ2aWNlRnJhbWV3b3JrKCk6IEFycmF5PHN0cmluZz4ge1xuICByZXR1cm4gbG9hZENvbmZpZ3MoKVxuICAgIC5maWx0ZXIoY29uZmlnID0+ICFjb25maWcudXNlU2VydmljZUZyYW1ld29yaylcbiAgICAubWFwKGNvbmZpZyA9PiBfcmVzb2x2ZVNlcnZpY2VDb25maWdQYXRoKGNvbmZpZy5wYXRoKSk7XG59XG5cbi8qKlxuICAqIFJlc29sdmUgc2VydmljZSBwYXRoIGRlZmluZWQgaW4gc2VydmljZS1jb25maWcuanNvbiB0byBhYnNvbHV0ZSBwYXRoLiBUaGUgc2VydmljZSBwYXRoIGNvdWxkXG4gICogYmUgaW4gb25lIG9mIGZvbGxvd2luZyBmb3JtczpcbiAgKiAgIDEuIEEgcGF0aCByZWxhdGl2ZSB0byB0aGUgZm9sZGVyIGNvbnRhaW5zIGBzZXJ2aWNlLWNvbmZpZy5qc29uYC5cbiAgKiAgIDIuIEFuIGFic29sdXRlIHBhdGguXG4gICogICAzLiBBIHBhdGggaW4gZm9ybSBvZiBgJGRlcGVuZGVuY3lfcGFja2FnZS9wYXRoL3RvL3NlcnZpY2VgLiBGb3IgZXhhbXBsZSxcbiAgKiAgICAgICdudWNsaWRlLWNvbW1vbnMvbGliL2FycmF5LmpzJy5cbiAgKi9cbmZ1bmN0aW9uIF9yZXNvbHZlU2VydmljZUNvbmZpZ1BhdGgoc2VydmljZUNvbmZpZ1BhdGg6IHN0cmluZyk6IHN0cmluZyB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIHJlcXVpcmUucmVzb2x2ZShzZXJ2aWNlQ29uZmlnUGF0aCk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gcGF0aC5yZXNvbHZlKHBhdGguZGlybmFtZShTRVJWSUNFU19DT05GSUdfUEFUSCksIHNlcnZpY2VDb25maWdQYXRoKTtcbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgbG9hZENvbmZpZ3NPZlNlcnZpY2VXaXRob3V0U2VydmljZUZyYW1ld29yayxcbiAgbG9hZENvbmZpZ3NPZlNlcnZpY2VXaXRoU2VydmljZUZyYW1ld29yayxcbiAgSEVBUlRCRUFUX0NIQU5ORUwsXG4gIFNFUlZJQ0VfRlJBTUVXT1JLX0VWRU5UX0NIQU5ORUwsXG4gIFNFUlZJQ0VfRlJBTUVXT1JLX1JQQ19DSEFOTkVMLFxuICBTRVJWSUNFX0ZSQU1FV09SS19SUENfVElNRU9VVF9NUyxcbiAgU0VSVklDRV9GUkFNRVdPUkszX0NIQU5ORUwsXG59O1xuIl19\n","/home/travis/build/npmtest/node-npmtest-nuclide-server/node_modules/nuclide-server/lib/main.js":"\n// Swallow the error while runing in open sourced version.\n\nvar main = _asyncToGenerator(function* (args) {\n  var serverStartTimer = (0, _nuclideAnalytics.startTracking)('nuclide-server:start');\n  try {\n    setupServer();\n    var port = args.port;\n    var key = args.key;\n    var cert = args.cert;\n    var ca = args.ca;\n\n    if (key && cert && ca) {\n      key = _fs2['default'].readFileSync(key);\n      cert = _fs2['default'].readFileSync(cert);\n      ca = _fs2['default'].readFileSync(ca);\n    }\n    var server = new _NuclideServer2['default']({\n      port: port,\n      serverKey: key,\n      serverCertificate: cert,\n      certificateAuthorityCertificate: ca,\n      trackEventLoop: true\n    });\n    yield server.connect();\n    serverStartTimer.onSuccess();\n    logger.info('NuclideServer started on port ' + port + '.');\n  } catch (e) {\n    // Ensure logging is configured.\n    yield (0, _nuclideLogging.initialUpdateConfig)();\n    yield serverStartTimer.onError(e);\n    logger.fatal(e);\n    (0, _nuclideLogging.flushLogsAndExit)(1);\n  }\n}\n\n// This should never happen because the server must be started with stderr redirected to a log file.\n);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { var callNext = step.bind(null, 'next'); var callThrow = step.bind(null, 'throw'); function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(callNext, callThrow); } } callNext(); }); }; }\n\n/*\n * Copyright (c) 2015-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the license found in the LICENSE file in\n * the root directory of this source tree.\n */\n\nvar _fs = require('fs');\n\nvar _fs2 = _interopRequireDefault(_fs);\n\nvar _nuclideLogging = require('nuclide-logging');\n\nvar _nuclideAnalytics = require('nuclide-analytics');\n\nvar _NuclideServer = require('./NuclideServer');\n\nvar _NuclideServer2 = _interopRequireDefault(_NuclideServer);\n\n'use babel';\n\nvar DEFAULT_PORT = 9090;\n\nvar logger = (0, _nuclideLogging.getLogger)();\n\nfunction setupServer() {\n  try {\n    require('./fb/setup').setupServer();\n  } catch (e) {}\n}\n\nprocess.stderr.on('error', function (error) {\n  throw new Error('Can not write to stderr! :' + error);\n});\n\nprocess.on('uncaughtException', function (err) {\n  // Log the error and continue the server crash.\n  logger.fatal('uncaughtException:', err);\n  // According to the docs, we need to close our server when this happens once we logged or\n  // handled it: https://nodejs.org/api/process.html#process_event_uncaughtexception\n  (0, _nuclideLogging.flushLogsAndExit)(1);\n});\n\n// This works in io.js as of v2.4.0 (possibly earlier versions, as well). Support for this was\n// introduced by https://github.com/nodejs/io.js/pull/758 in io.js.\n//\n// Unfortunately, the analogous change was rejected in Node v0.12.x:\n// https://github.com/joyent/node/issues/8997.\n//\n// We include this code here in anticipation of the Node/io.js merger.\nprocess.on('unhandledRejection', function (error, promise) {\n  logger.error('Unhandled promise rejection ' + promise + '. Error:', error);\n});\n\nvar argv = require('yargs')['default']('port', DEFAULT_PORT).argv;\n\nmain(argv);\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi92YXIvZm9sZGVycy94Zi9yc3BoNF9jNTczMTVyczU3eHhzZHNrcnhudjM2dDAvVC90bXBwZmw1Mm5wdWJsaXNoX3BhY2thZ2VzL25wbS9udWNsaWRlLXNlcnZlci9saWIvbWFpbi5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7SUE0QmUsSUFBSSxxQkFBbkIsV0FBb0IsSUFBSSxFQUFFO0FBQ3hCLE1BQU0sZ0JBQWdCLEdBQUcsc0JBaEJuQixhQUFhLEVBZ0JvQixzQkFBc0IsQ0FBQyxDQUFDO0FBQy9ELE1BQUk7QUFDRixlQUFXLEVBQUUsQ0FBQztRQUNQLElBQUksR0FBSSxJQUFJLENBQVosSUFBSTtRQUNOLEdBQUcsR0FBYyxJQUFJLENBQXJCLEdBQUc7UUFBRSxJQUFJLEdBQVEsSUFBSSxDQUFoQixJQUFJO1FBQUUsRUFBRSxHQUFJLElBQUksQ0FBVixFQUFFOztBQUNsQixRQUFJLEdBQUcsSUFBSSxJQUFJLElBQUksRUFBRSxFQUFFO0FBQ3JCLFNBQUcsR0FBRyxnQkFBRyxZQUFZLENBQUMsR0FBRyxDQUFDLENBQUM7QUFDM0IsVUFBSSxHQUFHLGdCQUFHLFlBQVksQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUM3QixRQUFFLEdBQUcsZ0JBQUcsWUFBWSxDQUFDLEVBQUUsQ0FBQyxDQUFDO0tBQzFCO0FBQ0QsUUFBTSxNQUFNLEdBQUcsK0JBQWtCO0FBQy9CLFVBQUksRUFBSixJQUFJO0FBQ0osZUFBUyxFQUFFLEdBQUc7QUFDZCx1QkFBaUIsRUFBRSxJQUFJO0FBQ3ZCLHFDQUErQixFQUFFLEVBQUU7QUFDbkMsb0JBQWMsRUFBRSxJQUFJO0tBQ3JCLENBQUMsQ0FBQztBQUNILFVBQU0sTUFBTSxDQUFDLE9BQU8sRUFBRSxDQUFDO0FBQ3ZCLG9CQUFnQixDQUFDLFNBQVMsRUFBRSxDQUFDO0FBQzdCLFVBQU0sQ0FBQyxJQUFJLENBQUMsZ0NBQWdDLEdBQUcsSUFBSSxHQUFHLEdBQUcsQ0FBQyxDQUFDO0dBQzVELENBQUMsT0FBTyxDQUFDLEVBQUU7O0FBRVYsVUFBTSxvQkF2QzJCLG1CQUFtQixHQXVDekIsQ0FBQztBQUM1QixVQUFNLGdCQUFnQixDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNsQyxVQUFNLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ2hCLHdCQTFDZSxnQkFBZ0IsRUEwQ2QsQ0FBQyxDQUFDLENBQUM7R0FDckI7Q0FDRjs7Ozs7Ozs7Ozs7Ozs7Ozs7a0JBN0NjLElBQUk7Ozs7OEJBQzRDLGlCQUFpQjs7Z0NBQ3BELG1CQUFtQjs7NkJBQ3JCLGlCQUFpQjs7OztBQWQzQyxXQUFXLENBQUM7O0FBZ0JaLElBQU0sWUFBWSxHQUFHLElBQUksQ0FBQzs7QUFFMUIsSUFBTSxNQUFNLEdBQUcsb0JBTlAsU0FBUyxHQU1TLENBQUM7O0FBRTNCLFNBQVMsV0FBVyxHQUFTO0FBQzNCLE1BQUk7QUFDRixXQUFPLENBQUMsWUFBWSxDQUFDLENBQUMsV0FBVyxFQUFFLENBQUM7R0FDckMsQ0FBQyxPQUFPLENBQUMsRUFBRSxFQUVYO0NBQ0Y7O0FBaUNELE9BQU8sQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLE9BQU8sRUFBRSxVQUFDLEtBQUssRUFBSztBQUNwQyxRQUFNLElBQUksS0FBSyxDQUFDLDRCQUE0QixHQUFHLEtBQUssQ0FBQyxDQUFDO0NBQ3ZELENBQUMsQ0FBQzs7QUFFSCxPQUFPLENBQUMsRUFBRSxDQUFDLG1CQUFtQixFQUFFLFVBQUMsR0FBRyxFQUFLOztBQUV2QyxRQUFNLENBQUMsS0FBSyxDQUFDLG9CQUFvQixFQUFFLEdBQUcsQ0FBQyxDQUFDOzs7QUFHeEMsc0JBeERpQixnQkFBZ0IsRUF3RGhCLENBQUMsQ0FBQyxDQUFDO0NBQ3JCLENBQUMsQ0FBQzs7Ozs7Ozs7O0FBU0gsT0FBTyxDQUFDLEVBQUUsQ0FBQyxvQkFBb0IsRUFBRSxVQUFDLEtBQUssRUFBRSxPQUFPLEVBQUs7QUFDbkQsUUFBTSxDQUFDLEtBQUssa0NBQWdDLE9BQU8sZUFBWSxLQUFLLENBQUMsQ0FBQztDQUN2RSxDQUFDLENBQUM7O0FBRUgsSUFBTSxJQUFJLEdBQUcsT0FBTyxDQUFDLE9BQU8sQ0FBQyxXQUNqQixDQUFDLE1BQU0sRUFBRSxZQUFZLENBQUMsQ0FDN0IsSUFBSSxDQUFDOztBQUVWLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyIsImZpbGUiOiIvdmFyL2ZvbGRlcnMveGYvcnNwaDRfYzU3MzE1cnM1N3h4c2Rza3J4bnYzNnQwL1QvdG1wcGZsNTJucHVibGlzaF9wYWNrYWdlcy9ucG0vbnVjbGlkZS1zZXJ2ZXIvbGliL21haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIGJhYmVsJztcbi8qIEBmbG93ICovXG5cbi8qXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTUtcHJlc2VudCwgRmFjZWJvb2ssIEluYy5cbiAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgbGljZW5zZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlIGluXG4gKiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqL1xuXG5pbXBvcnQgZnMgZnJvbSAnZnMnO1xuaW1wb3J0IHtnZXRMb2dnZXIsIGZsdXNoTG9nc0FuZEV4aXQsIGluaXRpYWxVcGRhdGVDb25maWd9IGZyb20gJ251Y2xpZGUtbG9nZ2luZyc7XG5pbXBvcnQge3N0YXJ0VHJhY2tpbmd9IGZyb20gJ251Y2xpZGUtYW5hbHl0aWNzJztcbmltcG9ydCBOdWNsaWRlU2VydmVyIGZyb20gJy4vTnVjbGlkZVNlcnZlcic7XG5cbmNvbnN0IERFRkFVTFRfUE9SVCA9IDkwOTA7XG5cbmNvbnN0IGxvZ2dlciA9IGdldExvZ2dlcigpO1xuXG5mdW5jdGlvbiBzZXR1cFNlcnZlcigpOiB2b2lkIHtcbiAgdHJ5IHtcbiAgICByZXF1aXJlKCcuL2ZiL3NldHVwJykuc2V0dXBTZXJ2ZXIoKTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIC8vIFN3YWxsb3cgdGhlIGVycm9yIHdoaWxlIHJ1bmluZyBpbiBvcGVuIHNvdXJjZWQgdmVyc2lvbi5cbiAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBtYWluKGFyZ3MpIHtcbiAgY29uc3Qgc2VydmVyU3RhcnRUaW1lciA9IHN0YXJ0VHJhY2tpbmcoJ251Y2xpZGUtc2VydmVyOnN0YXJ0Jyk7XG4gIHRyeSB7XG4gICAgc2V0dXBTZXJ2ZXIoKTtcbiAgICBjb25zdCB7cG9ydH0gPSBhcmdzO1xuICAgIGxldCB7a2V5LCBjZXJ0LCBjYX0gPSBhcmdzO1xuICAgIGlmIChrZXkgJiYgY2VydCAmJiBjYSkge1xuICAgICAga2V5ID0gZnMucmVhZEZpbGVTeW5jKGtleSk7XG4gICAgICBjZXJ0ID0gZnMucmVhZEZpbGVTeW5jKGNlcnQpO1xuICAgICAgY2EgPSBmcy5yZWFkRmlsZVN5bmMoY2EpO1xuICAgIH1cbiAgICBjb25zdCBzZXJ2ZXIgPSBuZXcgTnVjbGlkZVNlcnZlcih7XG4gICAgICBwb3J0LFxuICAgICAgc2VydmVyS2V5OiBrZXksXG4gICAgICBzZXJ2ZXJDZXJ0aWZpY2F0ZTogY2VydCxcbiAgICAgIGNlcnRpZmljYXRlQXV0aG9yaXR5Q2VydGlmaWNhdGU6IGNhLFxuICAgICAgdHJhY2tFdmVudExvb3A6IHRydWUsXG4gICAgfSk7XG4gICAgYXdhaXQgc2VydmVyLmNvbm5lY3QoKTtcbiAgICBzZXJ2ZXJTdGFydFRpbWVyLm9uU3VjY2VzcygpO1xuICAgIGxvZ2dlci5pbmZvKCdOdWNsaWRlU2VydmVyIHN0YXJ0ZWQgb24gcG9ydCAnICsgcG9ydCArICcuJyk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICAvLyBFbnN1cmUgbG9nZ2luZyBpcyBjb25maWd1cmVkLlxuICAgIGF3YWl0IGluaXRpYWxVcGRhdGVDb25maWcoKTtcbiAgICBhd2FpdCBzZXJ2ZXJTdGFydFRpbWVyLm9uRXJyb3IoZSk7XG4gICAgbG9nZ2VyLmZhdGFsKGUpO1xuICAgIGZsdXNoTG9nc0FuZEV4aXQoMSk7XG4gIH1cbn1cblxuLy8gVGhpcyBzaG91bGQgbmV2ZXIgaGFwcGVuIGJlY2F1c2UgdGhlIHNlcnZlciBtdXN0IGJlIHN0YXJ0ZWQgd2l0aCBzdGRlcnIgcmVkaXJlY3RlZCB0byBhIGxvZyBmaWxlLlxucHJvY2Vzcy5zdGRlcnIub24oJ2Vycm9yJywgKGVycm9yKSA9PiB7XG4gIHRocm93IG5ldyBFcnJvcignQ2FuIG5vdCB3cml0ZSB0byBzdGRlcnIhIDonICsgZXJyb3IpO1xufSk7XG5cbnByb2Nlc3Mub24oJ3VuY2F1Z2h0RXhjZXB0aW9uJywgKGVycikgPT4ge1xuICAvLyBMb2cgdGhlIGVycm9yIGFuZCBjb250aW51ZSB0aGUgc2VydmVyIGNyYXNoLlxuICBsb2dnZXIuZmF0YWwoJ3VuY2F1Z2h0RXhjZXB0aW9uOicsIGVycik7XG4gIC8vIEFjY29yZGluZyB0byB0aGUgZG9jcywgd2UgbmVlZCB0byBjbG9zZSBvdXIgc2VydmVyIHdoZW4gdGhpcyBoYXBwZW5zIG9uY2Ugd2UgbG9nZ2VkIG9yXG4gIC8vIGhhbmRsZWQgaXQ6IGh0dHBzOi8vbm9kZWpzLm9yZy9hcGkvcHJvY2Vzcy5odG1sI3Byb2Nlc3NfZXZlbnRfdW5jYXVnaHRleGNlcHRpb25cbiAgZmx1c2hMb2dzQW5kRXhpdCgxKTtcbn0pO1xuXG4vLyBUaGlzIHdvcmtzIGluIGlvLmpzIGFzIG9mIHYyLjQuMCAocG9zc2libHkgZWFybGllciB2ZXJzaW9ucywgYXMgd2VsbCkuIFN1cHBvcnQgZm9yIHRoaXMgd2FzXG4vLyBpbnRyb2R1Y2VkIGJ5IGh0dHBzOi8vZ2l0aHViLmNvbS9ub2RlanMvaW8uanMvcHVsbC83NTggaW4gaW8uanMuXG4vL1xuLy8gVW5mb3J0dW5hdGVseSwgdGhlIGFuYWxvZ291cyBjaGFuZ2Ugd2FzIHJlamVjdGVkIGluIE5vZGUgdjAuMTIueDpcbi8vIGh0dHBzOi8vZ2l0aHViLmNvbS9qb3llbnQvbm9kZS9pc3N1ZXMvODk5Ny5cbi8vXG4vLyBXZSBpbmNsdWRlIHRoaXMgY29kZSBoZXJlIGluIGFudGljaXBhdGlvbiBvZiB0aGUgTm9kZS9pby5qcyBtZXJnZXIuXG5wcm9jZXNzLm9uKCd1bmhhbmRsZWRSZWplY3Rpb24nLCAoZXJyb3IsIHByb21pc2UpID0+IHtcbiAgbG9nZ2VyLmVycm9yKGBVbmhhbmRsZWQgcHJvbWlzZSByZWplY3Rpb24gJHtwcm9taXNlfS4gRXJyb3I6YCwgZXJyb3IpO1xufSk7XG5cbmNvbnN0IGFyZ3YgPSByZXF1aXJlKCd5YXJncycpXG4gICAgLmRlZmF1bHQoJ3BvcnQnLCBERUZBVUxUX1BPUlQpXG4gICAgLmFyZ3Y7XG5cbm1haW4oYXJndik7XG4iXX0=\n","/home/travis/build/npmtest/node-npmtest-nuclide-server/node_modules/nuclide-server/lib/NuclideServer.js":"Object.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar _slicedToArray = (function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i['return']) _i['return'](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError('Invalid attempt to destructure non-iterable instance'); } }; })();\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { var callNext = step.bind(null, 'next'); var callThrow = step.bind(null, 'throw'); function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(callNext, callThrow); } } callNext(); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nvar _config = require('./config');\n\nvar _assert = require('assert');\n\nvar _assert2 = _interopRequireDefault(_assert);\n\nvar _serviceframework = require('./serviceframework');\n\nvar _serviceframework2 = _interopRequireDefault(_serviceframework);\n\nvar _nuclideLogging = require('nuclide-logging');\n\n'use babel';\n\n/*\n * Copyright (c) 2015-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the license found in the LICENSE file in\n * the root directory of this source tree.\n */\n\nvar blocked = require('./blocked');\nvar connect = require('connect');\n\nvar _require = require('./service-manager');\n\nvar getService = _require.getService;\nvar getRemoteEventName = _require.getRemoteEventName;\n\nvar http = require('http');\nvar https = require('https');\n\nvar _require2 = require('nuclide-service-transformer');\n\nvar parseServiceApiSync = _require2.parseServiceApiSync;\n\nvar _require3 = require('events');\n\nvar EventEmitter = _require3.EventEmitter;\n\nvar WebSocketServer = require('ws').Server;\n\nvar _require4 = require('./utils');\n\nvar deserializeArgs = _require4.deserializeArgs;\nvar sendJsonResponse = _require4.sendJsonResponse;\nvar sendTextResponse = _require4.sendTextResponse;\n\nvar _require5 = require('nuclide-version');\n\nvar getVersion = _require5.getVersion;\n\nvar logger = (0, _nuclideLogging.getLogger)();\n\nvar EVENT_HANDLE_REGISTERED = '_nuclideServerEventHandleRegstered';\n\nvar NuclideServer = (function () {\n  function NuclideServer(options) {\n    _classCallCheck(this, NuclideServer);\n\n    (0, _assert2['default'])(NuclideServer._theServer == null);\n    NuclideServer._theServer = this;\n\n    var serverKey = options.serverKey;\n    var serverCertificate = options.serverCertificate;\n    var port = options.port;\n    var certificateAuthorityCertificate = options.certificateAuthorityCertificate;\n    var trackEventLoop = options.trackEventLoop;\n\n    this._app = connect();\n    this._attachUtilHandlers(this._app);\n    if (serverKey && serverCertificate && certificateAuthorityCertificate) {\n      var webServerOptions = {\n        key: serverKey,\n        cert: serverCertificate,\n        ca: certificateAuthorityCertificate,\n        requestCert: true,\n        rejectUnauthorized: true\n      };\n\n      this._webServer = https.createServer(webServerOptions, this._app);\n    } else {\n      this._webServer = http.createServer(this._app);\n    }\n    this._port = port;\n\n    this._webSocketServer = this._createWebSocketServer();\n    this._clients = {};\n    this._eventSubscriptions = new Map();\n\n    this._setupServices(); // Setup 1.0 and 2.0 services.\n\n    if (trackEventLoop) {\n      blocked(function (ms) {\n        logger.info('NuclideServer event loop blocked for ' + ms + 'ms');\n      });\n    }\n\n    // Setup 3.0 services.\n    this._serverComponent = new _serviceframework2['default'].ServerComponent(this);\n  }\n\n  _createClass(NuclideServer, [{\n    key: '_attachUtilHandlers',\n    value: function _attachUtilHandlers(app) {\n      var _this = this;\n\n      // Add specific method handlers.\n      ['get', 'post', 'delete', 'put'].forEach(function (methodName) {\n        _this._app[methodName] = function (uri, handler) {\n          _this._app.use(uri, function (request, response, next) {\n            if (request.method.toUpperCase() !== methodName.toUpperCase()) {\n              // skip if method doesn't match.\n              return next();\n            } else {\n              handler(request, response, next);\n            }\n          });\n        };\n      });\n    }\n  }, {\n    key: '_createWebSocketServer',\n    value: function _createWebSocketServer() {\n      var _this2 = this;\n\n      var webSocketServer = new WebSocketServer({ server: this._webServer });\n      webSocketServer.on('connection', function (socket) {\n        return _this2._onConnection(socket);\n      });\n      webSocketServer.on('error', function (error) {\n        return logger.error('WebSocketServer Error:', error);\n      });\n      return webSocketServer;\n    }\n  }, {\n    key: '_getServiceFrameworkServiceAndRegisterEventHandle',\n    value: function _getServiceFrameworkServiceAndRegisterEventHandle(serviceConfig, serviceOptions) {\n      var _this3 = this;\n\n      var localServiceInstance = getService(serviceConfig.name, serviceOptions, serviceConfig.implementation);\n      if (localServiceInstance[EVENT_HANDLE_REGISTERED]) {\n        return localServiceInstance;\n      }\n\n      var serviceApi = parseServiceApiSync(serviceConfig.definition, serviceConfig.name);\n\n      serviceApi.eventMethodNames.forEach(function (methodName) {\n        localServiceInstance[methodName].call(localServiceInstance, function () {\n          for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n            args[_key] = arguments[_key];\n          }\n\n          var eventName = getRemoteEventName(serviceConfig.name, methodName, serviceOptions);\n          (_this3._eventSubscriptions.get(eventName) || []).forEach(function (clientId) {\n            var client = _this3._clients[clientId];\n\n            if (!client) {\n              logger.warn('Client with clientId: %s not found!', clientId);\n              return;\n            }\n\n            _this3._sendSocketMessage(client, {\n              channel: _config.SERVICE_FRAMEWORK_EVENT_CHANNEL,\n              event: {\n                name: eventName,\n                args: args\n              }\n            });\n          });\n        });\n      });\n      Object.defineProperty(localServiceInstance, EVENT_HANDLE_REGISTERED, { value: true });\n\n      return localServiceInstance;\n    }\n  }, {\n    key: '_registerServiceWithServiceFramework',\n    value: function _registerServiceWithServiceFramework(serviceConfig) {\n      var _this4 = this;\n\n      var serviceApi = parseServiceApiSync(serviceConfig.definition, serviceConfig.name);\n\n      serviceApi.rpcMethodNames.forEach(function (methodName) {\n        _this4._registerService('/' + serviceApi.className + '/' + methodName,\n\n        // Take serviceOptions as first argument for serviceFramework service.\n        // TODO(chenshen) seperate the logic of service initialization.\n        function (serviceOptions) {\n          for (var _len2 = arguments.length, args = Array(_len2 > 1 ? _len2 - 1 : 0), _key2 = 1; _key2 < _len2; _key2++) {\n            args[_key2 - 1] = arguments[_key2];\n          }\n\n          var localServiceInstance = _this4._getServiceFrameworkServiceAndRegisterEventHandle(serviceConfig, serviceOptions);\n          return localServiceInstance[methodName].apply(localServiceInstance, args);\n        }, 'post');\n      });\n    }\n  }, {\n    key: '_registerServiceWithoutServiceFramework',\n    value: function _registerServiceWithoutServiceFramework(serviceFilePath) {\n      var _require6 = require(serviceFilePath);\n\n      var urlHandlers = _require6.urlHandlers;\n      var services = _require6.services;\n      var initialize = _require6.initialize;\n\n      for (var serviceName in services) {\n        var serviceConfig = services[serviceName];\n        this._registerService(serviceName, serviceConfig.handler, serviceConfig.method, serviceConfig.text);\n      }\n\n      if (urlHandlers) {\n        for (var url in urlHandlers) {\n          var handlerConfig = urlHandlers[url];\n          this._attachUrlHandler(url, handlerConfig.handler, handlerConfig.method);\n        }\n      }\n\n      if (initialize) {\n        initialize(this);\n      }\n    }\n  }, {\n    key: '_setupServices',\n    value: function _setupServices() {\n      var _this5 = this;\n\n      // Lazy require these functions so that we could spyOn them while testing in\n      // ServiceIntegrationTestHelper.\n\n      var _require7 = require('./config');\n\n      var loadConfigsOfServiceWithServiceFramework = _require7.loadConfigsOfServiceWithServiceFramework;\n      var loadConfigsOfServiceWithoutServiceFramework = _require7.loadConfigsOfServiceWithoutServiceFramework;\n\n      this._serviceRegistry = {};\n      this._version = getVersion().toString();\n      this._setupHeartbeatHandler();\n      this._setupServiceFrameworkSubscriptionHandler();\n      this._serviceWithoutServiceFrameworkConfigs = loadConfigsOfServiceWithoutServiceFramework();\n      this._serviceWithServiceFrameworkConfigs = loadConfigsOfServiceWithServiceFramework();\n\n      this._serviceWithoutServiceFrameworkConfigs.forEach(function (config) {\n        _this5._registerServiceWithoutServiceFramework(config);\n        logger.debug('Registered service ' + config + ' without ServiceFramework.');\n      });\n\n      this._serviceWithServiceFrameworkConfigs.forEach(function (config) {\n        _this5._registerServiceWithServiceFramework(config);\n        logger.debug('Registered service ' + config.name + ' with ServiceFramework.');\n      });\n\n      // Setup error handler.\n      this._app.use(function (error, request, response, next) {\n        if (error) {\n          sendJsonResponse(response, { code: error.code, message: error.message }, 500);\n        } else {\n          next();\n        }\n      });\n    }\n  }, {\n    key: '_setupHeartbeatHandler',\n    value: function _setupHeartbeatHandler() {\n      var _this6 = this;\n\n      this._registerService('/' + _config.HEARTBEAT_CHANNEL, _asyncToGenerator(function* () {\n        return _this6._version;\n      }), 'post', true);\n    }\n  }, {\n    key: '_setupServiceFrameworkSubscriptionHandler',\n    value: function _setupServiceFrameworkSubscriptionHandler() {\n      var _this7 = this;\n\n      this._registerService('/serviceFramework/subscribeEvent', function (serviceOptions, clientId, serviceName, methodName) {\n\n        // Create the service instance and register the event handle.\n\n        var _serviceWithServiceFrameworkConfigs$filter = _this7._serviceWithServiceFrameworkConfigs.filter(function (config) {\n          return config.name === serviceName;\n        });\n\n        var _serviceWithServiceFrameworkConfigs$filter2 = _slicedToArray(_serviceWithServiceFrameworkConfigs$filter, 1);\n\n        var serviceConfig = _serviceWithServiceFrameworkConfigs$filter2[0];\n\n        _this7._getServiceFrameworkServiceAndRegisterEventHandle(serviceConfig, serviceOptions);\n\n        var eventName = getRemoteEventName(serviceName, methodName, serviceOptions);\n\n        _this7._eventSubscriptions.set(eventName, (_this7._eventSubscriptions.get(eventName) || new Set()).add(clientId));\n\n        logger.debug(clientId + ' subscribed to ' + eventName);\n      }, 'post');\n\n      this._registerService('/serviceFramework/unsubscribeEvent', function (serviceOptions, clientId, serviceName, methodName) {\n        var eventName = getRemoteEventName(serviceName, methodName, serviceOptions);\n        if (_this7._eventSubscriptions.has(eventName)) {\n          _this7._eventSubscriptions.get(eventName)['delete'](clientId);\n        }\n        logger.debug(clientId + ' unsubscribed to ' + eventName);\n      }, 'post');\n    }\n  }, {\n    key: 'connect',\n    value: function connect() {\n      var _this8 = this;\n\n      return new Promise(function (resolve, reject) {\n        _this8._webServer.on('listening', function () {\n          resolve();\n        });\n        _this8._webServer.on('error', function (e) {\n          _this8._webServer.removeAllListeners();\n          reject(e);\n        });\n        _this8._webServer.listen(_this8._port);\n      });\n    }\n\n    /**\n     * Calls a registered service with a name and arguments.\n     */\n  }, {\n    key: 'callService',\n    value: function callService(serviceName, args) {\n      var serviceFunction = this._serviceRegistry[serviceName];\n      if (!serviceFunction) {\n        throw Error('No service registered with name: ' + serviceName);\n      }\n      return serviceFunction.apply(this, args);\n    }\n\n    /**\n     * Registers a service function to a service name.\n     * This allows simple future calls of the service by name and arguments or http-triggered endpoint calls\n     * with arguments serialized over http.\n     */\n  }, {\n    key: '_registerService',\n    value: function _registerService(serviceName, serviceFunction, method, isTextResponse) {\n      if (method === undefined) method = 'get';\n\n      if (this._serviceRegistry[serviceName]) {\n        throw new Error('A service with this name is already registered:', serviceName);\n      }\n      this._serviceRegistry[serviceName] = serviceFunction;\n      this._registerHttpService(serviceName, method, isTextResponse);\n    }\n  }, {\n    key: '_registerHttpService',\n    value: function _registerHttpService(serviceName, method, isTextResponse) {\n      var _this9 = this;\n\n      var loweredCaseMethod = method.toLowerCase();\n      this._app[loweredCaseMethod](serviceName, _asyncToGenerator(function* (request, response, next) {\n        try {\n          var result = yield _this9.callService(serviceName, deserializeArgs(request.url));\n          if (isTextResponse) {\n            sendTextResponse(response, result || '');\n          } else {\n            sendJsonResponse(response, result);\n          }\n        } catch (e) {\n          // Delegate to the registered connect error handler.\n          next(e);\n        }\n      }));\n    }\n\n    /**\n     * Attach an explicit http connect handler for some services that need request/response related optimizations.\n     * e.g. readFile and writeFile uses it to stream reading and writing files (perf improvement for big files).\n     */\n  }, {\n    key: '_attachUrlHandler',\n    value: function _attachUrlHandler(url, handler) {\n      var method = arguments.length <= 2 || arguments[2] === undefined ? 'get' : arguments[2];\n\n      this._app[method](url, handler);\n    }\n  }, {\n    key: '_onConnection',\n    value: function _onConnection(socket) {\n      var _this10 = this;\n\n      logger.debug('WebSocket connecting');\n\n      var client = null;\n\n      socket.on('error', function (e) {\n        return logger.error('Client #%s error: %s', client ? client.id : 'unkown', e.message);\n      });\n\n      socket.once('message', function (clientId) {\n        client = _this10._clients[clientId] = _this10._clients[clientId] || { subscriptions: {}, id: clientId, messageQueue: [] };\n        // If an existing client, we close its socket before listening to the new socket.\n        if (client.socket) {\n          client.socket.close();\n          client.socket = null;\n        }\n        logger.info('Client #%s connecting with a new socket!', clientId);\n        client.socket = socket;\n        client.messageQueue.splice(0).forEach(function (message) {\n          return _this10._sendSocketMessage(client, message.data);\n        });\n        socket.on('message', function (message) {\n          return _this10._onSocketMessage(client, message);\n        });\n      });\n\n      socket.on('close', function () {\n        if (!client) {\n          return;\n        }\n        if (client.socket === socket) {\n          client.socket = null;\n        }\n        logger.info('Client #%s closing a socket!', client.id);\n        // TODO: enable subscription cleanup when we have a robust reconnect scenario.\n        /*\n        for (var channel in client.subscriptions) {\n          this.unsubscribe(channel, subscriptions[channel]);\n        }\n        this._eventSubscriptions.forEach(value => value.delete(client.id));\n        delete this._clients[client.id];\n        */\n      });\n    }\n  }, {\n    key: '_onSocketMessage',\n    value: _asyncToGenerator(function* (client, message) {\n      message = JSON.parse(message);\n      if (message.protocol && message.protocol === _config.SERVICE_FRAMEWORK3_CHANNEL) {\n        this._serverComponent.handleMessage(client, message);\n        return;\n      }\n\n      var _message = message;\n      var serviceName = _message.serviceName;\n      var methodName = _message.methodName;\n      var methodArgs = _message.methodArgs;\n      var serviceOptions = _message.serviceOptions;\n      var requestId = _message.requestId;\n\n      var result = null;\n      var error = null;\n\n      try {\n        result = yield this.callService('/' + serviceName + '/' + methodName, [serviceOptions].concat(methodArgs));\n      } catch (e) {\n        logger.error('Failed to call %s/%s with error %o', serviceName, methodName, e);\n        error = e;\n      }\n\n      this._sendSocketMessage(client, {\n        channel: _config.SERVICE_FRAMEWORK_RPC_CHANNEL,\n        requestId: requestId,\n        result: result,\n        error: error\n      });\n    })\n  }, {\n    key: '_sendSocketMessage',\n    value: function _sendSocketMessage(client, data) {\n      // Wrap the data in an object, because if `data` is a primitive data type,\n      // finding it in an array would return the first matching item, not necessarily the same inserted item.\n      var message = { data: data };\n      var id = client.id;\n      var socket = client.socket;\n      var messageQueue = client.messageQueue;\n\n      messageQueue.push(message);\n      if (!socket) {\n        return;\n      }\n      socket.send(JSON.stringify(data), function (err) {\n        if (err) {\n          logger.warn('Failed sending socket message to client:', id, data);\n        } else {\n          var messageIndex = messageQueue.indexOf(message);\n          if (messageIndex !== -1) {\n            messageQueue.splice(messageIndex, 1);\n          }\n        }\n      });\n    }\n  }, {\n    key: 'close',\n    value: function close() {\n      var _this11 = this;\n\n      (0, _assert2['default'])(NuclideServer._theServer === this);\n      NuclideServer._theServer = null;\n\n      this._webSocketServer.close();\n      this._webServer.close();\n      this._serviceWithoutServiceFrameworkConfigs.forEach(function (service_path) {\n        var _require8 = require(service_path);\n\n        var shutdown = _require8.shutdown;\n\n        if (shutdown) {\n          shutdown(_this11);\n        }\n      });\n    }\n  }], [{\n    key: 'shutdown',\n    value: function shutdown() {\n      logger.info('Shutting down the server');\n      try {\n        if (NuclideServer._theServer != null) {\n          NuclideServer._theServer.close();\n        }\n      } catch (e) {\n        logger.error('Error while shutting down, but proceeding anyway:', e);\n      } finally {\n        (0, _nuclideLogging.flushLogsAndExit)(0);\n      }\n    }\n  }]);\n\n  return NuclideServer;\n})();\n\nmodule.exports = NuclideServer;\n/* eventName */ /* clientId */\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi92YXIvZm9sZGVycy94Zi9yc3BoNF9jNTczMTVyczU3eHhzZHNrcnhudjM2dDAvVC90bXBwZmw1Mm5wdWJsaXNoX3BhY2thZ2VzL25wbS9udWNsaWRlLXNlcnZlci9saWIvTnVjbGlkZVNlcnZlci5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OztzQkFxQm1DLFVBQVU7O3NCQU92QixRQUFROzs7O2dDQUNELG9CQUFvQjs7Ozs4QkFFUCxpQkFBaUI7O0FBL0IzRCxXQUFXLENBQUM7Ozs7Ozs7Ozs7QUFXWixJQUFNLE9BQU8sR0FBRyxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUM7QUFDckMsSUFBTSxPQUFPLEdBQUcsT0FBTyxDQUFDLFNBQVMsQ0FBQyxDQUFDOztlQUVNLE9BQU8sQ0FBQyxtQkFBbUIsQ0FBQzs7SUFBOUQsVUFBVSxZQUFWLFVBQVU7SUFBRSxrQkFBa0IsWUFBbEIsa0JBQWtCOztBQUNyQyxJQUFNLElBQUksR0FBRyxPQUFPLENBQUMsTUFBTSxDQUFDLENBQUM7QUFDN0IsSUFBTSxLQUFLLEdBQUcsT0FBTyxDQUFDLE9BQU8sQ0FBQyxDQUFDOztnQkFNRCxPQUFPLENBQUMsNkJBQTZCLENBQUM7O0lBQTdELG1CQUFtQixhQUFuQixtQkFBbUI7O2dCQUVILE9BQU8sQ0FBQyxRQUFRLENBQUM7O0lBQWpDLFlBQVksYUFBWixZQUFZOztBQUNuQixJQUFNLGVBQWUsR0FBRyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsTUFBTSxDQUFDOztnQkFDaUIsT0FBTyxDQUFDLFNBQVMsQ0FBQzs7SUFBekUsZUFBZSxhQUFmLGVBQWU7SUFBRSxnQkFBZ0IsYUFBaEIsZ0JBQWdCO0lBQUUsZ0JBQWdCLGFBQWhCLGdCQUFnQjs7Z0JBQ3JDLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQzs7SUFBeEMsVUFBVSxhQUFWLFVBQVU7O0FBS2pCLElBQU0sTUFBTSxHQUFHLG9CQURQLFNBQVMsR0FDUyxDQUFDOztBQUszQixJQUFNLHVCQUF1QixH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Q0FBQyxDQUFDLENBQUM7T0FDdEUsU0FBUztBQUNSLDRCQWhPYSxnQkFBZ0IsRUFnT1osQ0FBQyxDQUFDLENBQUM7T0FDckI7S0FDRjs7O1NBck1HLGFBQWE7OztBQWtabkIsTUFBTSxDQUFDLE9BQU8sR0FBRyxhQUFhLENBQUMiLCJmaWxlIjoiL3Zhci9mb2xkZXJzL3hmL3JzcGg0X2M1NzMxNXJzNTd4eHNkc2tyeG52MzZ0MC9UL3RtcHBmbDUybnB1Ymxpc2hfcGFja2FnZXMvbnBtL251Y2xpZGUtc2VydmVyL2xpYi9OdWNsaWRlU2VydmVyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBiYWJlbCc7XG4vKiBAZmxvdyAqL1xuXG4vKlxuICogQ29weXJpZ2h0IChjKSAyMDE1LXByZXNlbnQsIEZhY2Vib29rLCBJbmMuXG4gKiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIGxpY2Vuc2UgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpblxuICogdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKi9cblxuY29uc3QgYmxvY2tlZCA9IHJlcXVpcmUoJy4vYmxvY2tlZCcpO1xuY29uc3QgY29ubmVjdCA9IHJlcXVpcmUoJ2Nvbm5lY3QnKTtcblxuY29uc3Qge2dldFNlcnZpY2UsIGdldFJlbW90ZUV2ZW50TmFtZX0gPSByZXF1aXJlKCcuL3NlcnZpY2UtbWFuYWdlcicpO1xuY29uc3QgaHR0cCA9IHJlcXVpcmUoJ2h0dHAnKTtcbmNvbnN0IGh0dHBzID0gcmVxdWlyZSgnaHR0cHMnKTtcbmltcG9ydCB7XG4gIEhFQVJUQkVBVF9DSEFOTkVMLFxuICBTRVJWSUNFX0ZSQU1FV09SS19FVkVOVF9DSEFOTkVMLFxuICBTRVJWSUNFX0ZSQU1FV09SS19SUENfQ0hBTk5FTCxcbiAgU0VSVklDRV9GUkFNRVdPUkszX0NIQU5ORUx9IGZyb20gJy4vY29uZmlnJztcbmNvbnN0IHtwYXJzZVNlcnZpY2VBcGlTeW5jfSA9IHJlcXVpcmUoJ251Y2xpZGUtc2VydmljZS10cmFuc2Zvcm1lcicpO1xuXG5jb25zdCB7RXZlbnRFbWl0dGVyfSA9IHJlcXVpcmUoJ2V2ZW50cycpO1xuY29uc3QgV2ViU29ja2V0U2VydmVyID0gcmVxdWlyZSgnd3MnKS5TZXJ2ZXI7XG5jb25zdCB7ZGVzZXJpYWxpemVBcmdzLCBzZW5kSnNvblJlc3BvbnNlLCBzZW5kVGV4dFJlc3BvbnNlfSA9IHJlcXVpcmUoJy4vdXRpbHMnKTtcbmNvbnN0IHtnZXRWZXJzaW9ufSA9IHJlcXVpcmUoJ251Y2xpZGUtdmVyc2lvbicpO1xuaW1wb3J0IGludmFyaWFudCBmcm9tICdhc3NlcnQnO1xuaW1wb3J0IFNlcnZpY2VGcmFtZXdvcmsgZnJvbSAnLi9zZXJ2aWNlZnJhbWV3b3JrJztcblxuaW1wb3J0IHtnZXRMb2dnZXIsIGZsdXNoTG9nc0FuZEV4aXR9IGZyb20gJ251Y2xpZGUtbG9nZ2luZyc7XG5jb25zdCBsb2dnZXIgPSBnZXRMb2dnZXIoKTtcblxuXG5cblxuY29uc3QgRVZFTlRfSEFORExFX1JFR0lTVEVSRUQgPSAnX251Y2xpZGVTZXJ2ZXJFdmVudEhhbmRsZVJlZ3N0ZXJlZCc7XG5cblxudHlwZSBOdWNsaWRlU2VydmVyT3B0aW9ucyA9IHtcbiAgcG9ydDogbnVtYmVyO1xuICBzZXJ2ZXJLZXk6ID9CdWZmZXI7XG4gIHNlcnZlckNlcnRpZmljYXRlOiA/QnVmZmVyO1xuICBjZXJ0aWZpY2F0ZUF1dGhvcml0eUNlcnRpZmljYXRlOiA/QnVmZmVyO1xuICB0cmFja0V2ZW50TG9vcDogP2Jvb2xlYW47XG59XG5cbmV4cG9ydCB0eXBlIFNvY2tldENsaWVudCA9IHtcbiAgaWQ6IHN0cmluZztcbiAgc3Vic2NyaXB0aW9uczoge1tjaGFubmVsOiBzdHJpbmddOiAoZXZlbnQ6IGFueSkgPT4gdm9pZH07XG4gIHNvY2tldDogP1dlYlNvY2tldDtcbn07XG5cbnR5cGUgU2VydmljZUNvbmZpZyA9IHtcbiAgbmFtZTogc3RyaW5nO1xuICBkZWZpbml0aW9uOiBzdHJpbmc7XG4gIGltcGxlbWVudGF0aW9uOiBzdHJpbmc7XG59XG5cbmNsYXNzIE51Y2xpZGVTZXJ2ZXIge1xuICBzdGF0aWMgX3RoZVNlcnZlcjogP051Y2xpZGVTZXJ2ZXI7XG5cbiAgX3dlYlNlcnZlcjogaHR0cC5TZXJ2ZXIgfCBodHRwcy5TZXJ2ZXI7XG4gIF93ZWJTb2NrZXRTZXJ2ZXI6IFdlYlNvY2tldFNlcnZlcjtcbiAgX2NsaWVudHM6IHtbY2xpZW50SWQ6IHN0cmluZ106IFNvY2tldENsaWVudH07XG4gIF9ldmVudFN1YnNjcmlwdGlvbnM6IE1hcDwvKiBldmVudE5hbWUgKi8gc3RyaW5nLCBTZXQ8LyogY2xpZW50SWQgKi8gc3RyaW5nPj47XG4gIF9wb3J0OiBudW1iZXI7XG4gIF9zZXJ2aWNlV2l0aG91dFNlcnZpY2VGcmFtZXdvcmtDb25maWdzOiBBcnJheTxzdHJpbmc+O1xuICBfc2VydmljZVdpdGhTZXJ2aWNlRnJhbWV3b3JrQ29uZmlnczogQXJyYXk8YW55PjtcblxuICBfc2VydmVyQ29tcG9uZW50OiBTZXJ2aWNlRnJhbWV3b3JrLlNlcnZlckNvbXBvbmVudDtcblxuICBjb25zdHJ1Y3RvcihvcHRpb25zOiBOdWNsaWRlU2VydmVyT3B0aW9ucykge1xuICAgIGludmFyaWFudChOdWNsaWRlU2VydmVyLl90aGVTZXJ2ZXIgPT0gbnVsbCk7XG4gICAgTnVjbGlkZVNlcnZlci5fdGhlU2VydmVyID0gdGhpcztcblxuICAgIGNvbnN0IHtzZXJ2ZXJLZXksIHNlcnZlckNlcnRpZmljYXRlLCBwb3J0LCBjZXJ0aWZpY2F0ZUF1dGhvcml0eUNlcnRpZmljYXRlLCB0cmFja0V2ZW50TG9vcH0gPSBvcHRpb25zO1xuXG4gICAgdGhpcy5fYXBwID0gY29ubmVjdCgpO1xuICAgIHRoaXMuX2F0dGFjaFV0aWxIYW5kbGVycyh0aGlzLl9hcHApO1xuICAgIGlmIChzZXJ2ZXJLZXkgJiYgc2VydmVyQ2VydGlmaWNhdGUgJiYgY2VydGlmaWNhdGVBdXRob3JpdHlDZXJ0aWZpY2F0ZSkge1xuICAgICAgY29uc3Qgd2ViU2VydmVyT3B0aW9ucyA9IHtcbiAgICAgICAga2V5OiBzZXJ2ZXJLZXksXG4gICAgICAgIGNlcnQ6IHNlcnZlckNlcnRpZmljYXRlLFxuICAgICAgICBjYTogY2VydGlmaWNhdGVBdXRob3JpdHlDZXJ0aWZpY2F0ZSxcbiAgICAgICAgcmVxdWVzdENlcnQ6IHRydWUsXG4gICAgICAgIHJlamVjdFVuYXV0aG9yaXplZDogdHJ1ZSxcbiAgICAgIH07XG5cbiAgICAgIHRoaXMuX3dlYlNlcnZlciA9IGh0dHBzLmNyZWF0ZVNlcnZlcih3ZWJTZXJ2ZXJPcHRpb25zLCB0aGlzLl9hcHApO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl93ZWJTZXJ2ZXIgPSBodHRwLmNyZWF0ZVNlcnZlcih0aGlzLl9hcHApO1xuICAgIH1cbiAgICB0aGlzLl9wb3J0ID0gcG9ydDtcblxuICAgIHRoaXMuX3dlYlNvY2tldFNlcnZlciA9IHRoaXMuX2NyZWF0ZVdlYlNvY2tldFNlcnZlcigpO1xuICAgIHRoaXMuX2NsaWVudHMgPSB7fTtcbiAgICB0aGlzLl9ldmVudFN1YnNjcmlwdGlvbnMgPSBuZXcgTWFwKCk7XG5cbiAgICB0aGlzLl9zZXR1cFNlcnZpY2VzKCk7IC8vIFNldHVwIDEuMCBhbmQgMi4wIHNlcnZpY2VzLlxuXG4gICAgaWYgKHRyYWNrRXZlbnRMb29wKSB7XG4gICAgICBibG9ja2VkKChtczogbnVtYmVyKSA9PiB7XG4gICAgICAgIGxvZ2dlci5pbmZvKCdOdWNsaWRlU2VydmVyIGV2ZW50IGxvb3AgYmxvY2tlZCBmb3IgJyArIG1zICsgJ21zJyk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICAvLyBTZXR1cCAzLjAgc2VydmljZXMuXG4gICAgdGhpcy5fc2VydmVyQ29tcG9uZW50ID0gbmV3IFNlcnZpY2VGcmFtZXdvcmsuU2VydmVyQ29tcG9uZW50KHRoaXMpO1xuICB9XG5cbiAgX2F0dGFjaFV0aWxIYW5kbGVycyhhcHApIHtcbiAgICAvLyBBZGQgc3BlY2lmaWMgbWV0aG9kIGhhbmRsZXJzLlxuICAgIFsnZ2V0JywgJ3Bvc3QnLCAnZGVsZXRlJywgJ3B1dCddLmZvckVhY2goKG1ldGhvZE5hbWUpID0+IHtcbiAgICAgIHRoaXMuX2FwcFttZXRob2ROYW1lXSA9ICh1cmksIGhhbmRsZXIpID0+IHtcbiAgICAgICAgdGhpcy5fYXBwLnVzZSh1cmksIChyZXF1ZXN0LCByZXNwb25zZSwgbmV4dCkgPT4ge1xuICAgICAgICAgIGlmIChyZXF1ZXN0Lm1ldGhvZC50b1VwcGVyQ2FzZSgpICE9PSBtZXRob2ROYW1lLnRvVXBwZXJDYXNlKCkpIHtcbiAgICAgICAgICAgIC8vIHNraXAgaWYgbWV0aG9kIGRvZXNuJ3QgbWF0Y2guXG4gICAgICAgICAgICByZXR1cm4gbmV4dCgpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBoYW5kbGVyKHJlcXVlc3QsIHJlc3BvbnNlLCBuZXh0KTtcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuXG4gIF9jcmVhdGVXZWJTb2NrZXRTZXJ2ZXIoKTogV2ViU29ja2V0U2VydmVyIHtcbiAgICBjb25zdCB3ZWJTb2NrZXRTZXJ2ZXIgPSBuZXcgV2ViU29ja2V0U2VydmVyKHtzZXJ2ZXI6IHRoaXMuX3dlYlNlcnZlcn0pO1xuICAgIHdlYlNvY2tldFNlcnZlci5vbignY29ubmVjdGlvbicsIChzb2NrZXQpID0+IHRoaXMuX29uQ29ubmVjdGlvbihzb2NrZXQpKTtcbiAgICB3ZWJTb2NrZXRTZXJ2ZXIub24oJ2Vycm9yJywgKGVycm9yKSA9PiBsb2dnZXIuZXJyb3IoJ1dlYlNvY2tldFNlcnZlciBFcnJvcjonLCBlcnJvcikpO1xuICAgIHJldHVybiB3ZWJTb2NrZXRTZXJ2ZXI7XG4gIH1cblxuICBfZ2V0U2VydmljZUZyYW1ld29ya1NlcnZpY2VBbmRSZWdpc3RlckV2ZW50SGFuZGxlKFxuICAgICAgc2VydmljZUNvbmZpZzogU2VydmljZUNvbmZpZywgc2VydmljZU9wdGlvbnM6IGFueSk6IGFueSB7XG4gICAgY29uc3QgbG9jYWxTZXJ2aWNlSW5zdGFuY2UgPSBnZXRTZXJ2aWNlKHNlcnZpY2VDb25maWcubmFtZSwgc2VydmljZU9wdGlvbnMsIHNlcnZpY2VDb25maWcuaW1wbGVtZW50YXRpb24pO1xuICAgIGlmIChsb2NhbFNlcnZpY2VJbnN0YW5jZVtFVkVOVF9IQU5ETEVfUkVHSVNURVJFRF0pIHtcbiAgICAgIHJldHVybiBsb2NhbFNlcnZpY2VJbnN0YW5jZTtcbiAgICB9XG5cbiAgICBjb25zdCBzZXJ2aWNlQXBpID0gcGFyc2VTZXJ2aWNlQXBpU3luYyhzZXJ2aWNlQ29uZmlnLmRlZmluaXRpb24sIHNlcnZpY2VDb25maWcubmFtZSk7XG5cbiAgICBzZXJ2aWNlQXBpLmV2ZW50TWV0aG9kTmFtZXMuZm9yRWFjaChtZXRob2ROYW1lID0+IHtcbiAgICAgIGxvY2FsU2VydmljZUluc3RhbmNlW21ldGhvZE5hbWVdLmNhbGwobG9jYWxTZXJ2aWNlSW5zdGFuY2UsICguLi5hcmdzKSA9PiB7XG4gICAgICAgIGNvbnN0IGV2ZW50TmFtZSA9IGdldFJlbW90ZUV2ZW50TmFtZShzZXJ2aWNlQ29uZmlnLm5hbWUsIG1ldGhvZE5hbWUsIHNlcnZpY2VPcHRpb25zKTtcbiAgICAgICAgKHRoaXMuX2V2ZW50U3Vic2NyaXB0aW9ucy5nZXQoZXZlbnROYW1lKSB8fCBbXSkuZm9yRWFjaChjbGllbnRJZCA9PiB7XG4gICAgICAgICAgY29uc3QgY2xpZW50ID0gdGhpcy5fY2xpZW50c1tjbGllbnRJZF07XG5cbiAgICAgICAgICBpZiAoIWNsaWVudCkge1xuICAgICAgICAgICAgbG9nZ2VyLndhcm4oJ0NsaWVudCB3aXRoIGNsaWVudElkOiAlcyBub3QgZm91bmQhJywgY2xpZW50SWQpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHRoaXMuX3NlbmRTb2NrZXRNZXNzYWdlKGNsaWVudCwge1xuICAgICAgICAgICAgY2hhbm5lbDogU0VSVklDRV9GUkFNRVdPUktfRVZFTlRfQ0hBTk5FTCxcbiAgICAgICAgICAgIGV2ZW50OiB7XG4gICAgICAgICAgICAgIG5hbWU6IGV2ZW50TmFtZSxcbiAgICAgICAgICAgICAgYXJncyxcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfSk7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KGxvY2FsU2VydmljZUluc3RhbmNlLCBFVkVOVF9IQU5ETEVfUkVHSVNURVJFRCwge3ZhbHVlOiB0cnVlfSk7XG5cbiAgICByZXR1cm4gbG9jYWxTZXJ2aWNlSW5zdGFuY2U7XG4gIH1cblxuICBfcmVnaXN0ZXJTZXJ2aWNlV2l0aFNlcnZpY2VGcmFtZXdvcmsoc2VydmljZUNvbmZpZzogU2VydmljZUNvbmZpZyk6IHZvaWQge1xuICAgIGNvbnN0IHNlcnZpY2VBcGkgPSBwYXJzZVNlcnZpY2VBcGlTeW5jKHNlcnZpY2VDb25maWcuZGVmaW5pdGlvbiwgc2VydmljZUNvbmZpZy5uYW1lKTtcblxuICAgIHNlcnZpY2VBcGkucnBjTWV0aG9kTmFtZXMuZm9yRWFjaChtZXRob2ROYW1lID0+IHtcbiAgICAgIHRoaXMuX3JlZ2lzdGVyU2VydmljZShcbiAgICAgICAgJy8nICsgc2VydmljZUFwaS5jbGFzc05hbWUgKyAnLycgKyBtZXRob2ROYW1lLFxuXG4gICAgICAgIC8vIFRha2Ugc2VydmljZU9wdGlvbnMgYXMgZmlyc3QgYXJndW1lbnQgZm9yIHNlcnZpY2VGcmFtZXdvcmsgc2VydmljZS5cbiAgICAgICAgLy8gVE9ETyhjaGVuc2hlbikgc2VwZXJhdGUgdGhlIGxvZ2ljIG9mIHNlcnZpY2UgaW5pdGlhbGl6YXRpb24uXG4gICAgICAgIChzZXJ2aWNlT3B0aW9ucywgLi4uYXJncykgPT4ge1xuICAgICAgICAgIGNvbnN0IGxvY2FsU2VydmljZUluc3RhbmNlID0gdGhpcy5fZ2V0U2VydmljZUZyYW1ld29ya1NlcnZpY2VBbmRSZWdpc3RlckV2ZW50SGFuZGxlKFxuICAgICAgICAgICAgICBzZXJ2aWNlQ29uZmlnLCBzZXJ2aWNlT3B0aW9ucyk7XG4gICAgICAgICAgcmV0dXJuIGxvY2FsU2VydmljZUluc3RhbmNlW21ldGhvZE5hbWVdLmFwcGx5KGxvY2FsU2VydmljZUluc3RhbmNlLCBhcmdzKTtcbiAgICAgICAgfSxcbiAgICAgICAgJ3Bvc3QnLFxuICAgICAgKTtcbiAgICB9KTtcblxuICB9XG5cbiAgX3JlZ2lzdGVyU2VydmljZVdpdGhvdXRTZXJ2aWNlRnJhbWV3b3JrKHNlcnZpY2VGaWxlUGF0aDogc3RyaW5nKTogdm9pZCB7XG4gICAgY29uc3Qge3VybEhhbmRsZXJzLCBzZXJ2aWNlcywgaW5pdGlhbGl6ZX0gPSByZXF1aXJlKHNlcnZpY2VGaWxlUGF0aCk7XG4gICAgZm9yIChjb25zdCBzZXJ2aWNlTmFtZSBpbiBzZXJ2aWNlcykge1xuICAgICAgY29uc3Qgc2VydmljZUNvbmZpZyA9IHNlcnZpY2VzW3NlcnZpY2VOYW1lXTtcbiAgICAgIHRoaXMuX3JlZ2lzdGVyU2VydmljZShzZXJ2aWNlTmFtZSwgc2VydmljZUNvbmZpZy5oYW5kbGVyLCBzZXJ2aWNlQ29uZmlnLm1ldGhvZCwgc2VydmljZUNvbmZpZy50ZXh0KTtcbiAgICB9XG5cbiAgICBpZiAodXJsSGFuZGxlcnMpIHtcbiAgICAgIGZvciAoY29uc3QgdXJsIGluIHVybEhhbmRsZXJzKSB7XG4gICAgICAgIGNvbnN0IGhhbmRsZXJDb25maWcgPSB1cmxIYW5kbGVyc1t1cmxdO1xuICAgICAgICB0aGlzLl9hdHRhY2hVcmxIYW5kbGVyKHVybCwgaGFuZGxlckNvbmZpZy5oYW5kbGVyLCBoYW5kbGVyQ29uZmlnLm1ldGhvZCk7XG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKGluaXRpYWxpemUpIHtcbiAgICAgIGluaXRpYWxpemUodGhpcyk7XG4gICAgfVxuICB9XG5cbiAgX3NldHVwU2VydmljZXMoKSB7XG4gICAgLy8gTGF6eSByZXF1aXJlIHRoZXNlIGZ1bmN0aW9ucyBzbyB0aGF0IHdlIGNvdWxkIHNweU9uIHRoZW0gd2hpbGUgdGVzdGluZyBpblxuICAgIC8vIFNlcnZpY2VJbnRlZ3JhdGlvblRlc3RIZWxwZXIuXG4gICAgY29uc3Qge2xvYWRDb25maWdzT2ZTZXJ2aWNlV2l0aFNlcnZpY2VGcmFtZXdvcmssXG4gICAgICBsb2FkQ29uZmlnc09mU2VydmljZVdpdGhvdXRTZXJ2aWNlRnJhbWV3b3JrfSA9IHJlcXVpcmUoJy4vY29uZmlnJyk7XG4gICAgdGhpcy5fc2VydmljZVJlZ2lzdHJ5ID0ge307XG4gICAgdGhpcy5fdmVyc2lvbiA9IGdldFZlcnNpb24oKS50b1N0cmluZygpO1xuICAgIHRoaXMuX3NldHVwSGVhcnRiZWF0SGFuZGxlcigpO1xuICAgIHRoaXMuX3NldHVwU2VydmljZUZyYW1ld29ya1N1YnNjcmlwdGlvbkhhbmRsZXIoKTtcbiAgICB0aGlzLl9zZXJ2aWNlV2l0aG91dFNlcnZpY2VGcmFtZXdvcmtDb25maWdzID0gbG9hZENvbmZpZ3NPZlNlcnZpY2VXaXRob3V0U2VydmljZUZyYW1ld29yaygpO1xuICAgIHRoaXMuX3NlcnZpY2VXaXRoU2VydmljZUZyYW1ld29ya0NvbmZpZ3MgPSBsb2FkQ29uZmlnc09mU2VydmljZVdpdGhTZXJ2aWNlRnJhbWV3b3JrKCk7XG5cbiAgICB0aGlzLl9zZXJ2aWNlV2l0aG91dFNlcnZpY2VGcmFtZXdvcmtDb25maWdzLmZvckVhY2goKGNvbmZpZzogc3RyaW5nKSA9PiB7XG4gICAgICB0aGlzLl9yZWdpc3RlclNlcnZpY2VXaXRob3V0U2VydmljZUZyYW1ld29yayhjb25maWcpO1xuICAgICAgbG9nZ2VyLmRlYnVnKGBSZWdpc3RlcmVkIHNlcnZpY2UgJHtjb25maWd9IHdpdGhvdXQgU2VydmljZUZyYW1ld29yay5gKTtcbiAgICB9KTtcblxuICAgIHRoaXMuX3NlcnZpY2VXaXRoU2VydmljZUZyYW1ld29ya0NvbmZpZ3MuZm9yRWFjaChjb25maWcgPT4ge1xuICAgICAgdGhpcy5fcmVnaXN0ZXJTZXJ2aWNlV2l0aFNlcnZpY2VGcmFtZXdvcmsoY29uZmlnKTtcbiAgICAgIGxvZ2dlci5kZWJ1ZyhgUmVnaXN0ZXJlZCBzZXJ2aWNlICR7Y29uZmlnLm5hbWV9IHdpdGggU2VydmljZUZyYW1ld29yay5gKTtcbiAgICB9KTtcblxuICAgIC8vIFNldHVwIGVycm9yIGhhbmRsZXIuXG4gICAgdGhpcy5fYXBwLnVzZSgoZXJyb3IsIHJlcXVlc3QsIHJlc3BvbnNlLCBuZXh0KSA9PiB7XG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgc2VuZEpzb25SZXNwb25zZShyZXNwb25zZSwge2NvZGU6IGVycm9yLmNvZGUsIG1lc3NhZ2U6IGVycm9yLm1lc3NhZ2V9LCA1MDApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgbmV4dCgpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgX3NldHVwSGVhcnRiZWF0SGFuZGxlcigpIHtcbiAgICB0aGlzLl9yZWdpc3RlclNlcnZpY2UoJy8nICsgSEVBUlRCRUFUX0NIQU5ORUwsIGFzeW5jICgpID0+IHRoaXMuX3ZlcnNpb24sXG4gICAgICAgICdwb3N0JywgdHJ1ZSk7XG4gIH1cblxuICBzdGF0aWMgc2h1dGRvd24oKTogdm9pZCB7XG4gICAgbG9nZ2VyLmluZm8oJ1NodXR0aW5nIGRvd24gdGhlIHNlcnZlcicpO1xuICAgIHRyeSB7XG4gICAgICBpZiAoTnVjbGlkZVNlcnZlci5fdGhlU2VydmVyICE9IG51bGwpIHtcbiAgICAgICAgTnVjbGlkZVNlcnZlci5fdGhlU2VydmVyLmNsb3NlKCk7XG4gICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgbG9nZ2VyLmVycm9yKCdFcnJvciB3aGlsZSBzaHV0dGluZyBkb3duLCBidXQgcHJvY2VlZGluZyBhbnl3YXk6JywgZSk7XG4gICAgfSBmaW5hbGx5IHtcbiAgICAgIGZsdXNoTG9nc0FuZEV4aXQoMCk7XG4gICAgfVxuICB9XG5cbiAgX3NldHVwU2VydmljZUZyYW1ld29ya1N1YnNjcmlwdGlvbkhhbmRsZXIoKSB7XG4gICAgdGhpcy5fcmVnaXN0ZXJTZXJ2aWNlKCcvc2VydmljZUZyYW1ld29yay9zdWJzY3JpYmVFdmVudCcsIChzZXJ2aWNlT3B0aW9uczogYW55LCBjbGllbnRJZDogc3RyaW5nLCBzZXJ2aWNlTmFtZTogc3RyaW5nLCBtZXRob2ROYW1lOiBzdHJpbmcpID0+IHtcblxuICAgICAgLy8gQ3JlYXRlIHRoZSBzZXJ2aWNlIGluc3RhbmNlIGFuZCByZWdpc3RlciB0aGUgZXZlbnQgaGFuZGxlLlxuICAgICAgY29uc3QgW3NlcnZpY2VDb25maWddID0gdGhpcy5fc2VydmljZVdpdGhTZXJ2aWNlRnJhbWV3b3JrQ29uZmlncy5maWx0ZXIoY29uZmlnID0+IGNvbmZpZy5uYW1lID09PSBzZXJ2aWNlTmFtZSk7XG4gICAgICB0aGlzLl9nZXRTZXJ2aWNlRnJhbWV3b3JrU2VydmljZUFuZFJlZ2lzdGVyRXZlbnRIYW5kbGUoc2VydmljZUNvbmZpZywgc2VydmljZU9wdGlvbnMpO1xuXG4gICAgICBjb25zdCBldmVudE5hbWUgPSBnZXRSZW1vdGVFdmVudE5hbWUoc2VydmljZU5hbWUsIG1ldGhvZE5hbWUsIHNlcnZpY2VPcHRpb25zKTtcblxuICAgICAgdGhpcy5fZXZlbnRTdWJzY3JpcHRpb25zLnNldChcbiAgICAgICAgZXZlbnROYW1lLFxuICAgICAgICAodGhpcy5fZXZlbnRTdWJzY3JpcHRpb25zLmdldChldmVudE5hbWUpIHx8IG5ldyBTZXQoKSkuYWRkKGNsaWVudElkKSxcbiAgICAgICk7XG5cbiAgICAgIGxvZ2dlci5kZWJ1ZyhgJHtjbGllbnRJZH0gc3Vic2NyaWJlZCB0byAke2V2ZW50TmFtZX1gKTtcbiAgICB9LCAncG9zdCcpO1xuXG4gICAgdGhpcy5fcmVnaXN0ZXJTZXJ2aWNlKCcvc2VydmljZUZyYW1ld29yay91bnN1YnNjcmliZUV2ZW50JywgKHNlcnZpY2VPcHRpb25zOiBhbnksIGNsaWVudElkOiBzdHJpbmcsIHNlcnZpY2VOYW1lOiBzdHJpbmcsIG1ldGhvZE5hbWU6IHN0cmluZykgPT4ge1xuICAgICAgY29uc3QgZXZlbnROYW1lID0gZ2V0UmVtb3RlRXZlbnROYW1lKHNlcnZpY2VOYW1lLCBtZXRob2ROYW1lLCBzZXJ2aWNlT3B0aW9ucyk7XG4gICAgICBpZiAodGhpcy5fZXZlbnRTdWJzY3JpcHRpb25zLmhhcyhldmVudE5hbWUpKSB7XG4gICAgICAgIHRoaXMuX2V2ZW50U3Vic2NyaXB0aW9ucy5nZXQoZXZlbnROYW1lKS5kZWxldGUoY2xpZW50SWQpO1xuICAgICAgfVxuICAgICAgbG9nZ2VyLmRlYnVnKGAke2NsaWVudElkfSB1bnN1YnNjcmliZWQgdG8gJHtldmVudE5hbWV9YCk7XG4gICAgfSwgJ3Bvc3QnKTtcbiAgfVxuXG4gIGNvbm5lY3QoKTogUHJvbWlzZSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIHRoaXMuX3dlYlNlcnZlci5vbignbGlzdGVuaW5nJywgKCkgPT4ge1xuICAgICAgICByZXNvbHZlKCk7XG4gICAgICB9KTtcbiAgICAgIHRoaXMuX3dlYlNlcnZlci5vbignZXJyb3InLCAoZSkgPT4ge1xuICAgICAgICB0aGlzLl93ZWJTZXJ2ZXIucmVtb3ZlQWxsTGlzdGVuZXJzKCk7XG4gICAgICAgIHJlamVjdChlKTtcbiAgICAgIH0pO1xuICAgICAgdGhpcy5fd2ViU2VydmVyLmxpc3Rlbih0aGlzLl9wb3J0KTtcbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxscyBhIHJlZ2lzdGVyZWQgc2VydmljZSB3aXRoIGEgbmFtZSBhbmQgYXJndW1lbnRzLlxuICAgKi9cbiAgY2FsbFNlcnZpY2Uoc2VydmljZU5hbWU6IHN0cmluZywgYXJnczogQXJyYXk8YW55Pik6IFByb21pc2U8YW55PiB7XG4gICAgY29uc3Qgc2VydmljZUZ1bmN0aW9uID0gdGhpcy5fc2VydmljZVJlZ2lzdHJ5W3NlcnZpY2VOYW1lXTtcbiAgICBpZiAoIXNlcnZpY2VGdW5jdGlvbikge1xuICAgICAgdGhyb3cgRXJyb3IoJ05vIHNlcnZpY2UgcmVnaXN0ZXJlZCB3aXRoIG5hbWU6ICcgKyBzZXJ2aWNlTmFtZSk7XG4gICAgfVxuICAgIHJldHVybiBzZXJ2aWNlRnVuY3Rpb24uYXBwbHkodGhpcywgYXJncyk7XG4gIH1cblxuICAvKipcbiAgICogUmVnaXN0ZXJzIGEgc2VydmljZSBmdW5jdGlvbiB0byBhIHNlcnZpY2UgbmFtZS5cbiAgICogVGhpcyBhbGxvd3Mgc2ltcGxlIGZ1dHVyZSBjYWxscyBvZiB0aGUgc2VydmljZSBieSBuYW1lIGFuZCBhcmd1bWVudHMgb3IgaHR0cC10cmlnZ2VyZWQgZW5kcG9pbnQgY2FsbHNcbiAgICogd2l0aCBhcmd1bWVudHMgc2VyaWFsaXplZCBvdmVyIGh0dHAuXG4gICAqL1xuICBfcmVnaXN0ZXJTZXJ2aWNlKFxuICAgICAgc2VydmljZU5hbWU6IHN0cmluZyxcbiAgICAgIHNlcnZpY2VGdW5jdGlvbjogKCkgPT4gUHJvbWlzZTxhbnk+LFxuICAgICAgbWV0aG9kOiA/c3RyaW5nID0gJ2dldCcsXG4gICAgICBpc1RleHRSZXNwb25zZTogP2Jvb2xlYW4pIHtcbiAgICBpZiAodGhpcy5fc2VydmljZVJlZ2lzdHJ5W3NlcnZpY2VOYW1lXSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdBIHNlcnZpY2Ugd2l0aCB0aGlzIG5hbWUgaXMgYWxyZWFkeSByZWdpc3RlcmVkOicsIHNlcnZpY2VOYW1lKTtcbiAgICB9XG4gICAgdGhpcy5fc2VydmljZVJlZ2lzdHJ5W3NlcnZpY2VOYW1lXSA9IHNlcnZpY2VGdW5jdGlvbjtcbiAgICB0aGlzLl9yZWdpc3Rlckh0dHBTZXJ2aWNlKHNlcnZpY2VOYW1lLCBtZXRob2QsIGlzVGV4dFJlc3BvbnNlKTtcbiAgfVxuXG4gIF9yZWdpc3Rlckh0dHBTZXJ2aWNlKHNlcnZpY2VOYW1lOiBzdHJpbmcsIG1ldGhvZDogc3RyaW5nLCBpc1RleHRSZXNwb25zZTogP2Jvb2xlYW4pIHtcbiAgICBjb25zdCBsb3dlcmVkQ2FzZU1ldGhvZCA9IG1ldGhvZC50b0xvd2VyQ2FzZSgpO1xuICAgIHRoaXMuX2FwcFtsb3dlcmVkQ2FzZU1ldGhvZF0oc2VydmljZU5hbWUsIGFzeW5jIChyZXF1ZXN0LCByZXNwb25zZSwgbmV4dCkgPT4ge1xuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5jYWxsU2VydmljZShzZXJ2aWNlTmFtZSwgZGVzZXJpYWxpemVBcmdzKHJlcXVlc3QudXJsKSk7XG4gICAgICAgIGlmIChpc1RleHRSZXNwb25zZSkge1xuICAgICAgICAgIHNlbmRUZXh0UmVzcG9uc2UocmVzcG9uc2UsIHJlc3VsdCB8fCAnJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgc2VuZEpzb25SZXNwb25zZShyZXNwb25zZSwgcmVzdWx0KTtcbiAgICAgICAgfVxuICAgICAgfSBjYXRjaChlKSB7XG4gICAgICAgIC8vIERlbGVnYXRlIHRvIHRoZSByZWdpc3RlcmVkIGNvbm5lY3QgZXJyb3IgaGFuZGxlci5cbiAgICAgICAgbmV4dChlKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIC8qKlxuICAgKiBBdHRhY2ggYW4gZXhwbGljaXQgaHR0cCBjb25uZWN0IGhhbmRsZXIgZm9yIHNvbWUgc2VydmljZXMgdGhhdCBuZWVkIHJlcXVlc3QvcmVzcG9uc2UgcmVsYXRlZCBvcHRpbWl6YXRpb25zLlxuICAgKiBlLmcuIHJlYWRGaWxlIGFuZCB3cml0ZUZpbGUgdXNlcyBpdCB0byBzdHJlYW0gcmVhZGluZyBhbmQgd3JpdGluZyBmaWxlcyAocGVyZiBpbXByb3ZlbWVudCBmb3IgYmlnIGZpbGVzKS5cbiAgICovXG4gIF9hdHRhY2hVcmxIYW5kbGVyKFxuICAgIHVybDogc3RyaW5nLFxuICAgIGhhbmRsZXI6IChyZXF1ZXN0OiBodHRwLkluY29taW5nTWVzc2FnZSwgcmVzcG9uc2U6IGh0dHAuT3V0Z29pbmdNZXNzYWdlLCBuZXh0OiAoZXJyOiBFcnJvcikgPT4gdm9pZCkgPT4gdm9pZCxcbiAgICBtZXRob2Q6ID9zdHJpbmcgPSAnZ2V0J1xuICApOiB2b2lkIHtcbiAgICB0aGlzLl9hcHBbbWV0aG9kXSh1cmwsIGhhbmRsZXIpO1xuICB9XG5cbiAgX29uQ29ubmVjdGlvbihzb2NrZXQ6IFdlYlNvY2tldCk6IHZvaWQge1xuICAgIGxvZ2dlci5kZWJ1ZygnV2ViU29ja2V0IGNvbm5lY3RpbmcnKTtcblxuXG4gICAgbGV0IGNsaWVudCA9IG51bGw7XG5cbiAgICBzb2NrZXQub24oJ2Vycm9yJywgKGUpID0+XG4gICAgICBsb2dnZXIuZXJyb3IoJ0NsaWVudCAjJXMgZXJyb3I6ICVzJywgY2xpZW50ID8gY2xpZW50LmlkIDogJ3Vua293bicsIGUubWVzc2FnZSkpO1xuXG4gICAgc29ja2V0Lm9uY2UoJ21lc3NhZ2UnLCAoY2xpZW50SWQpID0+IHtcbiAgICAgIGNsaWVudCA9IHRoaXMuX2NsaWVudHNbY2xpZW50SWRdID0gdGhpcy5fY2xpZW50c1tjbGllbnRJZF0gfHxcbiAgICAgICAgICB7c3Vic2NyaXB0aW9uczoge30sIGlkOiBjbGllbnRJZCwgbWVzc2FnZVF1ZXVlOiBbXX07XG4gICAgICAvLyBJZiBhbiBleGlzdGluZyBjbGllbnQsIHdlIGNsb3NlIGl0cyBzb2NrZXQgYmVmb3JlIGxpc3RlbmluZyB0byB0aGUgbmV3IHNvY2tldC5cbiAgICAgIGlmIChjbGllbnQuc29ja2V0KSB7XG4gICAgICAgIGNsaWVudC5zb2NrZXQuY2xvc2UoKTtcbiAgICAgICAgY2xpZW50LnNvY2tldCA9IG51bGw7XG4gICAgICB9XG4gICAgICBsb2dnZXIuaW5mbygnQ2xpZW50ICMlcyBjb25uZWN0aW5nIHdpdGggYSBuZXcgc29ja2V0IScsIGNsaWVudElkKTtcbiAgICAgIGNsaWVudC5zb2NrZXQgPSBzb2NrZXQ7XG4gICAgICBjbGllbnQubWVzc2FnZVF1ZXVlLnNwbGljZSgwKS5mb3JFYWNoKG1lc3NhZ2UgPT4gdGhpcy5fc2VuZFNvY2tldE1lc3NhZ2UoY2xpZW50LCBtZXNzYWdlLmRhdGEpKTtcbiAgICAgIHNvY2tldC5vbignbWVzc2FnZScsIChtZXNzYWdlKSA9PiB0aGlzLl9vblNvY2tldE1lc3NhZ2UoY2xpZW50LCBtZXNzYWdlKSk7XG4gICAgfSk7XG5cbiAgICBzb2NrZXQub24oJ2Nsb3NlJywgKCkgPT4ge1xuICAgICAgaWYgKCFjbGllbnQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKGNsaWVudC5zb2NrZXQgPT09IHNvY2tldCkge1xuICAgICAgICBjbGllbnQuc29ja2V0ID0gbnVsbDtcbiAgICAgIH1cbiAgICAgIGxvZ2dlci5pbmZvKCdDbGllbnQgIyVzIGNsb3NpbmcgYSBzb2NrZXQhJywgY2xpZW50LmlkKTtcbiAgICAgIC8vIFRPRE86IGVuYWJsZSBzdWJzY3JpcHRpb24gY2xlYW51cCB3aGVuIHdlIGhhdmUgYSByb2J1c3QgcmVjb25uZWN0IHNjZW5hcmlvLlxuICAgICAgLypcbiAgICAgIGZvciAodmFyIGNoYW5uZWwgaW4gY2xpZW50LnN1YnNjcmlwdGlvbnMpIHtcbiAgICAgICAgdGhpcy51bnN1YnNjcmliZShjaGFubmVsLCBzdWJzY3JpcHRpb25zW2NoYW5uZWxdKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuX2V2ZW50U3Vic2NyaXB0aW9ucy5mb3JFYWNoKHZhbHVlID0+IHZhbHVlLmRlbGV0ZShjbGllbnQuaWQpKTtcbiAgICAgIGRlbGV0ZSB0aGlzLl9jbGllbnRzW2NsaWVudC5pZF07XG4gICAgICAqL1xuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgX29uU29ja2V0TWVzc2FnZShjbGllbnQ6IFNvY2tldENsaWVudCwgbWVzc2FnZTogYW55KTogdm9pZCB7XG4gICAgbWVzc2FnZSA9IEpTT04ucGFyc2UobWVzc2FnZSk7XG4gICAgaWYgKG1lc3NhZ2UucHJvdG9jb2wgJiYgbWVzc2FnZS5wcm90b2NvbCA9PT0gU0VSVklDRV9GUkFNRVdPUkszX0NIQU5ORUwpIHtcbiAgICAgIHRoaXMuX3NlcnZlckNvbXBvbmVudC5oYW5kbGVNZXNzYWdlKGNsaWVudCwgbWVzc2FnZSk7XG4gICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgY29uc3Qge3NlcnZpY2VOYW1lLCBtZXRob2ROYW1lLCBtZXRob2RBcmdzLCBzZXJ2aWNlT3B0aW9ucywgcmVxdWVzdElkfSA9IG1lc3NhZ2U7XG4gICAgbGV0IHJlc3VsdCA9IG51bGw7XG4gICAgbGV0IGVycm9yID0gbnVsbDtcblxuICAgIHRyeSB7XG4gICAgICByZXN1bHQgPSBhd2FpdCB0aGlzLmNhbGxTZXJ2aWNlKFxuICAgICAgICAnLycgKyBzZXJ2aWNlTmFtZSArICcvJyArIG1ldGhvZE5hbWUsXG4gICAgICAgIFtzZXJ2aWNlT3B0aW9uc10uY29uY2F0KG1ldGhvZEFyZ3MpLFxuICAgICAgKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoJ0ZhaWxlZCB0byBjYWxsICVzLyVzIHdpdGggZXJyb3IgJW8nLCBzZXJ2aWNlTmFtZSwgbWV0aG9kTmFtZSwgZSk7XG4gICAgICBlcnJvciA9IGU7XG4gICAgfVxuXG4gICAgdGhpcy5fc2VuZFNvY2tldE1lc3NhZ2UoY2xpZW50LCB7XG4gICAgICBjaGFubmVsOiBTRVJWSUNFX0ZSQU1FV09SS19SUENfQ0hBTk5FTCxcbiAgICAgIHJlcXVlc3RJZCxcbiAgICAgIHJlc3VsdCxcbiAgICAgIGVycm9yLFxuICAgIH0pO1xuICB9XG5cbiAgX3NlbmRTb2NrZXRNZXNzYWdlKGNsaWVudDogU29ja2V0Q2xpZW50LCBkYXRhOiBhbnkpIHtcbiAgICAvLyBXcmFwIHRoZSBkYXRhIGluIGFuIG9iamVjdCwgYmVjYXVzZSBpZiBgZGF0YWAgaXMgYSBwcmltaXRpdmUgZGF0YSB0eXBlLFxuICAgIC8vIGZpbmRpbmcgaXQgaW4gYW4gYXJyYXkgd291bGQgcmV0dXJuIHRoZSBmaXJzdCBtYXRjaGluZyBpdGVtLCBub3QgbmVjZXNzYXJpbHkgdGhlIHNhbWUgaW5zZXJ0ZWQgaXRlbS5cbiAgICBjb25zdCBtZXNzYWdlID0ge2RhdGF9O1xuICAgIGNvbnN0IHtpZCwgc29ja2V0LCBtZXNzYWdlUXVldWV9ID0gY2xpZW50O1xuICAgIG1lc3NhZ2VRdWV1ZS5wdXNoKG1lc3NhZ2UpO1xuICAgIGlmICghc29ja2V0KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHNvY2tldC5zZW5kKEpTT04uc3RyaW5naWZ5KGRhdGEpLCAoZXJyKSA9PiB7XG4gICAgICBpZiAoZXJyKSB7XG4gICAgICAgIGxvZ2dlci53YXJuKCdGYWlsZWQgc2VuZGluZyBzb2NrZXQgbWVzc2FnZSB0byBjbGllbnQ6JywgaWQsIGRhdGEpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgbWVzc2FnZUluZGV4ID0gbWVzc2FnZVF1ZXVlLmluZGV4T2YobWVzc2FnZSk7XG4gICAgICAgIGlmIChtZXNzYWdlSW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgbWVzc2FnZVF1ZXVlLnNwbGljZShtZXNzYWdlSW5kZXgsIDEpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICBpbnZhcmlhbnQoTnVjbGlkZVNlcnZlci5fdGhlU2VydmVyID09PSB0aGlzKTtcbiAgICBOdWNsaWRlU2VydmVyLl90aGVTZXJ2ZXIgPSBudWxsO1xuXG4gICAgdGhpcy5fd2ViU29ja2V0U2VydmVyLmNsb3NlKCk7XG4gICAgdGhpcy5fd2ViU2VydmVyLmNsb3NlKCk7XG4gICAgdGhpcy5fc2VydmljZVdpdGhvdXRTZXJ2aWNlRnJhbWV3b3JrQ29uZmlncy5mb3JFYWNoKHNlcnZpY2VfcGF0aCA9PiB7XG4gICAgICBjb25zdCB7c2h1dGRvd259ID0gcmVxdWlyZShzZXJ2aWNlX3BhdGgpO1xuICAgICAgaWYgKHNodXRkb3duKSB7XG4gICAgICAgIHNodXRkb3duKHRoaXMpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gTnVjbGlkZVNlcnZlcjtcbiJdfQ==\n","/home/travis/build/npmtest/node-npmtest-nuclide-server/node_modules/nuclide-server/lib/serviceframework/index.js":"Object.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\n/*\n * Copyright (c) 2015-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the license found in the LICENSE file in\n * the root directory of this source tree.\n */\n\nvar _ServerComponent = require('./ServerComponent');\n\nvar _ServerComponent2 = _interopRequireDefault(_ServerComponent);\n\nvar _ClientComponent = require('./ClientComponent');\n\nvar _ClientComponent2 = _interopRequireDefault(_ClientComponent);\n\nvar _config = require('./config');\n\n'use babel';\nexports['default'] = { ServerComponent: _ServerComponent2['default'], ClientComponent: _ClientComponent2['default'], loadServicesConfig: _config.loadServicesConfig };\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi92YXIvZm9sZGVycy94Zi9yc3BoNF9jNTczMTVyczU3eHhzZHNrcnhudjM2dDAvVC90bXBwZmw1Mm5wdWJsaXNoX3BhY2thZ2VzL25wbS9udWNsaWRlLXNlcnZlci9saWIvc2VydmljZWZyYW1ld29yay9pbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7OzsrQkFXNkIsbUJBQW1COzs7OytCQUNuQixtQkFBbUI7Ozs7c0JBRWYsVUFBVTs7QUFkM0MsV0FBVyxDQUFDO3FCQWdCRyxFQUFDLGVBQWUsOEJBQUEsRUFBRSxlQUFlLDhCQUFBLEVBQUUsa0JBQWtCLFVBRjVELGtCQUFrQixBQUUwQyxFQUFDIiwiZmlsZSI6Ii92YXIvZm9sZGVycy94Zi9yc3BoNF9jNTczMTVyczU3eHhzZHNrcnhudjM2dDAvVC90bXBwZmw1Mm5wdWJsaXNoX3BhY2thZ2VzL25wbS9udWNsaWRlLXNlcnZlci9saWIvc2VydmljZWZyYW1ld29yay9pbmRleC5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2UgYmFiZWwnO1xuLyogQGZsb3cgKi9cblxuLypcbiAqIENvcHlyaWdodCAoYykgMjAxNS1wcmVzZW50LCBGYWNlYm9vaywgSW5jLlxuICogQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBsaWNlbnNlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUgaW5cbiAqIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICovXG5cbmltcG9ydCBTZXJ2ZXJDb21wb25lbnQgZnJvbSAgJy4vU2VydmVyQ29tcG9uZW50JztcbmltcG9ydCBDbGllbnRDb21wb25lbnQgZnJvbSAgJy4vQ2xpZW50Q29tcG9uZW50JztcblxuaW1wb3J0IHtsb2FkU2VydmljZXNDb25maWd9IGZyb20gJy4vY29uZmlnJztcblxuZXhwb3J0IGRlZmF1bHQge1NlcnZlckNvbXBvbmVudCwgQ2xpZW50Q29tcG9uZW50LCBsb2FkU2VydmljZXNDb25maWd9O1xuIl19\n","/home/travis/build/npmtest/node-npmtest-nuclide-server/node_modules/nuclide-server/lib/serviceframework/ServerComponent.js":"Object.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { var callNext = step.bind(null, 'next'); var callThrow = step.bind(null, 'throw'); function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(callNext, callThrow); } } callNext(); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\n/*\n * Copyright (c) 2015-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the license found in the LICENSE file in\n * the root directory of this source tree.\n */\n\nvar _rx = require('rx');\n\nvar _nuclideServiceParser = require('nuclide-service-parser');\n\nvar _config = require('./config');\n\nvar _NuclideServer = require('../NuclideServer');\n\nvar _NuclideServer2 = _interopRequireDefault(_NuclideServer);\n\nvar _nuclideServiceParserLibTypeRegistry = require('nuclide-service-parser/lib/TypeRegistry');\n\nvar _nuclideServiceParserLibTypeRegistry2 = _interopRequireDefault(_nuclideServiceParserLibTypeRegistry);\n\n'use babel';\n\nvar logger = require('nuclide-logging').getLogger();\n\nvar ServerComponent = (function () {\n  function ServerComponent(server) {\n    var _this = this;\n\n    _classCallCheck(this, ServerComponent);\n\n    this._server = server;\n\n    this._typeRegistry = new _nuclideServiceParserLibTypeRegistry2['default']();\n    this._functionsByName = new Map();\n    this._classesByName = new Map();\n\n    this._nextObjectId = 1;\n    this._objectRegistry = new Map();\n\n    this._subscriptions = new Map();\n\n    // NuclideUri type requires no transformations (it is done on the client side).\n    this._typeRegistry.registerType('NuclideUri', function (uri) {\n      return uri;\n    }, function (remotePath) {\n      return remotePath;\n    });\n\n    var services = (0, _config.loadServicesConfig)();\n\n    var _loop = function (service) {\n      logger.debug('Registering 3.0 service ' + service.name + '...');\n      try {\n        (function () {\n          var defs = (0, _nuclideServiceParser.getDefinitions)(service.definition);\n          var localImpl = require(service.implementation);\n\n          // Register type aliases.\n          defs.forEach(function (definition) {\n            var name = definition.name;\n            switch (definition.kind) {\n              case 'alias':\n                logger.debug('Registering type alias ' + name + '...');\n                if (definition.definition != null) {\n                  _this._typeRegistry.registerAlias(name, definition.definition);\n                }\n                break;\n              case 'function':\n                // Register module-level functions.\n                _this._registerFunction(service.name + '/' + name, localImpl[name], definition.type);\n                break;\n              case 'interface':\n                // Register interfaces.\n                logger.debug('Registering interface ' + name + '...');\n                _this._classesByName.set(name, {\n                  localImplementation: localImpl[name],\n                  definition: definition\n                });\n\n                _this._typeRegistry.registerType(name, _asyncToGenerator(function* (object) {\n                  // If the object has already been assigned an id, return that id.\n                  if (object._remoteId) {\n                    return object._remoteId;\n                  }\n\n                  // Put the object in the registry.\n                  object._interface = name;\n                  var objectId = _this._nextObjectId;\n                  _this._objectRegistry.set(objectId, object);\n                  object._remoteId = objectId;\n                  _this._nextObjectId++;\n\n                  return objectId;\n                }), _asyncToGenerator(function* (objectId) {\n                  return _this._objectRegistry.get(objectId);\n                }));\n\n                // Register all of the static methods as remote functions.\n                definition.staticMethods.forEach(function (funcType, funcName) {\n                  _this._registerFunction(name + '/' + funcName, localImpl[name][funcName], funcType);\n                });\n                break;\n            }\n          });\n        })();\n      } catch (e) {\n        logger.error('Failed to load service ' + service.name + '. Stack Trace:\\n' + e.stack);\n        return 'continue';\n      }\n    };\n\n    for (var service of services) {\n      var _ret = _loop(service);\n\n      if (_ret === 'continue') continue;\n    }\n  }\n\n  /**\n   * A helper function that let's us 'apply' an array of arguments to a constructor.\n   * It works by creating a new constructor that has the same prototype as the original\n   * constructor, and simply applies the original constructor directly to 'this'.\n   * @returns An instance of classObject.\n   */\n\n  _createClass(ServerComponent, [{\n    key: '_registerFunction',\n    value: function _registerFunction(name, localImpl, type) {\n      logger.debug('Registering function ' + name + '...');\n      if (this._functionsByName.has(name)) {\n        throw new Error('Duplicate RPC function: ' + name);\n      }\n      this._functionsByName.set(name, {\n        localImplementation: localImpl,\n        type: type\n      });\n    }\n  }, {\n    key: 'handleMessage',\n    value: _asyncToGenerator(function* (client, message) {\n      var _this2 = this;\n\n      var requestId = message.requestId;\n\n      var returnVal = null;\n      var returnType = { kind: 'void' };\n      var callError = undefined;\n      var hadError = false;\n\n      try {\n        switch (message.type) {\n          case 'FunctionCall':\n            // Transform arguments and call function.\n\n            var _functionsByName$get = this._functionsByName.get(message['function']),\n                fcLocalImplementation = _functionsByName$get.localImplementation,\n                fcType = _functionsByName$get.type;\n\n            var fcTransfomedArgs = yield Promise.all(message.args.map(function (arg, i) {\n              return _this2._typeRegistry.unmarshal(arg, fcType.argumentTypes[i]);\n            }));\n\n            // Invoke function and return the results.\n            returnType = fcType.returnType;\n            returnVal = fcLocalImplementation.apply(this, fcTransfomedArgs);\n            break;\n          case 'MethodCall':\n            // Get the object.\n            var mcObject = this._objectRegistry.get(message.objectId);\n\n            // Get the method FunctionType description.\n            var mcType = this._classesByName.get(mcObject._interface).definition.instanceMethods.get(message.method);\n\n            // Unmarshal arguments.\n            var mcTransfomedArgs = yield Promise.all(message.args.map(function (arg, i) {\n              return _this2._typeRegistry.unmarshal(arg, mcType.argumentTypes[i]);\n            }));\n\n            // Invoke message.\n            returnType = mcType.returnType;\n            returnVal = mcObject[message.method].apply(mcObject, mcTransfomedArgs);\n            break;\n          case 'NewObject':\n            var _classesByName$get = this._classesByName.get(message['interface']),\n                noLocalImplementation = _classesByName$get.localImplementation,\n                noDefinition = _classesByName$get.definition;\n\n            // Transform arguments.\n            var noTransfomedArgs = yield Promise.all(message.args.map(function (arg, i) {\n              return _this2._typeRegistry.unmarshal(arg, noDefinition.constructorArgs[i]);\n            }));\n\n            // Create a new object and put it in the registry.\n            var noObject = construct(noLocalImplementation, noTransfomedArgs);\n\n            // Return the object, which will automatically be converted to an id through the\n            // marshalling system.\n            returnType = { kind: 'promise', type: { kind: 'named', name: message['interface'] } };\n            returnVal = Promise.resolve(noObject);\n            break;\n          case 'DisposeObject':\n            // Get the object.\n            var doObject = this._objectRegistry.get(message.objectId);\n\n            // Remove the object from the registry, and scrub it's id.\n            doObject._remoteId = undefined;\n            this._objectRegistry['delete'](message.objectId);\n\n            // Call the object's local dispose function.\n            returnType = { kind: 'promise', type: { kind: 'void' } };\n            yield doObject.dispose();\n\n            // Return a void Promise\n            returnVal = Promise.resolve();\n            break;\n          case 'DisposeObservable':\n            // Dispose an in-progress observable, before it has naturally completed.\n            if (this._subscriptions.has(requestId)) {\n              this._subscriptions.get(requestId).dispose();\n              this._subscriptions['delete'](requestId);\n            }\n            break;\n          default:\n            throw new Error('Unkown message type ' + message.type);\n        }\n      } catch (e) {\n        logger.error(e != null ? e.message : e);\n        callError = e;\n        hadError = true;\n      }\n\n      switch (returnType.kind) {\n        case 'void':\n          break; // No need to send anything back to the user.\n        case 'promise':\n          // If there was an error executing the command, we send that back as a rejected promise.\n          if (hadError) {\n            returnVal = Promise.reject(callError);\n          }\n\n          // Ensure that the return value is a promise.\n          if (!isThenable(returnVal)) {\n            returnVal = Promise.reject(new Error('Expected a Promise, but the function returned something else.'));\n          }\n\n          // Marshal the result, to send over the network.\n          returnVal = returnVal.then(function (value) {\n            return _this2._typeRegistry.marshal(value, returnType.type);\n          });\n\n          // Send the result of the promise across the socket.\n          returnVal.then(function (result) {\n            var resultMessage = {\n              channel: 'service_framework3_rpc',\n              type: 'PromiseMessage',\n              requestId: requestId,\n              result: result,\n              hadError: false\n            };\n            _this2._server._sendSocketMessage(client, resultMessage);\n          }, function (error) {\n            var errorMessage = {\n              channel: 'service_framework3_rpc',\n              type: 'ErrorMessage',\n              requestId: requestId,\n              hadError: true,\n              error: formatError(error)\n            };\n            _this2._server._sendSocketMessage(client, errorMessage);\n          });\n          break;\n        case 'observable':\n          // If there was an error executing the command, we send that back as an error Observable.\n          if (hadError) {\n            returnVal = _rx.Observable['throw'](callError);\n          }\n\n          // Ensure that the return value is an observable.\n          if (!isObservable(returnVal)) {\n            returnVal = _rx.Observable['throw'](new Error('Expected an Observable, but the function returned something else.'));\n          }\n\n          // Marshal the result, to send over the network.\n          returnVal = returnVal.concatMap(function (value) {\n            return _this2._typeRegistry.marshal(value, returnType.type);\n          });\n\n          // Send the next, error, and completion events of the observable across the socket.\n          var subscription = returnVal.subscribe(function (data) {\n            var eventMessage = {\n              channel: 'service_framework3_rpc',\n              type: 'ObservableMessage',\n              requestId: requestId,\n              hadError: false,\n              result: {\n                type: 'next',\n                data: data\n              }\n            };\n            _this2._server._sendSocketMessage(client, eventMessage);\n          }, function (error) {\n            var errorMessage = {\n              channel: 'service_framework3_rpc',\n              type: 'ErrorMessage',\n              requestId: requestId,\n              hadError: true,\n              error: formatError(error)\n            };\n            _this2._server._sendSocketMessage(client, errorMessage);\n            _this2._subscriptions['delete'](requestId);\n          }, function (completed) {\n            var eventMessage = {\n              channel: 'service_framework3_rpc',\n              type: 'ObservableMessage',\n              requestId: requestId,\n              hadError: false,\n              result: { type: 'completed' }\n            };\n            _this2._server._sendSocketMessage(client, eventMessage);\n            _this2._subscriptions['delete'](requestId);\n          });\n          this._subscriptions.set(requestId, subscription);\n          break;\n        default:\n          throw new Error('Unkown return type ' + returnType.kind + '.');\n      }\n    })\n  }]);\n\n  return ServerComponent;\n})();\n\nexports['default'] = ServerComponent;\nfunction construct(classObject, args) {\n  function F() {\n    return classObject.apply(this, args);\n  }\n  F.prototype = classObject.prototype;\n  return new F();\n}\n\n/**\n * A helper function that checks if an object is thenable (Promise-like).\n */\nfunction isThenable(object) {\n  return Boolean(object && object.then);\n}\n\n/**\n * A helper function that checks if an object is an Observable.\n */\nfunction isObservable(object) {\n  return Boolean(object && object.concatMap && object.subscribe);\n}\n\n/**\n * Format the error before sending over the web socket.\n * TODO: This should be a custom marshaller registered in the TypeRegistry\n */\nfunction formatError(error) {\n  if (error instanceof Error) {\n    return {\n      message: error.message,\n      code: error.code,\n      stack: error.stack\n    };\n  } else if (typeof error === 'string') {\n    return error.toString();\n  } else if (error === undefined) {\n    return undefined;\n  } else {\n    return 'Unknown Error: ' + error.toString();\n  }\n}\nmodule.exports = exports['default'];\n\n/**\n * Store a mapping from function name to a structure holding both the local implementation and\n * the type definition of the function.\n */\n\n/**\n * Store a mapping from a class name to a struct containing it's local constructor and it's\n * interface definition.\n */\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi92YXIvZm9sZGVycy94Zi9yc3BoNF9jNTczMTVyczU3eHhzZHNrcnhudjM2dDAvVC90bXBwZmw1Mm5wdWJsaXNoX3BhY2thZ2VzL25wbS9udWNsaWRlLXNlcnZlci9saWIvc2VydmljZWZyYW1ld29yay9TZXJ2ZXJDb21wb25lbnQuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7a0JBV3FDLElBQUk7O29DQUNaLHdCQUF3Qjs7c0JBQ3BCLFVBQVU7OzZCQUNqQixrQkFBa0I7Ozs7bURBQ25CLHlDQUF5Qzs7OztBQWZsRSxXQUFXLENBQUM7O0FBcUJaLElBQU0sTUFBTSxHQUFHLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLFNBQVMsRUFBRSxDQUFDOztJQUVqQyxlQUFlO0FBc0J2QixXQXRCUSxlQUFlLENBc0J0QixNQUFxQixFQUFFOzs7MEJBdEJoQixlQUFlOztBQXVCaEMsUUFBSSxDQUFDLE9BQU8sR0FBRyxNQUFNLENBQUM7O0FBRXRCLFFBQUksQ0FBQyxhQUFhLEdBQUcsc0RBQWtCLENBQUM7QUFDeEMsUUFBSSxDQUFDLGdCQUFnQixHQUFHLElBQUksR0FBRyxFQUFFLENBQUM7QUFDbEMsUUFBSSxDQUFDLGNBQWMsR0FBRyxJQUFJLEdBQUcsRUFBRSxDQUFDOztBQUVoQyxRQUFJLENBQUMsYUFBYSxHQUFHLENBQUMsQ0FBQztBQUN2QixRQUFJLENBQUMsZUFBZSxHQUFHLElBQUksR0FBRyxFQUFFLENBQUM7O0FBRWpDLFFBQUksQ0FBQyxjQUFjLEdBQUcsSUFBSSxHQUFHLEVBQUUsQ0FBQzs7O0FBR2hDLFFBQUksQ0FBQyxhQUFhLENBQUMsWUFBWSxDQUFDLFlBQVksRUFBRSxVQUFBLEdBQUc7YUFBSSxHQUFHO0tBQUEsRUFBRSxVQUFBLFVBQVU7YUFBSSxVQUFVO0tBQUEsQ0FBQyxDQUFDOztBQUVwRixRQUFNLFFBQVEsR0FBRyxZQS9DYixrQkFBa0IsR0ErQ2UsQ0FBQzs7MEJBQzNCLE9BQU87QUFDaEIs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TUFBTSxJQUFJLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztDQUN2Qzs7Ozs7QUFLRCxTQUFTLFlBQVksQ0FBQyxNQUFXLEVBQVc7QUFDMUMsU0FBTyxPQUFPLENBQUMsTUFBTSxJQUFJLE1BQU0sQ0FBQyxTQUFTLElBQUksTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0NBQ2hFOzs7Ozs7QUFNRCxTQUFTLFdBQVcsQ0FBQyxLQUFLLEVBQXNCO0FBQzlDLE1BQUksS0FBSyxZQUFZLEtBQUssRUFBRTtBQUMxQixXQUFPO0FBQ0wsYUFBTyxFQUFFLEtBQUssQ0FBQyxPQUFPO0FBQ3RCLFVBQUksRUFBRSxLQUFLLENBQUMsSUFBSTtBQUNoQixXQUFLLEVBQUUsS0FBSyxDQUFDLEtBQUs7S0FDbkIsQ0FBQztHQUNILE1BQU0sSUFBSSxPQUFPLEtBQUssS0FBSyxRQUFRLEVBQUU7QUFDcEMsV0FBTyxLQUFLLENBQUMsUUFBUSxFQUFFLENBQUM7R0FDekIsTUFBTSxJQUFJLEtBQUssS0FBSyxTQUFTLEVBQUU7QUFDOUIsV0FBTyxTQUFTLENBQUM7R0FDbEIsTUFBTTtBQUNMLCtCQUF5QixLQUFLLENBQUMsUUFBUSxFQUFFLENBQUc7R0FDN0M7Q0FDRiIsImZpbGUiOiIvdmFyL2ZvbGRlcnMveGYvcnNwaDRfYzU3MzE1cnM1N3h4c2Rza3J4bnYzNnQwL1QvdG1wcGZsNTJucHVibGlzaF9wYWNrYWdlcy9ucG0vbnVjbGlkZS1zZXJ2ZXIvbGliL3NlcnZpY2VmcmFtZXdvcmsvU2VydmVyQ29tcG9uZW50LmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBiYWJlbCc7XG4vKiBAZmxvdyAqL1xuXG4vKlxuICogQ29weXJpZ2h0IChjKSAyMDE1LXByZXNlbnQsIEZhY2Vib29rLCBJbmMuXG4gKiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIGxpY2Vuc2UgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpblxuICogdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKi9cblxuaW1wb3J0IHtEaXNwb3NhYmxlLCBPYnNlcnZhYmxlfSBmcm9tICdyeCc7XG5pbXBvcnQge2dldERlZmluaXRpb25zfSBmcm9tICdudWNsaWRlLXNlcnZpY2UtcGFyc2VyJztcbmltcG9ydCB7bG9hZFNlcnZpY2VzQ29uZmlnfSBmcm9tICcuL2NvbmZpZyc7XG5pbXBvcnQgTnVjbGlkZVNlcnZlciBmcm9tICcuLi9OdWNsaWRlU2VydmVyJztcbmltcG9ydCBUeXBlUmVnaXN0cnkgZnJvbSAnbnVjbGlkZS1zZXJ2aWNlLXBhcnNlci9saWIvVHlwZVJlZ2lzdHJ5JztcblxuaW1wb3J0IHR5cGUge1JlcXVlc3RNZXNzYWdlLCBFcnJvclJlc3BvbnNlTWVzc2FnZSwgUHJvbWlzZVJlc3BvbnNlTWVzc2FnZSxcbiAgT2JzZXJ2YWJsZVJlc3BvbnNlTWVzc2FnZX0gZnJvbSAnLi90eXBlcyc7XG5pbXBvcnQgdHlwZSB7U29ja2V0Q2xpZW50fSBmcm9tICcuLi9OdWNsaWRlU2VydmVyJztcblxuY29uc3QgbG9nZ2VyID0gcmVxdWlyZSgnbnVjbGlkZS1sb2dnaW5nJykuZ2V0TG9nZ2VyKCk7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlcnZlckNvbXBvbmVudCB7XG4gIF90eXBlUmVnaXN0cnk6IFR5cGVSZWdpc3RyeTtcblxuICAvKipcbiAgICogU3RvcmUgYSBtYXBwaW5nIGZyb20gZnVuY3Rpb24gbmFtZSB0byBhIHN0cnVjdHVyZSBob2xkaW5nIGJvdGggdGhlIGxvY2FsIGltcGxlbWVudGF0aW9uIGFuZFxuICAgKiB0aGUgdHlwZSBkZWZpbml0aW9uIG9mIHRoZSBmdW5jdGlvbi5cbiAgICovXG4gIF9mdW5jdGlvbnNCeU5hbWU6IE1hcDxzdHJpbmcsIHtsb2NhbEltcGxlbWVudGF0aW9uOiBGdW5jdGlvbjsgdHlwZTogRnVuY3Rpb25UeXBlfT47XG5cbiAgLyoqXG4gICAqIFN0b3JlIGEgbWFwcGluZyBmcm9tIGEgY2xhc3MgbmFtZSB0byBhIHN0cnVjdCBjb250YWluaW5nIGl0J3MgbG9jYWwgY29uc3RydWN0b3IgYW5kIGl0J3NcbiAgICogaW50ZXJmYWNlIGRlZmluaXRpb24uXG4gICAqL1xuICBfY2xhc3Nlc0J5TmFtZTogTWFwPHN0cmluZywge2xvY2FsSW1wbGVtZW50YXRpb246IGFueTsgZGVmaW5pdGlvbjogSW50ZXJmYWNlRGVmaW5pdGlvbn0+O1xuXG4gIF9vYmplY3RSZWdpc3RyeTogTWFwPG51bWJlciwgYW55PjtcbiAgX25leHRPYmplY3RJZDogbnVtYmVyO1xuXG4gIF9zdWJzY3JpcHRpb25zOiBNYXA8bnVtYmVyLCBEaXNwb3NhYmxlPjtcblxuICBfc2VydmVyOiBOdWNsaWRlU2VydmVyO1xuXG4gIGNvbnN0cnVjdG9yKHNlcnZlcjogTnVjbGlkZVNlcnZlcikge1xuICAgIHRoaXMuX3NlcnZlciA9IHNlcnZlcjtcblxuICAgIHRoaXMuX3R5cGVSZWdpc3RyeSA9IG5ldyBUeXBlUmVnaXN0cnkoKTtcbiAgICB0aGlzLl9mdW5jdGlvbnNCeU5hbWUgPSBuZXcgTWFwKCk7XG4gICAgdGhpcy5fY2xhc3Nlc0J5TmFtZSA9IG5ldyBNYXAoKTtcblxuICAgIHRoaXMuX25leHRPYmplY3RJZCA9IDE7XG4gICAgdGhpcy5fb2JqZWN0UmVnaXN0cnkgPSBuZXcgTWFwKCk7XG5cbiAgICB0aGlzLl9zdWJzY3JpcHRpb25zID0gbmV3IE1hcCgpO1xuXG4gICAgLy8gTnVjbGlkZVVyaSB0eXBlIHJlcXVpcmVzIG5vIHRyYW5zZm9ybWF0aW9ucyAoaXQgaXMgZG9uZSBvbiB0aGUgY2xpZW50IHNpZGUpLlxuICAgIHRoaXMuX3R5cGVSZWdpc3RyeS5yZWdpc3RlclR5cGUoJ051Y2xpZGVVcmknLCB1cmkgPT4gdXJpLCByZW1vdGVQYXRoID0+IHJlbW90ZVBhdGgpO1xuXG4gICAgY29uc3Qgc2VydmljZXMgPSBsb2FkU2VydmljZXNDb25maWcoKTtcbiAgICBmb3IgKGNvbnN0IHNlcnZpY2Ugb2Ygc2VydmljZXMpIHtcbiAgICAgIGxvZ2dlci5kZWJ1ZyhgUmVnaXN0ZXJpbmcgMy4wIHNlcnZpY2UgJHtzZXJ2aWNlLm5hbWV9Li4uYCk7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBkZWZzID0gZ2V0RGVmaW5pdGlvbnMoc2VydmljZS5kZWZpbml0aW9uKTtcbiAgICAgICAgY29uc3QgbG9jYWxJbXBsID0gcmVxdWlyZShzZXJ2aWNlLmltcGxlbWVudGF0aW9uKTtcblxuICAgICAgICAvLyBSZWdpc3RlciB0eXBlIGFsaWFzZXMuXG4gICAgICAgIGRlZnMuZm9yRWFjaChkZWZpbml0aW9uID0+IHtcbiAgICAgICAgICBjb25zdCBuYW1lID0gZGVmaW5pdGlvbi5uYW1lO1xuICAgICAgICAgIHN3aXRjaCAoZGVmaW5pdGlvbi5raW5kKSB7XG4gICAgICAgICAgICBjYXNlICdhbGlhcyc6XG4gICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZyhgUmVnaXN0ZXJpbmcgdHlwZSBhbGlhcyAke25hbWV9Li4uYCk7XG4gICAgICAgICAgICAgIGlmIChkZWZpbml0aW9uLmRlZmluaXRpb24gIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgIHRoaXMuX3R5cGVSZWdpc3RyeS5yZWdpc3RlckFsaWFzKG5hbWUsIGRlZmluaXRpb24uZGVmaW5pdGlvbik7XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdmdW5jdGlvbic6XG4gICAgICAgICAgICAgIC8vIFJlZ2lzdGVyIG1vZHVsZS1sZXZlbCBmdW5jdGlvbnMuXG4gICAgICAgICAgICAgIHRoaXMuX3JlZ2lzdGVyRnVuY3Rpb24oYCR7c2VydmljZS5uYW1lfS8ke25hbWV9YCwgbG9jYWxJbXBsW25hbWVdLCBkZWZpbml0aW9uLnR5cGUpO1xuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2ludGVyZmFjZSc6XG4gICAgICAgICAgICAgIC8vIFJlZ2lzdGVyIGludGVyZmFjZXMuXG4gICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZyhgUmVnaXN0ZXJpbmcgaW50ZXJmYWNlICR7bmFtZX0uLi5gKTtcbiAgICAgICAgICAgICAgdGhpcy5fY2xhc3Nlc0J5TmFtZS5zZXQobmFtZSwgIHtcbiAgICAgICAgICAgICAgICBsb2NhbEltcGxlbWVudGF0aW9uOiBsb2NhbEltcGxbbmFtZV0sXG4gICAgICAgICAgICAgICAgZGVmaW5pdGlvbixcbiAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgdGhpcy5fdHlwZVJlZ2lzdHJ5LnJlZ2lzdGVyVHlwZShuYW1lLCBhc3luYyBvYmplY3QgPT4ge1xuICAgICAgICAgICAgICAgIC8vIElmIHRoZSBvYmplY3QgaGFzIGFscmVhZHkgYmVlbiBhc3NpZ25lZCBhbiBpZCwgcmV0dXJuIHRoYXQgaWQuXG4gICAgICAgICAgICAgICAgaWYgKG9iamVjdC5fcmVtb3RlSWQpIHtcbiAgICAgICAgICAgICAgICAgIHJldHVybiBvYmplY3QuX3JlbW90ZUlkO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIFB1dCB0aGUgb2JqZWN0IGluIHRoZSByZWdpc3RyeS5cbiAgICAgICAgICAgICAgICBvYmplY3QuX2ludGVyZmFjZSA9IG5hbWU7XG4gICAgICAgICAgICAgICAgY29uc3Qgb2JqZWN0SWQgPSB0aGlzLl9uZXh0T2JqZWN0SWQ7XG4gICAgICAgICAgICAgICAgdGhpcy5fb2JqZWN0UmVnaXN0cnkuc2V0KG9iamVjdElkLCBvYmplY3QpO1xuICAgICAgICAgICAgICAgIG9iamVjdC5fcmVtb3RlSWQgPSBvYmplY3RJZDtcbiAgICAgICAgICAgICAgICB0aGlzLl9uZXh0T2JqZWN0SWQrKztcblxuICAgICAgICAgICAgICAgIHJldHVybiBvYmplY3RJZDtcbiAgICAgICAgICAgICAgfSwgYXN5bmMgb2JqZWN0SWQgPT4gdGhpcy5fb2JqZWN0UmVnaXN0cnkuZ2V0KG9iamVjdElkKSk7XG5cbiAgICAgICAgICAgICAgLy8gUmVnaXN0ZXIgYWxsIG9mIHRoZSBzdGF0aWMgbWV0aG9kcyBhcyByZW1vdGUgZnVuY3Rpb25zLlxuICAgICAgICAgICAgICBkZWZpbml0aW9uLnN0YXRpY01ldGhvZHMuZm9yRWFjaCgoZnVuY1R5cGUsIGZ1bmNOYW1lKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5fcmVnaXN0ZXJGdW5jdGlvbihgJHtuYW1lfS8ke2Z1bmNOYW1lfWAsIGxvY2FsSW1wbFtuYW1lXVtmdW5jTmFtZV0sIGZ1bmNUeXBlKTtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgIH0gY2F0Y2goZSkge1xuICAgICAgICBsb2dnZXIuZXJyb3IoYEZhaWxlZCB0byBsb2FkIHNlcnZpY2UgJHtzZXJ2aWNlLm5hbWV9LiBTdGFjayBUcmFjZTpcXG4ke2Uuc3RhY2t9YCk7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIF9yZWdpc3RlckZ1bmN0aW9uKG5hbWU6IHN0cmluZywgbG9jYWxJbXBsOiBGdW5jdGlvbiwgdHlwZTogRnVuY3Rpb25UeXBlKTogdm9pZCB7XG4gICAgbG9nZ2VyLmRlYnVnKGBSZWdpc3RlcmluZyBmdW5jdGlvbiAke25hbWV9Li4uYCk7XG4gICAgaWYgKHRoaXMuX2Z1bmN0aW9uc0J5TmFtZS5oYXMobmFtZSkpIHtcbiAgICAgIHRocm93IG5ldyBFcnJvcihgRHVwbGljYXRlIFJQQyBmdW5jdGlvbjogJHtuYW1lfWApO1xuICAgIH1cbiAgICB0aGlzLl9mdW5jdGlvbnNCeU5hbWUuc2V0KG5hbWUsICB7XG4gICAgICBsb2NhbEltcGxlbWVudGF0aW9uOiBsb2NhbEltcGwsXG4gICAgICB0eXBlLFxuICAgIH0pO1xuICB9XG5cblxuICBhc3luYyBoYW5kbGVNZXNzYWdlKGNsaWVudDogU29ja2V0Q2xpZW50LCBtZXNzYWdlOiBSZXF1ZXN0TWVzc2FnZSk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IHJlcXVlc3RJZCA9IG1lc3NhZ2UucmVxdWVzdElkO1xuXG4gICAgbGV0IHJldHVyblZhbDogP1Byb21pc2UgPSBudWxsO1xuICAgIGxldCByZXR1cm5UeXBlOiBQcm9taXNlVHlwZSB8IE9ic2VydmFibGVUeXBlIHwgVm9pZFR5cGUgPSB7IGtpbmQ6ICd2b2lkJyB9O1xuICAgIGxldCBjYWxsRXJyb3I7XG4gICAgbGV0IGhhZEVycm9yID0gZmFsc2U7XG5cbiAgICB0cnkge1xuICAgICAgc3dpdGNoIChtZXNzYWdlLnR5cGUpIHtcbiAgICAgICAgY2FzZSAnRnVuY3Rpb25DYWxsJzpcbiAgICAgICAgICAvLyBUcmFuc2Zvcm0gYXJndW1lbnRzIGFuZCBjYWxsIGZ1bmN0aW9uLlxuICAgICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgIGxvY2FsSW1wbGVtZW50YXRpb246IGZjTG9jYWxJbXBsZW1lbnRhdGlvbixcbiAgICAgICAgICAgIHR5cGU6IGZjVHlwZSxcbiAgICAgICAgICB9ID0gdGhpcy5fZnVuY3Rpb25zQnlOYW1lLmdldChtZXNzYWdlLmZ1bmN0aW9uKTtcbiAgICAgICAgICBjb25zdCBmY1RyYW5zZm9tZWRBcmdzID0gYXdhaXQgUHJvbWlzZS5hbGwoXG4gICAgICAgICAgICBtZXNzYWdlLmFyZ3MubWFwKChhcmcsIGkpID0+IHRoaXMuX3R5cGVSZWdpc3RyeS51bm1hcnNoYWwoYXJnLCBmY1R5cGUuYXJndW1lbnRUeXBlc1tpXSkpXG4gICAgICAgICAgKTtcblxuICAgICAgICAgIC8vIEludm9rZSBmdW5jdGlvbiBhbmQgcmV0dXJuIHRoZSByZXN1bHRzLlxuICAgICAgICAgIHJldHVyblR5cGUgPSBmY1R5cGUucmV0dXJuVHlwZTtcbiAgICAgICAgICByZXR1cm5WYWwgPSBmY0xvY2FsSW1wbGVtZW50YXRpb24uYXBwbHkodGhpcywgZmNUcmFuc2ZvbWVkQXJncyk7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ01ldGhvZENhbGwnOlxuICAgICAgICAgIC8vIEdldCB0aGUgb2JqZWN0LlxuICAgICAgICAgIGNvbnN0IG1jT2JqZWN0ID0gdGhpcy5fb2JqZWN0UmVnaXN0cnkuZ2V0KG1lc3NhZ2Uub2JqZWN0SWQpO1xuXG4gICAgICAgICAgLy8gR2V0IHRoZSBtZXRob2QgRnVuY3Rpb25UeXBlIGRlc2NyaXB0aW9uLlxuICAgICAgICAgIGNvbnN0IG1jVHlwZTogRnVuY3Rpb25UeXBlID0gdGhpcy5fY2xhc3Nlc0J5TmFtZS5nZXQobWNPYmplY3QuX2ludGVyZmFjZSlcbiAgICAgICAgICAgIC5kZWZpbml0aW9uLmluc3RhbmNlTWV0aG9kcy5nZXQobWVzc2FnZS5tZXRob2QpO1xuXG4gICAgICAgICAgLy8gVW5tYXJzaGFsIGFyZ3VtZW50cy5cbiAgICAgICAgICBjb25zdCBtY1RyYW5zZm9tZWRBcmdzID0gYXdhaXQgUHJvbWlzZS5hbGwoXG4gICAgICAgICAgICBtZXNzYWdlLmFyZ3MubWFwKChhcmcsIGkpID0+IHRoaXMuX3R5cGVSZWdpc3RyeS51bm1hcnNoYWwoYXJnLCBtY1R5cGUuYXJndW1lbnRUeXBlc1tpXSkpXG4gICAgICAgICAgKTtcblxuICAgICAgICAgIC8vIEludm9rZSBtZXNzYWdlLlxuICAgICAgICAgIHJldHVyblR5cGUgPSBtY1R5cGUucmV0dXJuVHlwZTtcbiAgICAgICAgICByZXR1cm5WYWwgPSBtY09iamVjdFttZXNzYWdlLm1ldGhvZF0uYXBwbHkobWNPYmplY3QsIG1jVHJhbnNmb21lZEFyZ3MpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdOZXdPYmplY3QnOlxuICAgICAgICAgIGNvbnN0IHtcbiAgICAgICAgICAgIGxvY2FsSW1wbGVtZW50YXRpb246IG5vTG9jYWxJbXBsZW1lbnRhdGlvbixcbiAgICAgICAgICAgIGRlZmluaXRpb246IG5vRGVmaW5pdGlvbixcbiAgICAgICAgICB9ID0gdGhpcy5fY2xhc3Nlc0J5TmFtZS5nZXQobWVzc2FnZS5pbnRlcmZhY2UpO1xuXG4gICAgICAgICAgLy8gVHJhbnNmb3JtIGFyZ3VtZW50cy5cbiAgICAgICAgICBjb25zdCBub1RyYW5zZm9tZWRBcmdzID0gYXdhaXQgUHJvbWlzZS5hbGwobWVzc2FnZS5hcmdzLm1hcCgoYXJnLCBpKSA9PlxuICAgICAgICAgICAgdGhpcy5fdHlwZVJlZ2lzdHJ5LnVubWFyc2hhbChhcmcsIG5vRGVmaW5pdGlvbi5jb25zdHJ1Y3RvckFyZ3NbaV0pKSk7XG5cbiAgICAgICAgICAvLyBDcmVhdGUgYSBuZXcgb2JqZWN0IGFuZCBwdXQgaXQgaW4gdGhlIHJlZ2lzdHJ5LlxuICAgICAgICAgIGNvbnN0IG5vT2JqZWN0ID0gY29uc3RydWN0KG5vTG9jYWxJbXBsZW1lbnRhdGlvbiwgbm9UcmFuc2ZvbWVkQXJncyk7XG5cbiAgICAgICAgICAvLyBSZXR1cm4gdGhlIG9iamVjdCwgd2hpY2ggd2lsbCBhdXRvbWF0aWNhbGx5IGJlIGNvbnZlcnRlZCB0byBhbiBpZCB0aHJvdWdoIHRoZVxuICAgICAgICAgIC8vIG1hcnNoYWxsaW5nIHN5c3RlbS5cbiAgICAgICAgICByZXR1cm5UeXBlID0ge2tpbmQ6ICdwcm9taXNlJywgdHlwZTogeyBraW5kOiAnbmFtZWQnLCBuYW1lOiBtZXNzYWdlLmludGVyZmFjZSB9fTtcbiAgICAgICAgICByZXR1cm5WYWwgPSBQcm9taXNlLnJlc29sdmUobm9PYmplY3QpO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdEaXNwb3NlT2JqZWN0JzpcbiAgICAgICAgICAvLyBHZXQgdGhlIG9iamVjdC5cbiAgICAgICAgICBjb25zdCBkb09iamVjdCA9IHRoaXMuX29iamVjdFJlZ2lzdHJ5LmdldChtZXNzYWdlLm9iamVjdElkKTtcblxuICAgICAgICAgIC8vIFJlbW92ZSB0aGUgb2JqZWN0IGZyb20gdGhlIHJlZ2lzdHJ5LCBhbmQgc2NydWIgaXQncyBpZC5cbiAgICAgICAgICBkb09iamVjdC5fcmVtb3RlSWQgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgdGhpcy5fb2JqZWN0UmVnaXN0cnkuZGVsZXRlKG1lc3NhZ2Uub2JqZWN0SWQpO1xuXG4gICAgICAgICAgLy8gQ2FsbCB0aGUgb2JqZWN0J3MgbG9jYWwgZGlzcG9zZSBmdW5jdGlvbi5cbiAgICAgICAgICByZXR1cm5UeXBlID0ge2tpbmQ6ICdwcm9taXNlJywgdHlwZTogeyBraW5kOiAndm9pZCd9fTtcbiAgICAgICAgICBhd2FpdCBkb09iamVjdC5kaXNwb3NlKCk7XG5cbiAgICAgICAgICAvLyBSZXR1cm4gYSB2b2lkIFByb21pc2VcbiAgICAgICAgICByZXR1cm5WYWwgPSBQcm9taXNlLnJlc29sdmUoKTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnRGlzcG9zZU9ic2VydmFibGUnOlxuICAgICAgICAgIC8vIERpc3Bvc2UgYW4gaW4tcHJvZ3Jlc3Mgb2JzZXJ2YWJsZSwgYmVmb3JlIGl0IGhhcyBuYXR1cmFsbHkgY29tcGxldGVkLlxuICAgICAgICAgIGlmICh0aGlzLl9zdWJzY3JpcHRpb25zLmhhcyhyZXF1ZXN0SWQpKSB7XG4gICAgICAgICAgICB0aGlzLl9zdWJzY3JpcHRpb25zLmdldChyZXF1ZXN0SWQpLmRpc3Bvc2UoKTtcbiAgICAgICAgICAgIHRoaXMuX3N1YnNjcmlwdGlvbnMuZGVsZXRlKHJlcXVlc3RJZCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5rb3duIG1lc3NhZ2UgdHlwZSAke21lc3NhZ2UudHlwZX1gKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoZSAhPSBudWxsID8gZS5tZXNzYWdlIDogZSk7XG4gICAgICBjYWxsRXJyb3IgPSBlO1xuICAgICAgaGFkRXJyb3IgPSB0cnVlO1xuICAgIH1cblxuICAgIHN3aXRjaCAocmV0dXJuVHlwZS5raW5kKSB7XG4gICAgICBjYXNlICd2b2lkJzpcbiAgICAgICAgYnJlYWs7IC8vIE5vIG5lZWQgdG8gc2VuZCBhbnl0aGluZyBiYWNrIHRvIHRoZSB1c2VyLlxuICAgICAgY2FzZSAncHJvbWlzZSc6XG4gICAgICAgIC8vIElmIHRoZXJlIHdhcyBhbiBlcnJvciBleGVjdXRpbmcgdGhlIGNvbW1hbmQsIHdlIHNlbmQgdGhhdCBiYWNrIGFzIGEgcmVqZWN0ZWQgcHJvbWlzZS5cbiAgICAgICAgaWYgKGhhZEVycm9yKSB7XG4gICAgICAgICAgcmV0dXJuVmFsID0gUHJvbWlzZS5yZWplY3QoY2FsbEVycm9yKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEVuc3VyZSB0aGF0IHRoZSByZXR1cm4gdmFsdWUgaXMgYSBwcm9taXNlLlxuICAgICAgICBpZiAoIWlzVGhlbmFibGUocmV0dXJuVmFsKSkge1xuICAgICAgICAgIHJldHVyblZhbCA9IFByb21pc2UucmVqZWN0KG5ldyBFcnJvcignRXhwZWN0ZWQgYSBQcm9taXNlLCBidXQgdGhlIGZ1bmN0aW9uIHJldHVybmVkIHNvbWV0aGluZyBlbHNlLicpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIE1hcnNoYWwgdGhlIHJlc3VsdCwgdG8gc2VuZCBvdmVyIHRoZSBuZXR3b3JrLlxuICAgICAgICByZXR1cm5WYWwgPSByZXR1cm5WYWwudGhlbih2YWx1ZSA9PiB0aGlzLl90eXBlUmVnaXN0cnkubWFyc2hhbCh2YWx1ZSwgcmV0dXJuVHlwZS50eXBlKSk7XG5cbiAgICAgICAgLy8gU2VuZCB0aGUgcmVzdWx0IG9mIHRoZSBwcm9taXNlIGFjcm9zcyB0aGUgc29ja2V0LlxuICAgICAgICByZXR1cm5WYWwudGhlbihyZXN1bHQgPT4ge1xuICAgICAgICAgIGNvbnN0IHJlc3VsdE1lc3NhZ2U6IFByb21pc2VSZXNwb25zZU1lc3NhZ2UgPSB7XG4gICAgICAgICAgICBjaGFubmVsOiAnc2VydmljZV9mcmFtZXdvcmszX3JwYycsXG4gICAgICAgICAgICB0eXBlOiAnUHJvbWlzZU1lc3NhZ2UnLFxuICAgICAgICAgICAgcmVxdWVzdElkLFxuICAgICAgICAgICAgcmVzdWx0LFxuICAgICAgICAgICAgaGFkRXJyb3I6IGZhbHNlLFxuICAgICAgICAgIH07XG4gICAgICAgICAgdGhpcy5fc2VydmVyLl9zZW5kU29ja2V0TWVzc2FnZShjbGllbnQsIHJlc3VsdE1lc3NhZ2UpO1xuICAgICAgICB9LCBlcnJvciA9PiB7XG4gICAgICAgICAgY29uc3QgZXJyb3JNZXNzYWdlOiBFcnJvclJlc3BvbnNlTWVzc2FnZSA9IHtcbiAgICAgICAgICAgIGNoYW5uZWw6ICdzZXJ2aWNlX2ZyYW1ld29yazNfcnBjJyxcbiAgICAgICAgICAgIHR5cGU6ICdFcnJvck1lc3NhZ2UnLFxuICAgICAgICAgICAgcmVxdWVzdElkLFxuICAgICAgICAgICAgaGFkRXJyb3I6IHRydWUsXG4gICAgICAgICAgICBlcnJvcjogZm9ybWF0RXJyb3IoZXJyb3IpLFxuICAgICAgICAgIH07XG4gICAgICAgICAgdGhpcy5fc2VydmVyLl9zZW5kU29ja2V0TWVzc2FnZShjbGllbnQsIGVycm9yTWVzc2FnZSk7XG4gICAgICAgIH0pO1xuICAgICAgICBicmVhaztcbiAgICAgIGNhc2UgJ29ic2VydmFibGUnOlxuICAgICAgICAvLyBJZiB0aGVyZSB3YXMgYW4gZXJyb3IgZXhlY3V0aW5nIHRoZSBjb21tYW5kLCB3ZSBzZW5kIHRoYXQgYmFjayBhcyBhbiBlcnJvciBPYnNlcnZhYmxlLlxuICAgICAgICBpZiAoaGFkRXJyb3IpIHtcbiAgICAgICAgICByZXR1cm5WYWwgPSBPYnNlcnZhYmxlLnRocm93KGNhbGxFcnJvcik7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBFbnN1cmUgdGhhdCB0aGUgcmV0dXJuIHZhbHVlIGlzIGFuIG9ic2VydmFibGUuXG4gICAgICAgIGlmICghaXNPYnNlcnZhYmxlKHJldHVyblZhbCkpIHtcbiAgICAgICAgICByZXR1cm5WYWwgPSBPYnNlcnZhYmxlLnRocm93KG5ldyBFcnJvcihcbiAgICAgICAgICAgICdFeHBlY3RlZCBhbiBPYnNlcnZhYmxlLCBidXQgdGhlIGZ1bmN0aW9uIHJldHVybmVkIHNvbWV0aGluZyBlbHNlLicpKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIE1hcnNoYWwgdGhlIHJlc3VsdCwgdG8gc2VuZCBvdmVyIHRoZSBuZXR3b3JrLlxuICAgICAgICByZXR1cm5WYWwgPSByZXR1cm5WYWwuY29uY2F0TWFwKHZhbHVlID0+IHRoaXMuX3R5cGVSZWdpc3RyeS5tYXJzaGFsKHZhbHVlLCByZXR1cm5UeXBlLnR5cGUpKTtcblxuICAgICAgICAvLyBTZW5kIHRoZSBuZXh0LCBlcnJvciwgYW5kIGNvbXBsZXRpb24gZXZlbnRzIG9mIHRoZSBvYnNlcnZhYmxlIGFjcm9zcyB0aGUgc29ja2V0LlxuICAgICAgICBjb25zdCBzdWJzY3JpcHRpb24gPSByZXR1cm5WYWwuc3Vic2NyaWJlKGRhdGEgPT4ge1xuICAgICAgICAgIGNvbnN0IGV2ZW50TWVzc2FnZTogT2JzZXJ2YWJsZVJlc3BvbnNlTWVzc2FnZSA9IHtcbiAgICAgICAgICAgIGNoYW5uZWw6ICdzZXJ2aWNlX2ZyYW1ld29yazNfcnBjJyxcbiAgICAgICAgICAgIHR5cGU6ICdPYnNlcnZhYmxlTWVzc2FnZScsXG4gICAgICAgICAgICByZXF1ZXN0SWQsXG4gICAgICAgICAgICBoYWRFcnJvcjogZmFsc2UsXG4gICAgICAgICAgICByZXN1bHQ6IHtcbiAgICAgICAgICAgICAgdHlwZTogJ25leHQnLFxuICAgICAgICAgICAgICBkYXRhOiBkYXRhLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICB9O1xuICAgICAgICAgIHRoaXMuX3NlcnZlci5fc2VuZFNvY2tldE1lc3NhZ2UoY2xpZW50LCBldmVudE1lc3NhZ2UpO1xuICAgICAgICB9LCBlcnJvciA9PiB7XG4gICAgICAgICAgY29uc3QgZXJyb3JNZXNzYWdlOiBFcnJvclJlc3BvbnNlTWVzc2FnZSA9IHtcbiAgICAgICAgICAgIGNoYW5uZWw6ICdzZXJ2aWNlX2ZyYW1ld29yazNfcnBjJyxcbiAgICAgICAgICAgIHR5cGU6ICdFcnJvck1lc3NhZ2UnLFxuICAgICAgICAgICAgcmVxdWVzdElkLFxuICAgICAgICAgICAgaGFkRXJyb3I6IHRydWUsXG4gICAgICAgICAgICBlcnJvcjogZm9ybWF0RXJyb3IoZXJyb3IpLFxuICAgICAgICAgIH07XG4gICAgICAgICAgdGhpcy5fc2VydmVyLl9zZW5kU29ja2V0TWVzc2FnZShjbGllbnQsIGVycm9yTWVzc2FnZSk7XG4gICAgICAgICAgdGhpcy5fc3Vic2NyaXB0aW9ucy5kZWxldGUocmVxdWVzdElkKTtcbiAgICAgICAgfSwgY29tcGxldGVkID0+IHtcbiAgICAgICAgICBjb25zdCBldmVudE1lc3NhZ2U6IE9ic2VydmFibGVSZXNwb25zZU1lc3NhZ2UgPSB7XG4gICAgICAgICAgICBjaGFubmVsOiAnc2VydmljZV9mcmFtZXdvcmszX3JwYycsXG4gICAgICAgICAgICB0eXBlOiAnT2JzZXJ2YWJsZU1lc3NhZ2UnLFxuICAgICAgICAgICAgcmVxdWVzdElkLFxuICAgICAgICAgICAgaGFkRXJyb3I6IGZhbHNlLFxuICAgICAgICAgICAgcmVzdWx0OiB7IHR5cGU6ICdjb21wbGV0ZWQnIH0sXG4gICAgICAgICAgfTtcbiAgICAgICAgICB0aGlzLl9zZXJ2ZXIuX3NlbmRTb2NrZXRNZXNzYWdlKGNsaWVudCwgZXZlbnRNZXNzYWdlKTtcbiAgICAgICAgICB0aGlzLl9zdWJzY3JpcHRpb25zLmRlbGV0ZShyZXF1ZXN0SWQpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5fc3Vic2NyaXB0aW9ucy5zZXQocmVxdWVzdElkLCBzdWJzY3JpcHRpb24pO1xuICAgICAgICBicmVhaztcbiAgICAgIGRlZmF1bHQ6XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgVW5rb3duIHJldHVybiB0eXBlICR7cmV0dXJuVHlwZS5raW5kfS5gKTtcbiAgICB9XG4gIH1cbn1cblxuLyoqXG4gKiBBIGhlbHBlciBmdW5jdGlvbiB0aGF0IGxldCdzIHVzICdhcHBseScgYW4gYXJyYXkgb2YgYXJndW1lbnRzIHRvIGEgY29uc3RydWN0b3IuXG4gKiBJdCB3b3JrcyBieSBjcmVhdGluZyBhIG5ldyBjb25zdHJ1Y3RvciB0aGF0IGhhcyB0aGUgc2FtZSBwcm90b3R5cGUgYXMgdGhlIG9yaWdpbmFsXG4gKiBjb25zdHJ1Y3RvciwgYW5kIHNpbXBseSBhcHBsaWVzIHRoZSBvcmlnaW5hbCBjb25zdHJ1Y3RvciBkaXJlY3RseSB0byAndGhpcycuXG4gKiBAcmV0dXJucyBBbiBpbnN0YW5jZSBvZiBjbGFzc09iamVjdC5cbiAqL1xuZnVuY3Rpb24gY29uc3RydWN0KGNsYXNzT2JqZWN0LCBhcmdzKSB7XG4gIGZ1bmN0aW9uIEYoKSB7XG4gICAgcmV0dXJuIGNsYXNzT2JqZWN0LmFwcGx5KHRoaXMsIGFyZ3MpO1xuICB9XG4gIEYucHJvdG90eXBlID0gY2xhc3NPYmplY3QucHJvdG90eXBlO1xuICByZXR1cm4gbmV3IEYoKTtcbn1cblxuLyoqXG4gKiBBIGhlbHBlciBmdW5jdGlvbiB0aGF0IGNoZWNrcyBpZiBhbiBvYmplY3QgaXMgdGhlbmFibGUgKFByb21pc2UtbGlrZSkuXG4gKi9cbmZ1bmN0aW9uIGlzVGhlbmFibGUob2JqZWN0OiBhbnkpOiBib29sZWFuIHtcbiAgcmV0dXJuIEJvb2xlYW4ob2JqZWN0ICYmIG9iamVjdC50aGVuKTtcbn1cblxuLyoqXG4gKiBBIGhlbHBlciBmdW5jdGlvbiB0aGF0IGNoZWNrcyBpZiBhbiBvYmplY3QgaXMgYW4gT2JzZXJ2YWJsZS5cbiAqL1xuZnVuY3Rpb24gaXNPYnNlcnZhYmxlKG9iamVjdDogYW55KTogYm9vbGVhbiB7XG4gIHJldHVybiBCb29sZWFuKG9iamVjdCAmJiBvYmplY3QuY29uY2F0TWFwICYmIG9iamVjdC5zdWJzY3JpYmUpO1xufVxuXG4vKipcbiAqIEZvcm1hdCB0aGUgZXJyb3IgYmVmb3JlIHNlbmRpbmcgb3ZlciB0aGUgd2ViIHNvY2tldC5cbiAqIFRPRE86IFRoaXMgc2hvdWxkIGJlIGEgY3VzdG9tIG1hcnNoYWxsZXIgcmVnaXN0ZXJlZCBpbiB0aGUgVHlwZVJlZ2lzdHJ5XG4gKi9cbmZ1bmN0aW9uIGZvcm1hdEVycm9yKGVycm9yKTogPyhPYmplY3QgfCBzdHJpbmcpIHtcbiAgaWYgKGVycm9yIGluc3RhbmNlb2YgRXJyb3IpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbWVzc2FnZTogZXJyb3IubWVzc2FnZSxcbiAgICAgIGNvZGU6IGVycm9yLmNvZGUsXG4gICAgICBzdGFjazogZXJyb3Iuc3RhY2ssXG4gICAgfTtcbiAgfSBlbHNlIGlmICh0eXBlb2YgZXJyb3IgPT09ICdzdHJpbmcnKSB7XG4gICAgcmV0dXJuIGVycm9yLnRvU3RyaW5nKCk7XG4gIH0gZWxzZSBpZiAoZXJyb3IgPT09IHVuZGVmaW5lZCkge1xuICAgIHJldHVybiB1bmRlZmluZWQ7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGBVbmtub3duIEVycm9yOiAke2Vycm9yLnRvU3RyaW5nKCl9YDtcbiAgfVxufVxuIl19\n","/home/travis/build/npmtest/node-npmtest-nuclide-server/node_modules/nuclide-server/lib/serviceframework/config.js":"Object.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports.loadServicesConfig = loadServicesConfig;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\n/*\n * Copyright (c) 2015-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the license found in the LICENSE file in\n * the root directory of this source tree.\n */\n\nvar _path = require('path');\n\nvar _path2 = _interopRequireDefault(_path);\n\n'use babel';\n\nvar PACKAGE_ROOT = _path2['default'].resolve(__dirname, '..', '..');\n\n/**\n * Load service configs, and resolve all of the paths to absolute paths.\n */\n\nfunction loadServicesConfig() {\n  // $FlowIssue - This path is not recognized.\n  var publicServices = createServiceConfigObject(require('../../services-3.json'));\n  var privateServices = [];\n  try {\n    // $FlowIssue - This path is not recognized.\n    privateServices = createServiceConfigObject(require('../../fb/fb-services-3.json'));\n  } catch (e) {\n    // This file may not exist.\n  }\n  return publicServices.concat(privateServices);\n}\n\n/**\n * Takes the contents of a service config JSON file, and formats each entry into\n * a ConfigEntry.\n */\nfunction createServiceConfigObject(jsonConfig) {\n  return jsonConfig.map(function (config) {\n    // TODO(peterhal): Remove this once all services have had their def files removed.\n    if (config.definition == null) {\n      config.definition = config.implementation;\n    }\n    return {\n      name: config.name,\n      definition: resolveServicePath(config.definition),\n      implementation: resolveServicePath(config.implementation)\n    };\n  });\n}\n\n/**\n * Resolve service path defined in services-3.json to absolute path. The service path could\n * be in one of following forms:\n *   1. A path relative to the folder that contains `service-config.json`.\n *   2. An absolute path.\n *   3. A path in form of `$dependency_package/path/to/service`. For example,\n *      'nuclide-commons/lib/array.js'.\n */\nfunction resolveServicePath(servicePath) {\n  try {\n    return require.resolve(servicePath);\n  } catch (e) {\n    return _path2['default'].resolve(PACKAGE_ROOT, servicePath);\n  }\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi92YXIvZm9sZGVycy94Zi9yc3BoNF9jNTczMTVyczU3eHhzZHNrcnhudjM2dDAvVC90bXBwZmw1Mm5wdWJsaXNoX3BhY2thZ2VzL25wbS9udWNsaWRlLXNlcnZlci9saWIvc2VydmljZWZyYW1ld29yay9jb25maWcuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7O29CQVdpQixNQUFNOzs7O0FBWHZCLFdBQVcsQ0FBQzs7QUFhWixJQUFNLFlBQVksR0FBRyxrQkFBSyxPQUFPLENBQUMsU0FBUyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQzs7Ozs7O0FBV2xELFNBQVMsa0JBQWtCLEdBQXVCOztBQUV2RCxNQUFNLGNBQWMsR0FBRyx5QkFBeUIsQ0FBQyxPQUFPLENBQUMsdUJBQXVCLENBQUMsQ0FBQyxDQUFDO0FBQ25GLE1BQUksZUFBZSxHQUFHLEVBQUUsQ0FBQztBQUN6QixNQUFJOztBQUVGLG1CQUFlLEdBQUcseUJBQXlCLENBQUMsT0FBTyxDQUFDLDZCQUE2QixDQUFDLENBQUMsQ0FBQztHQUNyRixDQUFDLE9BQU8sQ0FBQyxFQUFFOztHQUVYO0FBQ0QsU0FBTyxjQUFjLENBQUMsTUFBTSxDQUFDLGVBQWUsQ0FBQyxDQUFDO0NBQy9DOzs7Ozs7QUFNRCxTQUFTLHlCQUF5QixDQUFDLFVBQXlCLEVBQXNCO0FBQ2hGLFNBQU8sVUFBVSxDQUFDLEdBQUcsQ0FBQyxVQUFBLE1BQU0sRUFBSTs7QUFFOUIsUUFBSSxNQUFNLENBQUMsVUFBVSxJQUFJLElBQUksRUFBRTtBQUM3QixZQUFNLENBQUMsVUFBVSxHQUFHLE1BQU0sQ0FBQyxjQUFjLENBQUM7S0FDM0M7QUFDRCxXQUFPO0FBQ0wsVUFBSSxFQUFFLE1BQU0sQ0FBQyxJQUFJO0FBQ2pCLGdCQUFVLEVBQUUsa0JBQWtCLENBQUMsTUFBTSxDQUFDLFVBQVUsQ0FBQztBQUNqRCxvQkFBYyxFQUFFLGtCQUFrQixDQUFDLE1BQU0sQ0FBQyxjQUFjLENBQUM7S0FDMUQsQ0FBQztHQUNILENBQUMsQ0FBQztDQUNKOzs7Ozs7Ozs7O0FBVUQsU0FBUyxrQkFBa0IsQ0FBQyxXQUFtQixFQUFVO0FBQ3ZELE1BQUk7QUFDRixXQUFPLE9BQU8sQ0FBQyxPQUFPLENBQUMsV0FBVyxDQUFDLENBQUM7R0FDckMsQ0FBQyxPQUFPLENBQUMsRUFBRTtBQUNWLFdBQU8sa0JBQUssT0FBTyxDQUFDLFlBQVksRUFBRSxXQUFXLENBQUMsQ0FBQztHQUNoRDtDQUNGIiwiZmlsZSI6Ii92YXIvZm9sZGVycy94Zi9yc3BoNF9jNTczMTVyczU3eHhzZHNrcnhudjM2dDAvVC90bXBwZmw1Mm5wdWJsaXNoX3BhY2thZ2VzL25wbS9udWNsaWRlLXNlcnZlci9saWIvc2VydmljZWZyYW1ld29yay9jb25maWcuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIGJhYmVsJztcbi8qIEBmbG93ICovXG5cbi8qXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTUtcHJlc2VudCwgRmFjZWJvb2ssIEluYy5cbiAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgbGljZW5zZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlIGluXG4gKiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqL1xuXG5pbXBvcnQgcGF0aCBmcm9tICdwYXRoJztcblxuY29uc3QgUEFDS0FHRV9ST09UID0gcGF0aC5yZXNvbHZlKF9fZGlybmFtZSwgJy4uJywgJy4uJyk7XG5cbnR5cGUgQ29uZmlnRW50cnkgPSB7XG4gIG5hbWU6IHN0cmluZztcbiAgZGVmaW5pdGlvbjpzdHJpbmc7XG4gIGltcGxlbWVudGF0aW9uOiBzdHJpbmc7XG59O1xuXG4vKipcbiAqIExvYWQgc2VydmljZSBjb25maWdzLCBhbmQgcmVzb2x2ZSBhbGwgb2YgdGhlIHBhdGhzIHRvIGFic29sdXRlIHBhdGhzLlxuICovXG5leHBvcnQgZnVuY3Rpb24gbG9hZFNlcnZpY2VzQ29uZmlnKCk6IEFycmF5PENvbmZpZ0VudHJ5PiB7XG4gIC8vICRGbG93SXNzdWUgLSBUaGlzIHBhdGggaXMgbm90IHJlY29nbml6ZWQuXG4gIGNvbnN0IHB1YmxpY1NlcnZpY2VzID0gY3JlYXRlU2VydmljZUNvbmZpZ09iamVjdChyZXF1aXJlKCcuLi8uLi9zZXJ2aWNlcy0zLmpzb24nKSk7XG4gIGxldCBwcml2YXRlU2VydmljZXMgPSBbXTtcbiAgdHJ5IHtcbiAgICAvLyAkRmxvd0lzc3VlIC0gVGhpcyBwYXRoIGlzIG5vdCByZWNvZ25pemVkLlxuICAgIHByaXZhdGVTZXJ2aWNlcyA9IGNyZWF0ZVNlcnZpY2VDb25maWdPYmplY3QocmVxdWlyZSgnLi4vLi4vZmIvZmItc2VydmljZXMtMy5qc29uJykpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgLy8gVGhpcyBmaWxlIG1heSBub3QgZXhpc3QuXG4gIH1cbiAgcmV0dXJuIHB1YmxpY1NlcnZpY2VzLmNvbmNhdChwcml2YXRlU2VydmljZXMpO1xufVxuXG4vKipcbiAqIFRha2VzIHRoZSBjb250ZW50cyBvZiBhIHNlcnZpY2UgY29uZmlnIEpTT04gZmlsZSwgYW5kIGZvcm1hdHMgZWFjaCBlbnRyeSBpbnRvXG4gKiBhIENvbmZpZ0VudHJ5LlxuICovXG5mdW5jdGlvbiBjcmVhdGVTZXJ2aWNlQ29uZmlnT2JqZWN0KGpzb25Db25maWc6IEFycmF5PE9iamVjdD4pOiBBcnJheTxDb25maWdFbnRyeT4ge1xuICByZXR1cm4ganNvbkNvbmZpZy5tYXAoY29uZmlnID0+IHtcbiAgICAvLyBUT0RPKHBldGVyaGFsKTogUmVtb3ZlIHRoaXMgb25jZSBhbGwgc2VydmljZXMgaGF2ZSBoYWQgdGhlaXIgZGVmIGZpbGVzIHJlbW92ZWQuXG4gICAgaWYgKGNvbmZpZy5kZWZpbml0aW9uID09IG51bGwpIHtcbiAgICAgIGNvbmZpZy5kZWZpbml0aW9uID0gY29uZmlnLmltcGxlbWVudGF0aW9uO1xuICAgIH1cbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogY29uZmlnLm5hbWUsXG4gICAgICBkZWZpbml0aW9uOiByZXNvbHZlU2VydmljZVBhdGgoY29uZmlnLmRlZmluaXRpb24pLFxuICAgICAgaW1wbGVtZW50YXRpb246IHJlc29sdmVTZXJ2aWNlUGF0aChjb25maWcuaW1wbGVtZW50YXRpb24pLFxuICAgIH07XG4gIH0pO1xufVxuXG4vKipcbiAqIFJlc29sdmUgc2VydmljZSBwYXRoIGRlZmluZWQgaW4gc2VydmljZXMtMy5qc29uIHRvIGFic29sdXRlIHBhdGguIFRoZSBzZXJ2aWNlIHBhdGggY291bGRcbiAqIGJlIGluIG9uZSBvZiBmb2xsb3dpbmcgZm9ybXM6XG4gKiAgIDEuIEEgcGF0aCByZWxhdGl2ZSB0byB0aGUgZm9sZGVyIHRoYXQgY29udGFpbnMgYHNlcnZpY2UtY29uZmlnLmpzb25gLlxuICogICAyLiBBbiBhYnNvbHV0ZSBwYXRoLlxuICogICAzLiBBIHBhdGggaW4gZm9ybSBvZiBgJGRlcGVuZGVuY3lfcGFja2FnZS9wYXRoL3RvL3NlcnZpY2VgLiBGb3IgZXhhbXBsZSxcbiAqICAgICAgJ251Y2xpZGUtY29tbW9ucy9saWIvYXJyYXkuanMnLlxuICovXG5mdW5jdGlvbiByZXNvbHZlU2VydmljZVBhdGgoc2VydmljZVBhdGg6IHN0cmluZyk6IHN0cmluZyB7XG4gIHRyeSB7XG4gICAgcmV0dXJuIHJlcXVpcmUucmVzb2x2ZShzZXJ2aWNlUGF0aCk7XG4gIH0gY2F0Y2ggKGUpIHtcbiAgICByZXR1cm4gcGF0aC5yZXNvbHZlKFBBQ0tBR0VfUk9PVCwgc2VydmljZVBhdGgpO1xuICB9XG59XG4iXX0=\n","/home/travis/build/npmtest/node-npmtest-nuclide-server/node_modules/nuclide-server/lib/serviceframework/ClientComponent.js":"Object.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj['default'] = obj; return newObj; } }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { var callNext = step.bind(null, 'next'); var callThrow = step.bind(null, 'throw'); function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(callNext, callThrow); } } callNext(); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\n/*\n * Copyright (c) 2015-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the license found in the LICENSE file in\n * the root directory of this source tree.\n */\n\nvar _libServiceframeworkConfig = require('../../lib/serviceframework/config');\n\nvar config = _interopRequireWildcard(_libServiceframeworkConfig);\n\nvar _assert = require('assert');\n\nvar _assert2 = _interopRequireDefault(_assert);\n\nvar _events = require('events');\n\nvar _NuclideSocket = require('../NuclideSocket');\n\nvar _NuclideSocket2 = _interopRequireDefault(_NuclideSocket);\n\nvar _rx = require('rx');\n\nvar _config = require('../config');\n\nvar _nuclideServiceParserLibTypeRegistry = require('nuclide-service-parser/lib/TypeRegistry');\n\nvar _nuclideServiceParserLibTypeRegistry2 = _interopRequireDefault(_nuclideServiceParserLibTypeRegistry);\n\nvar _nuclideServiceParser = require('nuclide-service-parser');\n\n'use babel';\n\nvar logger = require('nuclide-logging').getLogger();\n\nvar ClientComponent = (function () {\n  function ClientComponent(emitter, socket, requestIdGenerator) {\n    var _this = this;\n\n    _classCallCheck(this, ClientComponent);\n\n    this._emitter = emitter;\n    this._socket = socket;\n    this._requestIdGenerator = requestIdGenerator;\n\n    this._typeRegistry = new _nuclideServiceParserLibTypeRegistry2['default']();\n    this._objectRegistry = new Map();\n\n    // Setup services.\n    var services = config.loadServicesConfig();\n    for (var service of services) {\n      logger.debug('Registering 3.0 service ' + service.name + '...');\n      try {\n        (function () {\n          var defs = (0, _nuclideServiceParser.getDefinitions)(service.definition);\n          var proxy = (0, _nuclideServiceParser.getProxy)(service.name, service.definition, _this);\n\n          defs.forEach(function (definition) {\n            var name = definition.name;\n            switch (definition.kind) {\n              case 'alias':\n                logger.debug('Registering type alias ' + name + '...');\n                if (definition.definition != null) {\n                  _this._typeRegistry.registerAlias(name, definition.definition);\n                }\n                break;\n              case 'interface':\n                logger.debug('Registering interface ' + name + '.');\n                _this._typeRegistry.registerType(name, _asyncToGenerator(function* (object) {\n                  return yield object._idPromise;\n                }), _asyncToGenerator(function* (objectId) {\n                  // Return a cached proxy, if one already exists, for this object.\n                  if (_this._objectRegistry.has(objectId)) {\n                    return _this._objectRegistry.get(objectId);\n                  }\n\n                  // Generate the proxy by manually setting the prototype of the object to be the\n                  // prototype of the remote proxy constructor.\n                  var object = { _idPromise: Promise.resolve(objectId) };\n                  Object.setPrototypeOf(object, proxy[name].prototype);\n                  _this._objectRegistry.set(objectId, object);\n                  return object;\n                }));\n                break;\n            }\n          });\n        })();\n      } catch (e) {\n        logger.error('Failed to load service ' + service.name + '. Stack Trace:\\n' + e.stack);\n        continue;\n      }\n    }\n  }\n\n  // TODO: This should be a custom marshaller registered in the TypeRegistry\n\n  // Delegate marshalling to the type registry.\n\n  _createClass(ClientComponent, [{\n    key: 'marshal',\n    value: function marshal() {\n      var _typeRegistry;\n\n      return (_typeRegistry = this._typeRegistry).marshal.apply(_typeRegistry, arguments);\n    }\n  }, {\n    key: 'unmarshal',\n    value: function unmarshal() {\n      var _typeRegistry2;\n\n      return (_typeRegistry2 = this._typeRegistry).unmarshal.apply(_typeRegistry2, arguments);\n    }\n  }, {\n    key: 'registerType',\n    value: function registerType() {\n      var _typeRegistry3;\n\n      return (_typeRegistry3 = this._typeRegistry).registerType.apply(_typeRegistry3, arguments);\n    }\n\n    /**\n     * Call a remote function, through the service framework.\n     * @param functionName - The name of the remote function to invoke.\n     * @param returnType - The type of object that this function returns, so the the transport layer can\n     *   register the appropriate listeners.\n     * @param args - The serialized arguments to invoke the remote function with.\n     */\n  }, {\n    key: 'callRemoteFunction',\n    value: function callRemoteFunction(functionName, returnType, args) {\n      var message = {\n        protocol: 'service_framework3_rpc',\n        type: 'FunctionCall',\n        'function': functionName,\n        requestId: this._requestIdGenerator(),\n        args: args\n      };\n      return this._sendMessageAndListenForResult(message, returnType, 'Calling function ' + functionName);\n    }\n\n    /**\n     * Call a method of a remote object, through the service framework.\n     * @param objectId - The id of the remote object.\n     * @param methodName - The name of the method to invoke.\n     * @param returnType - The type of object that this function returns, so the the transport layer can\n     *   register the appropriate listeners.\n     * @param args - The serialized arguments to invoke the remote method with.\n     */\n  }, {\n    key: 'callRemoteMethod',\n    value: function callRemoteMethod(objectId, methodName, returnType, args) {\n      var message = {\n        protocol: 'service_framework3_rpc',\n        type: 'MethodCall',\n        method: methodName,\n        objectId: objectId,\n        requestId: this._requestIdGenerator(),\n        args: args\n      };\n      return this._sendMessageAndListenForResult(message, returnType, 'Calling remote method ' + methodName + '.');\n    }\n\n    /**\n     * Call a remote constructor, returning an id that eventually resolves to a unique identifier\n     * for the object.\n     * @param interfaceName - The name of the remote class for which to construct an object.\n     * @param args - Serialized arguments to pass to the remote constructor.\n     */\n  }, {\n    key: 'createRemoteObject',\n    value: function createRemoteObject(interfaceName, args) {\n      var message = {\n        protocol: 'service_framework3_rpc',\n        type: 'NewObject',\n        'interface': interfaceName,\n        requestId: this._requestIdGenerator(),\n        args: args\n      };\n      return this._sendMessageAndListenForResult(message, 'promise', 'Creating instance of ' + interfaceName);\n    }\n\n    /**\n     * Dispose a remote object. This makes it's proxies unsuable, and calls the `dispose` method on\n     * the remote object.\n     * @param objectId - The numerical id that identifies the remote object.\n     * @returns A Promise that resolves when the object disposal has completed.\n     */\n  }, {\n    key: 'disposeRemoteObject',\n    value: function disposeRemoteObject(objectId) {\n      var message = {\n        protocol: 'service_framework3_rpc',\n        type: 'DisposeObject',\n        requestId: this._requestIdGenerator(),\n        objectId: objectId\n      };\n      return this._sendMessageAndListenForResult(message, 'promise', 'Disposing object ' + objectId);\n    }\n\n    /**\n     * Helper function that listens for a result for the given requestId.\n     * @param returnType - Determines the type of messages we should subscribe to, and what this\n     *   function should return.\n     * @param requestId - The id of the request who's result we are listening for.\n     * @returns Depending on the expected return type, this function either returns undefined, a Promise,\n     *   or an Observable.\n     */\n  }, {\n    key: '_sendMessageAndListenForResult',\n    value: function _sendMessageAndListenForResult(message, returnType, timeoutMessage) {\n      var _this2 = this;\n\n      switch (returnType) {\n        case 'void':\n          this._socket.send(message);\n          return; // No values to return.\n        case 'promise':\n          // Listen for a single message, and resolve or reject a promise on that message.\n          return new Promise(function (resolve, reject) {\n            _this2._socket.send(message);\n            _this2._emitter.once(message.requestId.toString(), function (hadError, error, result) {\n              hadError ? reject(decodeError(error)) : resolve(result);\n            });\n\n            setTimeout(function () {\n              _this2._emitter.removeAllListeners(message.requestId.toString());\n              reject('Timeout after ' + _config.SERVICE_FRAMEWORK_RPC_TIMEOUT_MS + ' for requestId: ' + message.requestId + ', ' + timeoutMessage + '.');\n            }, _config.SERVICE_FRAMEWORK_RPC_TIMEOUT_MS);\n          });\n        case 'observable':\n          var observable = _rx.Observable.create(function (observer) {\n            _this2._socket.send(message);\n\n            // Listen for 'next', 'error', and 'completed' events.\n            _this2._emitter.on(message.requestId.toString(), function (hadError, error, result) {\n              if (hadError) {\n                observer.onError(decodeError(error));\n              } else {\n                (0, _assert2['default'])(result);\n                if (result.type === 'completed') {\n                  observer.onCompleted();\n                } else if (result.type === 'next') {\n                  observer.onNext(result.data);\n                }\n              }\n            });\n\n            // Observable dispose function, which is called on subscription dipsose, on stream\n            // completion, and on stream error.\n            return function () {\n              _this2._emitter.removeAllListeners(message.requestId.toString());\n\n              // Send a message to server to call the dispose function of\n              // the remote Observable subscription.\n              var disposeMessage = {\n                protocol: 'service_framework3_rpc',\n                type: 'DisposeObservable',\n                requestId: message.requestId\n              };\n              _this2._socket.send(disposeMessage);\n            };\n          });\n\n          return observable;\n        default:\n          throw new Error('Unkown return type: ' + returnType + '.');\n      }\n    }\n  }]);\n\n  return ClientComponent;\n})();\n\nexports['default'] = ClientComponent;\nfunction decodeError(encodedError) {\n  if (encodedError != null && typeof encodedError === 'object') {\n    var resultError = new Error();\n    resultError.message = encodedError.message;\n    // $FlowIssue - some Errors (notably file operations) have a code.\n    resultError.code = encodedError.code;\n    resultError.stack = encodedError.stack;\n    return resultError;\n  } else {\n    return encodedError;\n  }\n}\nmodule.exports = exports['default'];\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi92YXIvZm9sZGVycy94Zi9yc3BoNF9jNTczMTVyczU3eHhzZHNrcnhudjM2dDAvVC90bXBwZmw1Mm5wdWJsaXNoX3BhY2thZ2VzL25wbS9udWNsaWRlLXNlcnZlci9saWIvc2VydmljZWZyYW1ld29yay9DbGllbnRDb21wb25lbnQuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozt5Q0FXd0IsbUNBQW1DOztJQUEvQyxNQUFNOztzQkFFSSxRQUFROzs7O3NCQUNILFFBQVE7OzZCQUNULGtCQUFrQjs7OztrQkFDbkIsSUFBSTs7c0JBQ2tCLFdBQVc7O21EQUVqQyx5Q0FBeUM7Ozs7b0NBQzNCLHdCQUF3Qjs7QUFwQi9ELFdBQVcsQ0FBQzs7QUEwQlosSUFBTSxNQUFNLEdBQUcsT0FBTyxDQUFDLGlCQUFpQixDQUFDLENBQUMsU0FBUyxFQUFFLENBQUM7O0lBRWpDLGVBQWU7QUFRdkIsV0FSUSxlQUFlLENBUXRCLE9BQXFCLEVBQUUsTUFBcUIsRUFBRSxrQkFBZ0MsRUFBRTs7OzBCQVJ6RSxlQUFlOztBQVNoQyxRQUFJLENBQUMsUUFBUSxHQUFHLE9BQU8sQ0FBQztBQUN4QixRQUFJLENBQUMsT0FBTyxHQUFHLE1BQU0sQ0FBQztBQUN0QixRQUFJLENBQUMsbUJBQW1CLEdBQUcsa0JBQWtCLENBQUM7O0FBRTlDLFFBQUksQ0FBQyxhQUFhLEdBQUcsc0RBQWtCLENBQUM7QUFDeEMsUUFBSSxDQUFDLGVBQWUsR0FBRyxJQUFJLEdBQUcsRUFBRSxDQUFDOzs7QUFHakMsUUFBTSxRQUFRLEdBQUcsTUFBTSxDQUFDLGtCQUFrQixFQUFFLENBQUM7QUFDN0MsU0FBSyxJQUFNLE9BQU8sSUFBSSxRQUFRLEVBQUU7QUFDOUIsWUFBTSxDQUFDLEtBQUssOEJBQTRCLE9BQU8sQ0FBQyxJQUFJLFNBQU0sQ0FBQztBQUMzRCxVQUFJOztBQUNGLGNBQU0sSUFBSSxHQUFHLDBCQTdCSCxjQUFjLEVBNkJJLE9BQU8sQ0FBQyxVQUFVLENB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L3RtcHBmbDUybnB1Ymxpc2hfcGFja2FnZXMvbnBtL251Y2xpZGUtc2VydmVyL2xpYi9zZXJ2aWNlZnJhbWV3b3JrL0NsaWVudENvbXBvbmVudC5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2UgYmFiZWwnO1xuLyogQGZsb3cgKi9cblxuLypcbiAqIENvcHlyaWdodCAoYykgMjAxNS1wcmVzZW50LCBGYWNlYm9vaywgSW5jLlxuICogQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBsaWNlbnNlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUgaW5cbiAqIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICovXG5cbmltcG9ydCAqIGFzIGNvbmZpZyBmcm9tICcuLi8uLi9saWIvc2VydmljZWZyYW1ld29yay9jb25maWcnO1xuXG5pbXBvcnQgaW52YXJpYW50IGZyb20gJ2Fzc2VydCc7XG5pbXBvcnQge0V2ZW50RW1pdHRlcn0gZnJvbSAnZXZlbnRzJztcbmltcG9ydCBOdWNsaWRlU29ja2V0IGZyb20gJy4uL051Y2xpZGVTb2NrZXQnO1xuaW1wb3J0IHtPYnNlcnZhYmxlfSBmcm9tICdyeCc7XG5pbXBvcnQge1NFUlZJQ0VfRlJBTUVXT1JLX1JQQ19USU1FT1VUX01TfSBmcm9tICcuLi9jb25maWcnO1xuXG5pbXBvcnQgVHlwZVJlZ2lzdHJ5IGZyb20gJ251Y2xpZGUtc2VydmljZS1wYXJzZXIvbGliL1R5cGVSZWdpc3RyeSc7XG5pbXBvcnQge2dldFByb3h5LCBnZXREZWZpbml0aW9uc30gZnJvbSAnbnVjbGlkZS1zZXJ2aWNlLXBhcnNlcic7XG5cbmltcG9ydCB0eXBlIHtSZXF1ZXN0TWVzc2FnZSwgQ2FsbFJlbW90ZUZ1bmN0aW9uTWVzc2FnZSwgQ3JlYXRlUmVtb3RlT2JqZWN0TWVzc2FnZSxcbiAgQ2FsbFJlbW90ZU1ldGhvZE1lc3NhZ2UsIERpc3Bvc2VSZW1vdGVPYmplY3RNZXNzYWdlLCBEaXNwb3NlT2JzZXJ2YWJsZU1lc3NhZ2UsXG4gIFJldHVyblR5cGUsIE9ic2VydmFibGVSZXN1bHR9IGZyb20gJy4vdHlwZXMnO1xuXG5jb25zdCBsb2dnZXIgPSByZXF1aXJlKCdudWNsaWRlLWxvZ2dpbmcnKS5nZXRMb2dnZXIoKTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2xpZW50Q29tcG9uZW50IHtcbiAgX2VtaXR0ZXI6IEV2ZW50RW1pdHRlcjtcbiAgX3NvY2tldDogTnVjbGlkZVNvY2tldDtcbiAgX3JlcXVlc3RJZEdlbmVyYXRvcjogKCkgPT4gbnVtYmVyO1xuXG4gIF90eXBlUmVnaXN0cnk6IFR5cGVSZWdpc3RyeTtcbiAgX29iamVjdFJlZ2lzdHJ5OiBNYXA8bnVtYmVyLCBhbnk+O1xuXG4gIGNvbnN0cnVjdG9yKGVtaXR0ZXI6IEV2ZW50RW1pdHRlciwgc29ja2V0OiBOdWNsaWRlU29ja2V0LCByZXF1ZXN0SWRHZW5lcmF0b3I6ICgpID0+IG51bWJlcikge1xuICAgIHRoaXMuX2VtaXR0ZXIgPSBlbWl0dGVyO1xuICAgIHRoaXMuX3NvY2tldCA9IHNvY2tldDtcbiAgICB0aGlzLl9yZXF1ZXN0SWRHZW5lcmF0b3IgPSByZXF1ZXN0SWRHZW5lcmF0b3I7XG5cbiAgICB0aGlzLl90eXBlUmVnaXN0cnkgPSBuZXcgVHlwZVJlZ2lzdHJ5KCk7XG4gICAgdGhpcy5fb2JqZWN0UmVnaXN0cnkgPSBuZXcgTWFwKCk7XG5cbiAgICAvLyBTZXR1cCBzZXJ2aWNlcy5cbiAgICBjb25zdCBzZXJ2aWNlcyA9IGNvbmZpZy5sb2FkU2VydmljZXNDb25maWcoKTtcbiAgICBmb3IgKGNvbnN0IHNlcnZpY2Ugb2Ygc2VydmljZXMpIHtcbiAgICAgIGxvZ2dlci5kZWJ1ZyhgUmVnaXN0ZXJpbmcgMy4wIHNlcnZpY2UgJHtzZXJ2aWNlLm5hbWV9Li4uYCk7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBkZWZzID0gZ2V0RGVmaW5pdGlvbnMoc2VydmljZS5kZWZpbml0aW9uKTtcbiAgICAgICAgY29uc3QgcHJveHkgPSBnZXRQcm94eShzZXJ2aWNlLm5hbWUsIHNlcnZpY2UuZGVmaW5pdGlvbiwgdGhpcyk7XG5cbiAgICAgICAgZGVmcy5mb3JFYWNoKGRlZmluaXRpb24gPT4ge1xuICAgICAgICAgIGNvbnN0IG5hbWUgPSBkZWZpbml0aW9uLm5hbWU7XG4gICAgICAgICAgc3dpdGNoIChkZWZpbml0aW9uLmtpbmQpIHtcbiAgICAgICAgICAgIGNhc2UgJ2FsaWFzJzpcbiAgICAgICAgICAgICAgbG9nZ2VyLmRlYnVnKGBSZWdpc3RlcmluZyB0eXBlIGFsaWFzICR7bmFtZX0uLi5gKTtcbiAgICAgICAgICAgICAgaWYgKGRlZmluaXRpb24uZGVmaW5pdGlvbiAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5fdHlwZVJlZ2lzdHJ5LnJlZ2lzdGVyQWxpYXMobmFtZSwgZGVmaW5pdGlvbi5kZWZpbml0aW9uKTtcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ2ludGVyZmFjZSc6XG4gICAgICAgICAgICAgIGxvZ2dlci5kZWJ1ZyhgUmVnaXN0ZXJpbmcgaW50ZXJmYWNlICR7bmFtZX0uYCk7XG4gICAgICAgICAgICAgIHRoaXMuX3R5cGVSZWdpc3RyeS5yZWdpc3RlclR5cGUobmFtZSwgYXN5bmMgb2JqZWN0ID0+IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gYXdhaXQgb2JqZWN0Ll9pZFByb21pc2U7XG4gICAgICAgICAgICAgIH0sIGFzeW5jIG9iamVjdElkID0+IHtcbiAgICAgICAgICAgICAgICAvLyBSZXR1cm4gYSBjYWNoZWQgcHJveHksIGlmIG9uZSBhbHJlYWR5IGV4aXN0cywgZm9yIHRoaXMgb2JqZWN0LlxuICAgICAgICAgICAgICAgIGlmICh0aGlzLl9vYmplY3RSZWdpc3RyeS5oYXMob2JqZWN0SWQpKSB7XG4gICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5fb2JqZWN0UmVnaXN0cnkuZ2V0KG9iamVjdElkKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAvLyBHZW5lcmF0ZSB0aGUgcHJveHkgYnkgbWFudWFsbHkgc2V0dGluZyB0aGUgcHJvdG90eXBlIG9mIHRoZSBvYmplY3QgdG8gYmUgdGhlXG4gICAgICAgICAgICAgICAgLy8gcHJvdG90eXBlIG9mIHRoZSByZW1vdGUgcHJveHkgY29uc3RydWN0b3IuXG4gICAgICAgICAgICAgICAgY29uc3Qgb2JqZWN0ID0geyBfaWRQcm9taXNlOiBQcm9taXNlLnJlc29sdmUob2JqZWN0SWQpIH07XG4gICAgICAgICAgICAgICAgT2JqZWN0LnNldFByb3RvdHlwZU9mKG9iamVjdCwgcHJveHlbbmFtZV0ucHJvdG90eXBlKTtcbiAgICAgICAgICAgICAgICB0aGlzLl9vYmplY3RSZWdpc3RyeS5zZXQob2JqZWN0SWQsIG9iamVjdCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG9iamVjdDtcbiAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9IGNhdGNoKGUpIHtcbiAgICAgICAgbG9nZ2VyLmVycm9yKGBGYWlsZWQgdG8gbG9hZCBzZXJ2aWNlICR7c2VydmljZS5uYW1lfS4gU3RhY2sgVHJhY2U6XFxuJHtlLnN0YWNrfWApO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICAvLyBEZWxlZ2F0ZSBtYXJzaGFsbGluZyB0byB0aGUgdHlwZSByZWdpc3RyeS5cbiAgbWFyc2hhbCguLi5hcmdzKTogYW55IHtcbiAgICByZXR1cm4gdGhpcy5fdHlwZVJlZ2lzdHJ5Lm1hcnNoYWwoLi4uYXJncyk7XG4gIH1cbiAgdW5tYXJzaGFsKC4uLmFyZ3MpOiBhbnkge1xuICAgIHJldHVybiB0aGlzLl90eXBlUmVnaXN0cnkudW5tYXJzaGFsKC4uLmFyZ3MpO1xuICB9XG4gIHJlZ2lzdGVyVHlwZSguLi5hcmdzKTogdm9pZCB7XG4gICAgcmV0dXJuIHRoaXMuX3R5cGVSZWdpc3RyeS5yZWdpc3RlclR5cGUoLi4uYXJncyk7XG4gIH1cblxuICAvKipcbiAgICogQ2FsbCBhIHJlbW90ZSBmdW5jdGlvbiwgdGhyb3VnaCB0aGUgc2VydmljZSBmcmFtZXdvcmsuXG4gICAqIEBwYXJhbSBmdW5jdGlvbk5hbWUgLSBUaGUgbmFtZSBvZiB0aGUgcmVtb3RlIGZ1bmN0aW9uIHRvIGludm9rZS5cbiAgICogQHBhcmFtIHJldHVyblR5cGUgLSBUaGUgdHlwZSBvZiBvYmplY3QgdGhhdCB0aGlzIGZ1bmN0aW9uIHJldHVybnMsIHNvIHRoZSB0aGUgdHJhbnNwb3J0IGxheWVyIGNhblxuICAgKiAgIHJlZ2lzdGVyIHRoZSBhcHByb3ByaWF0ZSBsaXN0ZW5lcnMuXG4gICAqIEBwYXJhbSBhcmdzIC0gVGhlIHNlcmlhbGl6ZWQgYXJndW1lbnRzIHRvIGludm9rZSB0aGUgcmVtb3RlIGZ1bmN0aW9uIHdpdGguXG4gICAqL1xuICBjYWxsUmVtb3RlRnVuY3Rpb24oZnVuY3Rpb25OYW1lOiBzdHJpbmcsIHJldHVyblR5cGU6IFJldHVyblR5cGUsIGFyZ3M6IEFycmF5PGFueT4pOiBhbnkge1xuICAgIGNvbnN0IG1lc3NhZ2U6IENhbGxSZW1vdGVGdW5jdGlvbk1lc3NhZ2UgPSB7XG4gICAgICBwcm90b2NvbDogJ3NlcnZpY2VfZnJhbWV3b3JrM19ycGMnLFxuICAgICAgdHlwZTogJ0Z1bmN0aW9uQ2FsbCcsXG4gICAgICBmdW5jdGlvbjogZnVuY3Rpb25OYW1lLFxuICAgICAgcmVxdWVzdElkOiB0aGlzLl9yZXF1ZXN0SWRHZW5lcmF0b3IoKSxcbiAgICAgIGFyZ3MsXG4gICAgfTtcbiAgICByZXR1cm4gdGhpcy5fc2VuZE1lc3NhZ2VBbmRMaXN0ZW5Gb3JSZXN1bHQobWVzc2FnZSwgcmV0dXJuVHlwZSwgYENhbGxpbmcgZnVuY3Rpb24gJHtmdW5jdGlvbk5hbWV9YCk7XG4gIH1cblxuICAvKipcbiAgICogQ2FsbCBhIG1ldGhvZCBvZiBhIHJlbW90ZSBvYmplY3QsIHRocm91Z2ggdGhlIHNlcnZpY2UgZnJhbWV3b3JrLlxuICAgKiBAcGFyYW0gb2JqZWN0SWQgLSBUaGUgaWQgb2YgdGhlIHJlbW90ZSBvYmplY3QuXG4gICAqIEBwYXJhbSBtZXRob2ROYW1lIC0gVGhlIG5hbWUgb2YgdGhlIG1ldGhvZCB0byBpbnZva2UuXG4gICAqIEBwYXJhbSByZXR1cm5UeXBlIC0gVGhlIHR5cGUgb2Ygb2JqZWN0IHRoYXQgdGhpcyBmdW5jdGlvbiByZXR1cm5zLCBzbyB0aGUgdGhlIHRyYW5zcG9ydCBsYXllciBjYW5cbiAgICogICByZWdpc3RlciB0aGUgYXBwcm9wcmlhdGUgbGlzdGVuZXJzLlxuICAgKiBAcGFyYW0gYXJncyAtIFRoZSBzZXJpYWxpemVkIGFyZ3VtZW50cyB0byBpbnZva2UgdGhlIHJlbW90ZSBtZXRob2Qgd2l0aC5cbiAgICovXG4gIGNhbGxSZW1vdGVNZXRob2Qob2JqZWN0SWQ6IG51bWJlciwgbWV0aG9kTmFtZTogc3RyaW5nLCByZXR1cm5UeXBlOiBSZXR1cm5UeXBlLCBhcmdzOiBBcnJheTxhbnk+KTogYW55IHtcbiAgICBjb25zdCBtZXNzYWdlOiBDYWxsUmVtb3RlTWV0aG9kTWVzc2FnZSA9IHtcbiAgICAgIHByb3RvY29sOiAnc2VydmljZV9mcmFtZXdvcmszX3JwYycsXG4gICAgICB0eXBlOiAnTWV0aG9kQ2FsbCcsXG4gICAgICBtZXRob2Q6IG1ldGhvZE5hbWUsXG4gICAgICBvYmplY3RJZCxcbiAgICAgIHJlcXVlc3RJZDogdGhpcy5fcmVxdWVzdElkR2VuZXJhdG9yKCksXG4gICAgICBhcmdzLFxuICAgIH07XG4gICAgcmV0dXJuIHRoaXMuX3NlbmRNZXNzYWdlQW5kTGlzdGVuRm9yUmVzdWx0KG1lc3NhZ2UsIHJldHVyblR5cGUsIGBDYWxsaW5nIHJlbW90ZSBtZXRob2QgJHttZXRob2ROYW1lfS5gKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxsIGEgcmVtb3RlIGNvbnN0cnVjdG9yLCByZXR1cm5pbmcgYW4gaWQgdGhhdCBldmVudHVhbGx5IHJlc29sdmVzIHRvIGEgdW5pcXVlIGlkZW50aWZpZXJcbiAgICogZm9yIHRoZSBvYmplY3QuXG4gICAqIEBwYXJhbSBpbnRlcmZhY2VOYW1lIC0gVGhlIG5hbWUgb2YgdGhlIHJlbW90ZSBjbGFzcyBmb3Igd2hpY2ggdG8gY29uc3RydWN0IGFuIG9iamVjdC5cbiAgICogQHBhcmFtIGFyZ3MgLSBTZXJpYWxpemVkIGFyZ3VtZW50cyB0byBwYXNzIHRvIHRoZSByZW1vdGUgY29uc3RydWN0b3IuXG4gICAqL1xuICBjcmVhdGVSZW1vdGVPYmplY3QoaW50ZXJmYWNlTmFtZTogc3RyaW5nLCBhcmdzOiBBcnJheTxhbnk+KTogUHJvbWlzZTxudW1iZXI+IHtcbiAgICBjb25zdCBtZXNzYWdlOiBDcmVhdGVSZW1vdGVPYmplY3RNZXNzYWdlID0ge1xuICAgICAgcHJvdG9jb2w6ICdzZXJ2aWNlX2ZyYW1ld29yazNfcnBjJyxcbiAgICAgIHR5cGU6ICdOZXdPYmplY3QnLFxuICAgICAgaW50ZXJmYWNlOiBpbnRlcmZhY2VOYW1lLFxuICAgICAgcmVxdWVzdElkOiB0aGlzLl9yZXF1ZXN0SWRHZW5lcmF0b3IoKSxcbiAgICAgIGFyZ3MsXG4gICAgfTtcbiAgICByZXR1cm4gdGhpcy5fc2VuZE1lc3NhZ2VBbmRMaXN0ZW5Gb3JSZXN1bHQobWVzc2FnZSwgJ3Byb21pc2UnLCBgQ3JlYXRpbmcgaW5zdGFuY2Ugb2YgJHtpbnRlcmZhY2VOYW1lfWApO1xuICB9XG5cbiAgLyoqXG4gICAqIERpc3Bvc2UgYSByZW1vdGUgb2JqZWN0LiBUaGlzIG1ha2VzIGl0J3MgcHJveGllcyB1bnN1YWJsZSwgYW5kIGNhbGxzIHRoZSBgZGlzcG9zZWAgbWV0aG9kIG9uXG4gICAqIHRoZSByZW1vdGUgb2JqZWN0LlxuICAgKiBAcGFyYW0gb2JqZWN0SWQgLSBUaGUgbnVtZXJpY2FsIGlkIHRoYXQgaWRlbnRpZmllcyB0aGUgcmVtb3RlIG9iamVjdC5cbiAgICogQHJldHVybnMgQSBQcm9taXNlIHRoYXQgcmVzb2x2ZXMgd2hlbiB0aGUgb2JqZWN0IGRpc3Bvc2FsIGhhcyBjb21wbGV0ZWQuXG4gICAqL1xuICBkaXNwb3NlUmVtb3RlT2JqZWN0KG9iamVjdElkOiBudW1iZXIpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBtZXNzYWdlOiBEaXNwb3NlUmVtb3RlT2JqZWN0TWVzc2FnZSA9IHtcbiAgICAgIHByb3RvY29sOiAnc2VydmljZV9mcmFtZXdvcmszX3JwYycsXG4gICAgICB0eXBlOiAnRGlzcG9zZU9iamVjdCcsXG4gICAgICByZXF1ZXN0SWQ6IHRoaXMuX3JlcXVlc3RJZEdlbmVyYXRvcigpLFxuICAgICAgb2JqZWN0SWQsXG4gICAgfTtcbiAgICByZXR1cm4gdGhpcy5fc2VuZE1lc3NhZ2VBbmRMaXN0ZW5Gb3JSZXN1bHQobWVzc2FnZSwgJ3Byb21pc2UnLCBgRGlzcG9zaW5nIG9iamVjdCAke29iamVjdElkfWApO1xuICB9XG5cbiAgLyoqXG4gICAqIEhlbHBlciBmdW5jdGlvbiB0aGF0IGxpc3RlbnMgZm9yIGEgcmVzdWx0IGZvciB0aGUgZ2l2ZW4gcmVxdWVzdElkLlxuICAgKiBAcGFyYW0gcmV0dXJuVHlwZSAtIERldGVybWluZXMgdGhlIHR5cGUgb2YgbWVzc2FnZXMgd2Ugc2hvdWxkIHN1YnNjcmliZSB0bywgYW5kIHdoYXQgdGhpc1xuICAgKiAgIGZ1bmN0aW9uIHNob3VsZCByZXR1cm4uXG4gICAqIEBwYXJhbSByZXF1ZXN0SWQgLSBUaGUgaWQgb2YgdGhlIHJlcXVlc3Qgd2hvJ3MgcmVzdWx0IHdlIGFyZSBsaXN0ZW5pbmcgZm9yLlxuICAgKiBAcmV0dXJucyBEZXBlbmRpbmcgb24gdGhlIGV4cGVjdGVkIHJldHVybiB0eXBlLCB0aGlzIGZ1bmN0aW9uIGVpdGhlciByZXR1cm5zIHVuZGVmaW5lZCwgYSBQcm9taXNlLFxuICAgKiAgIG9yIGFuIE9ic2VydmFibGUuXG4gICAqL1xuICBfc2VuZE1lc3NhZ2VBbmRMaXN0ZW5Gb3JSZXN1bHQobWVzc2FnZTogUmVxdWVzdE1lc3NhZ2UsIHJldHVyblR5cGU6IFJldHVyblR5cGUsIHRpbWVvdXRNZXNzYWdlOiBzdHJpbmcpOiBhbnkge1xuICAgIHN3aXRjaCAocmV0dXJuVHlwZSkge1xuICAgICAgY2FzZSAndm9pZCc6XG4gICAgICAgIHRoaXMuX3NvY2tldC5zZW5kKG1lc3NhZ2UpO1xuICAgICAgICByZXR1cm47IC8vIE5vIHZhbHVlcyB0byByZXR1cm4uXG4gICAgICBjYXNlICdwcm9taXNlJzpcbiAgICAgICAgLy8gTGlzdGVuIGZvciBhIHNpbmdsZSBtZXNzYWdlLCBhbmQgcmVzb2x2ZSBvciByZWplY3QgYSBwcm9taXNlIG9uIHRoYXQgbWVzc2FnZS5cbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgICB0aGlzLl9zb2NrZXQuc2VuZChtZXNzYWdlKTtcbiAgICAgICAgICB0aGlzLl9lbWl0dGVyLm9uY2UobWVzc2FnZS5yZXF1ZXN0SWQudG9TdHJpbmcoKSwgKGhhZEVycm9yLCBlcnJvciwgcmVzdWx0KSA9PiB7XG4gICAgICAgICAgICBoYWRFcnJvciA/IHJlamVjdChkZWNvZGVFcnJvcihlcnJvcikpIDogcmVzb2x2ZShyZXN1bHQpO1xuICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICB0aGlzLl9lbWl0dGVyLnJlbW92ZUFsbExpc3RlbmVycyhtZXNzYWdlLnJlcXVlc3RJZC50b1N0cmluZygpKTtcbiAgICAgICAgICAgIHJlamVjdChgVGltZW91dCBhZnRlciAke1NFUlZJQ0VfRlJBTUVXT1JLX1JQQ19USU1FT1VUX01TfSBmb3IgcmVxdWVzdElkOiAke21lc3NhZ2UucmVxdWVzdElkfSwgJHt0aW1lb3V0TWVzc2FnZX0uYCk7XG4gICAgICAgICAgfSwgU0VSVklDRV9GUkFNRVdPUktfUlBDX1RJTUVPVVRfTVMpO1xuICAgICAgICB9KTtcbiAgICAgIGNhc2UgJ29ic2VydmFibGUnOlxuICAgICAgICBjb25zdCBvYnNlcnZhYmxlID0gT2JzZXJ2YWJsZS5jcmVhdGUob2JzZXJ2ZXIgPT4ge1xuICAgICAgICAgIHRoaXMuX3NvY2tldC5zZW5kKG1lc3NhZ2UpO1xuXG4gICAgICAgICAgLy8gTGlzdGVuIGZvciAnbmV4dCcsICdlcnJvcicsIGFuZCAnY29tcGxldGVkJyBldmVudHMuXG4gICAgICAgICAgdGhpcy5fZW1pdHRlci5vbihcbiAgICAgICAgICAgIG1lc3NhZ2UucmVxdWVzdElkLnRvU3RyaW5nKCksXG4gICAgICAgICAgICAoaGFkRXJyb3I6IGJvb2xlYW4sIGVycm9yOiA/RXJyb3IsIHJlc3VsdDogP09ic2VydmFibGVSZXN1bHQpID0+IHtcbiAgICAgICAgICAgICAgaWYgKGhhZEVycm9yKSB7XG4gICAgICAgICAgICAgICAgb2JzZXJ2ZXIub25FcnJvcihkZWNvZGVFcnJvcihlcnJvcikpO1xuICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGludmFyaWFudChyZXN1bHQpO1xuICAgICAgICAgICAgICAgIGlmIChyZXN1bHQudHlwZSA9PT0gJ2NvbXBsZXRlZCcpIHtcbiAgICAgICAgICAgICAgICAgIG9ic2VydmVyLm9uQ29tcGxldGVkKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChyZXN1bHQudHlwZSA9PT0gJ25leHQnKSB7XG4gICAgICAgICAgICAgICAgICBvYnNlcnZlci5vbk5leHQocmVzdWx0LmRhdGEpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAvLyBPYnNlcnZhYmxlIGRpc3Bvc2UgZnVuY3Rpb24sIHdoaWNoIGlzIGNhbGxlZCBvbiBzdWJzY3JpcHRpb24gZGlwc29zZSwgb24gc3RyZWFtXG4gICAgICAgICAgLy8gY29tcGxldGlvbiwgYW5kIG9uIHN0cmVhbSBlcnJvci5cbiAgICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5fZW1pdHRlci5yZW1vdmVBbGxMaXN0ZW5lcnMobWVzc2FnZS5yZXF1ZXN0SWQudG9TdHJpbmcoKSk7XG5cbiAgICAgICAgICAgIC8vIFNlbmQgYSBtZXNzYWdlIHRvIHNlcnZlciB0byBjYWxsIHRoZSBkaXNwb3NlIGZ1bmN0aW9uIG9mXG4gICAgICAgICAgICAvLyB0aGUgcmVtb3RlIE9ic2VydmFibGUgc3Vic2NyaXB0aW9uLlxuICAgICAgICAgICAgY29uc3QgZGlzcG9zZU1lc3NhZ2U6IERpc3Bvc2VPYnNlcnZhYmxlTWVzc2FnZSA9IHtcbiAgICAgICAgICAgICAgcHJvdG9jb2w6ICdzZXJ2aWNlX2ZyYW1ld29yazNfcnBjJyxcbiAgICAgICAgICAgICAgdHlwZTogJ0Rpc3Bvc2VPYnNlcnZhYmxlJyxcbiAgICAgICAgICAgICAgcmVxdWVzdElkOiBtZXNzYWdlLnJlcXVlc3RJZCxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLl9zb2NrZXQuc2VuZChkaXNwb3NlTWVzc2FnZSk7XG4gICAgICAgICAgfTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIG9ic2VydmFibGU7XG4gICAgICBkZWZhdWx0OlxuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYFVua293biByZXR1cm4gdHlwZTogJHtyZXR1cm5UeXBlfS5gKTtcbiAgICB9XG4gIH1cbn1cblxuLy8gVE9ETzogVGhpcyBzaG91bGQgYmUgYSBjdXN0b20gbWFyc2hhbGxlciByZWdpc3RlcmVkIGluIHRoZSBUeXBlUmVnaXN0cnlcbmZ1bmN0aW9uIGRlY29kZUVycm9yKGVuY29kZWRFcnJvcjogPyhPYmplY3QgfCBzdHJpbmcpKTogPyhFcnJvciB8IHN0cmluZykge1xuICBpZiAoZW5jb2RlZEVycm9yICE9IG51bGwgJiYgdHlwZW9mIGVuY29kZWRFcnJvciA9PT0gJ29iamVjdCcpIHtcbiAgICBjb25zdCByZXN1bHRFcnJvciA9IG5ldyBFcnJvcigpO1xuICAgIHJlc3VsdEVycm9yLm1lc3NhZ2UgPSBlbmNvZGVkRXJyb3IubWVzc2FnZTtcbiAgICAvLyAkRmxvd0lzc3VlIC0gc29tZSBFcnJvcnMgKG5vdGFibHkgZmlsZSBvcGVyYXRpb25zKSBoYXZlIGEgY29kZS5cbiAgICByZXN1bHRFcnJvci5jb2RlID0gZW5jb2RlZEVycm9yLmNvZGU7XG4gICAgcmVzdWx0RXJyb3Iuc3RhY2sgPSBlbmNvZGVkRXJyb3Iuc3RhY2s7XG4gICAgcmV0dXJuIHJlc3VsdEVycm9yO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBlbmNvZGVkRXJyb3I7XG4gIH1cbn1cbiJdfQ==\n","/home/travis/build/npmtest/node-npmtest-nuclide-server/node_modules/nuclide-server/lib/NuclideSocket.js":"var _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nvar _get = function get(_x, _x2, _x3) { var _again = true; _function: while (_again) { var object = _x, property = _x2, receiver = _x3; desc = parent = getter = undefined; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x = parent; _x2 = property; _x3 = receiver; _again = true; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { var callNext = step.bind(null, 'next'); var callThrow = step.bind(null, 'throw'); function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(callNext, callThrow); } } callNext(); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar _config = require('./config');\n\n'use babel';\n\n/*\n * Copyright (c) 2015-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the license found in the LICENSE file in\n * the root directory of this source tree.\n */\nvar url = require('url');\n\nvar _require = require('./utils');\n\nvar asyncRequest = _require.asyncRequest;\n\nvar WebSocket = require('ws');\nvar uuid = require('uuid');\n\nvar _require2 = require('events');\n\nvar EventEmitter = _require2.EventEmitter;\n\nvar logger = require('nuclide-logging').getLogger();\n\nvar INITIAL_RECONNECT_TIME_MS = 10;\nvar MAX_RECONNECT_TIME_MS = 5000;\nvar HEARTBEAT_INTERVAL_MS = 5000;\nvar MAX_HEARTBEAT_AWAY_RECONNECT_MS = 60000;\n\n// TODO(most): Rename class to reflect its new responsibilities (not just WebSocket connection).\n\nvar NuclideSocket = (function (_EventEmitter) {\n  _inherits(NuclideSocket, _EventEmitter);\n\n  function NuclideSocket(serverUri, options) {\n    _classCallCheck(this, NuclideSocket);\n\n    _get(Object.getPrototypeOf(NuclideSocket.prototype), 'constructor', this).call(this);\n    this._serverUri = serverUri;\n    this._options = options;\n    this.id = uuid.v4();\n    this._reconnectTime = INITIAL_RECONNECT_TIME_MS;\n    this._reconnectTimer = null;\n    this._connected = false;\n    this._closed = false;\n    this._previouslyConnected = false;\n    this._cachedMessages = [];\n\n    var _url$parse = url.parse(serverUri);\n\n    var protocol = _url$parse.protocol;\n    var host = _url$parse.host;\n\n    this._websocketUri = 'ws' + (protocol === 'https:' ? 's' : '') + '://' + host;\n\n    this._heartbeatConnectedOnce = false;\n    this._lastHeartbeat = null;\n    this._lastHeartbeatTime = null;\n    this._monitorServerHeartbeat();\n\n    this._reconnect();\n  }\n\n  _createClass(NuclideSocket, [{\n    key: 'waitForConnect',\n    value: function waitForConnect() {\n      var _this = this;\n\n      return new Promise(function (resolve, reject) {\n        if (_this._connected) {\n          return resolve();\n        } else {\n          _this.on('connect', resolve);\n          _this.on('reconnect', resolve);\n        }\n      });\n    }\n  }, {\n    key: '_reconnect',\n    value: function _reconnect() {\n      var _this2 = this;\n\n      var _options = this._options;\n      var certificateAuthorityCertificate = _options.certificateAuthorityCertificate;\n      var clientKey = _options.clientKey;\n      var clientCertificate = _options.clientCertificate;\n\n      var websocket = new WebSocket(this._websocketUri, {\n        cert: clientCertificate,\n        key: clientKey,\n        ca: certificateAuthorityCertificate\n      });\n\n      var onSocketOpen = function onSocketOpen() {\n        _this2._websocket = websocket;\n        _this2._reconnectTime = INITIAL_RECONNECT_TIME_MS;\n        // Handshake the server with my client id to manage my re-connect attemp, if it is.\n        websocket.send(_this2.id, function () {\n          _this2._connected = true;\n          _this2.emit('status', _this2._connected);\n          if (_this2._previouslyConnected) {\n            logger.info('WebSocket reconnected');\n            _this2.emit('reconnect');\n          } else {\n            logger.info('WebSocket connected');\n            _this2.emit('connect');\n          }\n          _this2._previouslyConnected = true;\n          _this2._cachedMessages.splice(0).forEach(function (message) {\n            return _this2.send(message.data);\n          });\n        });\n      };\n      websocket.on('open', onSocketOpen);\n\n      var onSocketClose = function onSocketClose() {\n        if (_this2._websocket !== websocket) {\n          return;\n        }\n        logger.info('WebSocket closed.');\n        _this2._websocket = null;\n        _this2._disconnect();\n        if (!_this2._closed) {\n          logger.info('WebSocket reconnecting after closed.');\n          _this2._scheduleReconnect();\n        }\n      };\n      websocket.on('close', onSocketClose);\n\n      var onSocketError = function onSocketError(error) {\n        if (_this2._websocket !== websocket) {\n          return;\n        }\n        logger.error('WebSocket Error - reconnecting...', error);\n        _this2._cleanWebSocket();\n        _this2._scheduleReconnect();\n      };\n      websocket.on('error', onSocketError);\n\n      var onSocketMessage = function onSocketMessage(data, flags) {\n        // flags.binary will be set if a binary data is received.\n        // flags.masked will be set if the data was masked.\n        var json = JSON.parse(data);\n        _this2.emit('message', json);\n      };\n\n      websocket.on('message', onSocketMessage);\n      // WebSocket inherits from EventEmitter, and doesn't dispose the listeners on close.\n      // Here, I added an expando property function to allow disposing those listeners on the created\n      // instance.\n      websocket.dispose = function () {\n        websocket.removeListener('open', onSocketOpen);\n        websocket.removeListener('close', onSocketClose);\n        websocket.removeListener('error', onSocketError);\n        websocket.removeListener('message', onSocketMessage);\n      };\n    }\n  }, {\n    key: '_disconnect',\n    value: function _disconnect() {\n      this._connected = false;\n      this.emit('status', this._connected);\n      this.emit('disconnect');\n    }\n  }, {\n    key: '_cleanWebSocket',\n    value: function _cleanWebSocket() {\n      var websocket = this._websocket;\n      if (websocket != null) {\n        websocket.dispose();\n        websocket.close();\n        this._websocket = null;\n      }\n    }\n  }, {\n    key: '_scheduleReconnect',\n    value: function _scheduleReconnect() {\n      var _this3 = this;\n\n      if (this._reconnectTimer) {\n        return;\n      }\n      // Exponential reconnect time trials.\n      this._reconnectTimer = setTimeout(function () {\n        _this3._reconnectTimer = null;\n        _this3._reconnect();\n      }, this._reconnectTime);\n      this._reconnectTime = this._reconnectTime * 2;\n      if (this._reconnectTime > MAX_RECONNECT_TIME_MS) {\n        this._reconnectTime = MAX_RECONNECT_TIME_MS;\n      }\n    }\n  }, {\n    key: '_clearReconnectTimer',\n    value: function _clearReconnectTimer() {\n      if (this._reconnectTimer) {\n        clearTimeout(this._reconnectTimer);\n        this._reconnectTimer = null;\n      }\n    }\n  }, {\n    key: 'send',\n    value: function send(data) {\n      var _this4 = this;\n\n      // Wrap the data in an object, because if `data` is a primitive data type,\n      // finding it in an array would return the first matching item, not necessarily the same\n      // inserted item.\n      var message = { data: data };\n      this._cachedMessages.push(message);\n      if (!this._connected) {\n        return;\n      }\n\n      var websocket = this._websocket;\n      if (websocket == null) {\n        return;\n      }\n      websocket.send(JSON.stringify(data), function (err) {\n        if (err) {\n          logger.warn('WebSocket error, but caching the message:', err);\n        } else {\n          var messageIndex = _this4._cachedMessages.indexOf(message);\n          if (messageIndex !== -1) {\n            _this4._cachedMessages.splice(messageIndex, 1);\n          }\n        }\n      });\n    }\n  }, {\n    key: 'xhrRequest',\n    value: _asyncToGenerator(function* (options) {\n      var _options2 = this._options;\n      var certificateAuthorityCertificate = _options2.certificateAuthorityCertificate;\n      var clientKey = _options2.clientKey;\n      var clientCertificate = _options2.clientCertificate;\n\n      if (certificateAuthorityCertificate && clientKey && clientCertificate) {\n        options.agentOptions = {\n          ca: certificateAuthorityCertificate,\n          key: clientKey,\n          cert: clientCertificate\n        };\n      }\n\n      options.uri = this._serverUri + '/' + options.uri;\n\n      var _ref = yield asyncRequest(options);\n\n      var body = _ref.body;\n\n      return body;\n    })\n  }, {\n    key: '_monitorServerHeartbeat',\n    value: function _monitorServerHeartbeat() {\n      var _this5 = this;\n\n      this._heartbeat();\n      this._heartbeatInterval = setInterval(function () {\n        return _this5._heartbeat();\n      }, HEARTBEAT_INTERVAL_MS);\n    }\n\n    // Resolves if the connection looks healthy.\n    // Will reject quickly if the connection looks unhealthy.\n  }, {\n    key: 'testConnection',\n    value: function testConnection() {\n      return this._sendHeartBeat();\n    }\n  }, {\n    key: '_sendHeartBeat',\n    value: function _sendHeartBeat() {\n      return this.xhrRequest({\n        uri: _config.HEARTBEAT_CHANNEL,\n        method: 'POST'\n      });\n    }\n  }, {\n    key: '_heartbeat',\n    value: _asyncToGenerator(function* () {\n      try {\n        yield this._sendHeartBeat();\n        this._heartbeatConnectedOnce = true;\n        var now = Date.now();\n        this._lastHeartbeatTime = this._lastHeartbeatTime || now;\n        if (this._lastHeartbeat === 'away' || now - this._lastHeartbeatTime > MAX_HEARTBEAT_AWAY_RECONNECT_MS) {\n          // Trigger a websocket reconnect.\n          this._cleanWebSocket();\n          this._scheduleReconnect();\n        }\n        this._lastHeartbeat = 'here';\n        this._lastHeartbeatTime = now;\n        this.emit('heartbeat');\n      } catch (err) {\n        this._disconnect();\n        this._lastHeartbeat = 'away';\n        // Error code could could be one of:\n        // ['ENOTFOUND', 'ECONNREFUSED', 'ECONNRESET', 'ETIMEDOUT']\n        // A heuristic mapping is done between the xhr error code to the state of server connection.\n        var originalCode = err.code;\n        var message = err.message;\n\n        var code = null;\n        switch (originalCode) {\n          case 'ENOTFOUND':\n          // A socket operation failed because the network was down.\n          case 'ENETDOWN':\n          // The range of the temporary ports for connection are all taken,\n          // This is temporal with many http requests, but should be counted as a network away event.\n          case 'EADDRNOTAVAIL':\n          // The host server is unreachable, could be in a VPN.\n          case 'EHOSTUNREACH':\n          // A request timeout is considered a network away event.\n          case 'ETIMEDOUT':\n            code = 'NETWORK_AWAY';\n            break;\n          case 'ECONNREFUSED':\n            // Server shut down or port no longer accessible.\n            if (this._heartbeatConnectedOnce) {\n              code = 'SERVER_CRASHED';\n            } else {\n              code = 'PORT_NOT_ACCESSIBLE';\n            }\n            break;\n          case 'ECONNRESET':\n            code = 'INVALID_CERTIFICATE';\n            break;\n          default:\n            code = originalCode;\n            break;\n        }\n        this.emit('heartbeat.error', { code: code, originalCode: originalCode, message: message });\n      }\n    })\n  }, {\n    key: 'getServerUri',\n    value: function getServerUri() {\n      return this._serverUri;\n    }\n  }, {\n    key: 'close',\n    value: function close() {\n      this._closed = true;\n      if (this._connected) {\n        this._disconnect();\n      }\n      if (this._reconnectTimer) {\n        clearTimeout(this._reconnectTimer);\n      }\n      this._cleanWebSocket();\n      this._cachedMessages = [];\n      this._reconnectTime = INITIAL_RECONNECT_TIME_MS;\n      if (this._heartbeatInterval != null) {\n        clearInterval(this._heartbeatInterval);\n      }\n    }\n  }, {\n    key: 'isConnected',\n    value: function isConnected() {\n      return this._connected;\n    }\n  }]);\n\n  return NuclideSocket;\n})(EventEmitter);\n\nmodule.exports = NuclideSocket;\n// ID from a setTimeout() call.\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi92YXIvZm9sZGVycy94Zi9yc3BoNF9jNTczMTVyczU3eHhzZHNrcnhudjM2dDAvVC90bXBwZmw1Mm5wdWJsaXNoX3BhY2thZ2VzL25wbS9udWNsaWRlLXNlcnZlci9saWIvTnVjbGlkZVNvY2tldC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O3NCQWdCZ0MsVUFBVTs7QUFoQjFDLFdBQVcsQ0FBQzs7Ozs7Ozs7O0FBVVosSUFBTSxHQUFHLEdBQUcsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDOztlQUNKLE9BQU8sQ0FBQyxTQUFTLENBQUM7O0lBQWxDLFlBQVksWUFBWixZQUFZOztBQUNuQixJQUFNLFNBQVMsR0FBRyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDaEMsSUFBTSxJQUFJLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDOztnQkFDTixPQUFPLENBQUMsUUFBUSxDQUFDOztJQUFqQyxZQUFZLGFBQVosWUFBWTs7QUFDbkIsSUFBTSxNQUFNLEdBQUcsT0FBTyxDQUFDLGlCQUFpQixDQUFDLENBQUMsU0FBUyxFQUFFLENBQUM7O0FBU3RELElBQU0seUJBQXlCLEdBQUcsRUFBRSxDQUFDO0FBQ3JDLElBQU0scUJBQXFCLEdBQUcsSUFBSSxDQUFDO0FBQ25DLElBQU0scUJBQXFCLEdBQUcsSUFBSSxDQUFDO0FBQ25DLElBQU0sK0JBQStCLEdBQUcsS0FBSyxDQUFDOzs7O0lBR3hDLGFBQWE7WUFBYixhQUFhOztBQWtCTixXQWxCUCxhQUFhLENBa0JMLFNBQWlCLEVBQUUsT0FBOEIsRUFBRTswQkFsQjNELGFBQWE7O0FBbUJmLCtCQW5CRSxhQUFhLDZDQW1CUDtBQUNSLFFBQUksQ0FBQyxVQUFVLEdBQUcsU0FBUyxDQUFDO0FBQzVCLFFBQUksQ0FBQyxRQUFRLEdBQUcsT0FBTyxDQUFDO0FBQ3hCLFFBQUksQ0FBQyxFQUFFLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDO0FBQ3BCLFFBQUksQ0FBQyxjQUFjLEdBQUcseUJBQXlCLENBQUM7QUFDaEQsUUFBSSxDQUFDLGVBQWUsR0FBRyxJQUFJLENBQUM7QUFDNUIsUUFBSSxDQUFDLFVBQVUsR0FBRyxLQUFLLENBQUM7QUFDeEIsUUFBSSxDQUFDLE9BQU8sR0FBRyxLQUFLLENBQUM7QUFDckIsUUFBSSxDQUFDLG9CQUFvQixHQUFHLEtBQUssQ0FBQztBQUNsQyxRQUFJLENBQUMsZUFBZSxHQUFHLEVBQUUsQ0FBQzs7cUJBRUQsR0FBRyxDQUFDLEtBQUssQ0FBQyxTQUFTLENBQUM7O1FBQXRDLFFBQVEsY0FBUixRQUFRO1FBQUUsSUFBSSxjQUFKLElBQUk7O0FBQ3JCLFFBQUksQ0FBQyxhQUFhLFdBQVEsUUFBUSxLQUFLLFFBQVEsR0FBRyxHQUFHLEdBQUcsRUFBRSxDQUFBLFdBQU0sSUFBSSxBQUFFLENBQUM7O0FBRXZFLFFBQUksQ0FBQyx1QkFBdUIsR0FBRyxLQUFLLENBQUM7QUFDckMsUUFBSSxDQUFDLGNBQWMsR0FBRyxJQUFJLENBQUM7QUFDM0IsUUFBSSxDQUFDLGtCQUFrQixHQUFHLElBQUksQ0FBQztBQUMvQixRQUFJLENBQUMsdUJBQXVCLEVBQUUsQ0FBQzs7QUFFL0IsUUFBSSxDQUFDLFVBQVUsRUFBRSxDQUFDO0dBQ25COztlQXZDRyxhQUFhOztXQXlDSCwwQkFBWTs7O0FBQ3hCLGFBQU8sSUFBSSxPQUFPLENBQUMsVUFBQyxPQUFPLEVBQUUsTUFBTSxFQUFLO0FBQ3RDLFlBQUksTUFBSyxVQUFVLEVBQUU7QUFDbkIsaUJBQU8sT0FBTyxFQUFFLENBQUM7U0FDbEIsTUFBTTtBQUNMLGdCQUFLLEVBQUUsQ0FBQyxTQUFTLEVBQUUsT0FBTyxDQUFDLENBQUM7QUFDNUIsZ0JBQUssRUFBRSxDQUFDLFdBQVcsRUFBRSxPQUFPLENBQUMsQ0FBQztTQUMvQjtPQUNGLENBQUMsQ0FBQztLQUNKOzs7V0FFUyxzQkFBRzs7O3FCQUM2RCxJQUFJLENBQUMsUUFBUTtVQUE5RSwrQkFBK0IsWUFBL0IsK0JBQStCO1VBQUUsU0FBUyxZQUFULFNBQVM7VUFBRSxpQkFBaUIsWUFBakIsaUJBQWlCOztBQUNwRSxVQUFNLFNBQVMsR0FBRyxJQUFJLFNBQVMsQ0FBQyxJQUFJLENBQUMsYUFBYSxFQUFFO0FBQ2xELFlBQUksRUFBRSxpQkFBaUI7QUFDdkIsV0FBRyxFQUFFLFNBQVM7QUFDZCxVQUFFLEVBQUUsK0JBQStCO09BQ3BDLENBQUMsQ0FBQzs7QUFFSCxVQUFNLFlBQVksR0FBRyxTQUFmLFlBQVksR0FBUztBQUN6QixlQUFLLFVBQVUsR0FBRyxTQUFTLENBQUM7QUFDNUIsZUFBSyxjQUFjLEdBQUcseUJBQXlCLENBQUM7O0FBRWhELGlCQUFTLENBQUMsSUFBSSxDQUFDLE9BQUssRUFBRSxFQUFFLFlBQU07QUFDNUIsaUJBQUssVUFBVSxHQUFHLElBQUksQ0FBQztBQUN2QixpQkFBSyxJQUFJLENBQUMsUUFBUSxFQUFFLE9BQUssVUFBVSxDQUFDLENBQUM7QUFDckMsY0FBSSxPQUFLLG9CQUFvQixFQUFFO0FBQzdCLGtCQUFNLENBQUMsSUFBSSxDQUFDLHVCQUF1QixDQUFDLENBQUM7QUFDckMsbUJBQUssSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDO1dBQ3hCLE1BQU07QUFDTCxrQkFBTSxDQUFDLElBQUksQ0FBQyxxQkFBcUIsQ0FBQyxDQUFDO0FBQ25DLG1CQUFLLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztXQUN0QjtBQUNELGlCQUFLLG9CQUFvQixHQUFHLElBQUksQ0FBQztBQUNqQyxpQkFBSyxlQUFlLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxVQUFBLE9BQU87bUJBQUksT0FBSyxJQUFJLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQztXQUFBLENBQUMsQ0FBQztTQUM1RSxDQUFDLENBQUM7T0FDSixDQUFDO0FBQ0YsZUFBUyxDQUFDLEVBQUUsQ0FBQyxNQUFNLEVBQUUsWUFBWSxDQUFDLENBQUM7O0FBRW5DLFVBQU0sYUFBYSxHQUFHLFNBQWhCLGFBQWEsR0FBUztBQUMxQixZQUFJLE9BQUssVUFBVSxLQUFLLFNBQVMsRUFBRTtBQUNqQyxpQkFBTztTQUNSO0FBQ0QsY0FBTSxDQUFDLElBQUksQ0FBQyxtQkFBbUIsQ0FBQyxDQUFDO0FBQ2pDLGVBQUssVUFBVSxHQUFHLElBQUksQ0FBQztBQUN2QixlQUFLLFdBQVcsRUFBRSxDQUFDO0FBQ25CLFlBQUksQ0FBQyxPQUFLLE9BQU8sRUFBRTtBQUNqQixnQkFBTSxDQUFDLElBQUksQ0FBQyxzQ0FBc0MsQ0FBQyxDQUFDO0FBQ3BELGlCQUFLLGtCQUFrQixFQUFFLENBQUM7U0FDM0I7T0FDRixDQUFDO0FBQ0YsZUFBUyxDQUFDLEVBQUUsQ0FBQyxPQUFPLEVBQUUsYUFBYSxDQUFDLENBQUM7O0FBRXJDLFVBQU0sYUFBYSxHQUFHLFNBQWhCLGFBQWEsQ0FBSSxLQUFLLEVBQUs7QUFDL0IsWUFBSSxPQUFLLFVBQVUsS0FBSyxTQUFTLEVBQUU7QUFDakMsaUJBQU87U0FDUjtBQUNELGNBQU0sQ0FBQyxLQUFLLENBQUMsbUNBQW1DLEVBQUUsS0FBSyxDQUFDLENBQUM7QUFDekQsZUFBSyxlQUFlLEVBQUUsQ0FBQztBQUN2QixlQUFLLGtCQUFrQixFQUFFLENBQUM7T0FDM0IsQ0FBQztBQUNGLGVBQVMsQ0FBQyxFQUFFLENBQUMsT0FBTyxFQUFFLGFBQWEsQ0FBQyxDQUFDOztBQUVyQyxVQUFNLGVBQWUsR0FBRyxTQUFsQixlQUFlLENBQUksSUFBSSxFQUFFLEtBQUssRUFBSzs7O0FBR3ZDLFlBQU0sSUFBSSxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDOUIsZUFBSyxJQUFJLENBQUMsU0FBUyxFQUFFLElBQUksQ0FBQyxDQUFDO09BQzVCLENBQUM7O0FBRUYsZUFBUyxDQUFDLEVBQUUsQ0FBQyxTQUFTLEVBQUUsZUFBZSxDQUFDLENBQUM7Ozs7QUFJekMsZUFBUyxDQUFDLE9BQU8sR0FBRyxZQUFNO0FBQ3hCLGlCQUFTLENBQUMsY0FBYyxDQUFDLE1BQU0sRUFBRSxZQUFZLENBQUMsQ0FBQztBQUMvQyxpQkFBUyxDQUFDLGNBQWMsQ0FBQyxPQUFPLEVBQUUsYUFBYSxDQUFDLENBQUM7QUFDakQsaUJBQVMsQ0FBQyxjQUFjLENBQUMsT0FBTyxFQUFFLGFBQWEsQ0FBQyxDQUFDO0FBQ2pELGlCQUFTLENBQUMsY0FBYyxDQUFDLFNBQVMsRUFBRSxlQUFlLENBQUMsQ0FBQztPQUN0RCxDQUFDO0tBQ0g7OztXQUVVLHVCQUFHO0FBQ1osVUFBSSxDQUFDLFVBQVUsR0FBRyxLQUFLLENBQUM7QUFDeEIsVUFBSSxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLFVBQVUsQ0FBQyxDQUFDO0FBQ3JDLFVBQUksQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDLENBQUM7S0FDekI7OztXQUVjLDJCQUFHO0FBQ2hCLFVBQU0sU0FBUyxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUM7QUFDbEMsVUFBSSxTQUFTLElBQUksSUFBSSxFQUFFO0FBQ3JCLGlCQUFTLENBQUMsT0FBTyxFQUFFLENBQUM7QUFDcEIsaUJBQVMsQ0FBQyxLQUFLLEVBQUUsQ0FBQztBQUNsQixZQUFJLENBQUMsVUFBVSxHQUFHLElBQUksQ0FBQztPQUN4QjtLQUNGOzs7V0FFaUIsOEJBQUc7OztBQUNuQixVQUFJLElBQUksQ0FBQyxlQUFlLEVBQUU7QUFDeEIsZUFBTztPQUNSOztBQUVELFVBQUksQ0FBQyxlQUFlLEdBQUcsVUFBVSxDQUFDLFlBQU07QUFDdEMsZUFBSyxlQUFlLEdBQUcsSUFBSSxDQUFDO0FBQzVCLGVBQUssVUFBVSxFQUFFLENBQUM7T0FDbkIsRUFBRSxJQUFJLENBQUMsY0FBYyxDQUFDLENBQUM7QUFDeEIsVUFBSSxDQUFDLGNBQWMsR0FBRyxJQUFJLENBQUMsY0FBYyxHQUFHLENBQUMsQ0FBQztBQUM5QyxVQUFJLElBQUksQ0FBQyxjQUFjLEdBQUcscUJBQXFCLEVBQUU7QUFDL0MsWUFBSSxDQUFDLGNBQWMsR0FBRyxxQkFBcUIsQ0FBQztPQUM3QztLQUNGOzs7V0FFbUIsZ0NBQUc7QUFDckIsVUFBSSxJQUFJLENBQUMsZUFBZSxFQUFFO0FBQ3hCLG9CQUFZLENBQUMsSUFBSSxDQUFDLGVBQWUsQ0FBQyxDQUFDO0FBQ25DLFlBQUksQ0FBQyxlQUFlLEdBQUcsSUFBSSxDQUFDO09BQzdCO0tBQ0Y7OztXQUVHLGNBQUMsSUFBUyxFQUFROzs7Ozs7QUFJcEIsVUFBTSxPQUFPLEdBQUcsRUFBQyxJQUFJLEVBQUosSUFBSSxFQUFDLENBQUM7QUFDdkIsVUFBSSxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsT0FBTyxDQUFDLENBQUM7QUFDbkMsVUFBSSxDQUFDLElBQUksQ0FBQyxVQUFVLEVBQUU7QUFDcEIsZUFBTztPQUNSOztBQUVELFVBQU0sU0FBUyxHQUFHLElBQUksQ0FBQyxVQUFVLENBQUM7QUFDbEMsVUFBSSxTQUFTLElBQUksSUFBSSxFQUFFO0FBQ3JCLGVBQU87T0FDUjtBQUNELGVBQVMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxJQUFJLENBQUMsRUFBRSxVQUFDLEdBQUcsRUFBSztBQUM1QyxZQUFJLEdBQUcsRUFBRTtBQUNQLGdCQUFNLENBQUMsSUFBSSxDQUFDLDJDQUEyQyxFQUFFLEdBQUcsQ0FBQyxDQUFDO1NBQy9ELE1BQU07QUFDTCxjQUFNLFlBQVksR0FBRyxPQUFLLGVBQWUsQ0FBQyxPQUFPLENBQUMsT0FBTyxDQUFDLENBQUM7QUFDM0QsY0FBSSxZQUFZLEtBQUssQ0FBQyxDQUFDLEVBQUU7QUFDdkIsbUJBQUssZUFBZSxDQUFDLE1BQU0sQ0FBQyxZQUFZLEVBQUUsQ0FBQyxDQUFDLENBQUM7V0FDOUM7U0FDRjtPQUNGLENBQUMsQ0FBQztLQUNKOzs7NkJBRWUsV0FBQyxPQUFZLEVBQXVCO3NCQUNzQixJQUFJLENBQUMsUUFBUTtVQUE5RSwrQkFBK0IsYUFBL0IsK0JBQStCO1VBQUUsU0FBUyxhQUFULFNBQVM7VUFBRSxpQkFBaUIsYUFBakIsaUJBQWlCOztBQUNwRSxVQUFJLCtCQUErQixJQUFJLFNBQVMsSUFBSSxpQkFBaUIsRUFBRTtBQUNyRSxlQUFPLENBQUMsWUFBWSxHQUFHO0FBQ3JCLFlBQUUsRUFBRSwrQkFBK0I7QUFDbkMsYUFBRyxFQUFFLFNBQVM7QUFDZCxjQUFJLEVBQUUsaUJBQWlCO1NBQ3hCLENBQUM7T0FDSDs7QUFFRCxhQUFPLENBQUMsR0FBRyxHQUFHLElBQUksQ0FBQyxVQUFVLEdBQUcsR0FBRyxHQUFHLE9BQU8sQ0FBQyxHQUFHLENBQUM7O2lCQUNuQyxNQUFNLFlBQVksQ0FBQyxPQUFPLENBQUM7O1VBQW5DLElBQUksUUFBSixJQUFJOztBQUNYLGFBQU8sSUFBSSxDQUFDO0tBQ2I7OztXQUVzQixtQ0FBUzs7O0FBQzlCLFVBQUksQ0FBQyxVQUFVLEVBQUUsQ0FBQztBQUNsQixVQUFJLENBQUMsa0JBQWtCLEdBQUcsV0FBVyxDQUFDO2VBQU0sT0FBSyxVQUFVLEVBQUU7T0FBQSxFQUFFLHFCQUFxQixDQUFDLENBQUM7S0FDdkY7Ozs7OztXQUlhLDBCQUFrQjtBQUM5QixhQUFPLElBQUksQ0FBQyxjQUFjLEVBQUUsQ0FBQztLQUM5Qjs7O1dBRWEsMEJBQWtCO0FBQzlCLGFBQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQztBQUNyQixXQUFHLFVBcE9ELGlCQUFpQixBQW9PRztBQUN0QixjQUFNLEVBQUUsTUFBTTtPQUNmLENBQUMsQ0FBQztLQUNKOzs7NkJBRWUsYUFBa0I7QUFDaEMsVUFBSTtBQUNGLGNBQU0sSUFBSSxDQUFDLGNBQWMsRUFBRSxDQUFDO0FBQzVCLFlBQUksQ0FBQyx1QkFBdUIsR0FBRyxJQUFJLENBQUM7QUFDcEMsWUFBTSxHQUFHLEdBQUcsSUFBSSxDQUFDLEdBQUcsRUFBRSxDQUFDO0FBQ3ZCLFlBQUksQ0FBQyxrQkFBa0IsR0FBRyxJQUFJLENBQUMsa0JBQWtCLElBQUksR0FBRyxDQUFDO0FBQ3pELFlBQUksSUFBSSxDQUFDLGNBQWMsS0FBSyxNQUFNLElBQzFCLEFBQUMsR0FBRyxHQUFHLElBQUksQ0FBQyxrQkFBa0IsR0FBSSwrQkFBK0IsQUFBQyxFQUFFOztBQUUxRSxjQUFJLENBQUMsZUFBZSxFQUFFLENBQUM7QUFDdkIsY0FBSSxDQUFDLGtCQUFrQixFQUFFLENBQUM7U0FDM0I7QUFDRCxZQUFJLENBQUMsY0FBYyxHQUFHLE1BQU0sQ0FBQztBQUM3QixZQUFJLENBQUMsa0JBQWtCLEdBQUcsR0FBRyxDQUFDO0FBQzlCLFlBQUksQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLENBQUM7T0FDeEIsQ0FBQyxPQUFPLEdBQUcsRUFBRTtBQUNaLFlBQUksQ0FBQyxXQUFXLEVBQUUsQ0FBQztBQUNuQixZQUFJLENBQUMsY0FBYyxHQUFHLE1BQU0sQ0FBQzs7OztZQUloQixZQUFZLEdBQWEsR0FBRyxDQUFsQyxJQUFJO1lBQWdCLE9BQU8sR0FBSSxHQUFHLENBQWQsT0FBTzs7QUFDbEMsWUFBSSxJQUFJLEdBQUcsSUFBSSxDQUFDO0FBQ2hCLGdCQUFRLFlBQVk7QUFDbEIsZUFBSyxXQUFXLENBQUM7O0FBRWpCLGVBQUssVUFBVSxDQUFDOzs7QUFHaEIsZUFBSyxlQUFlLENBQUM7O0FBRXJCLGVBQUssY0FBYyxDQUFDOztBQUVwQixlQUFLLFdBQVc7QUFDZCxnQkFBSSxHQUFHLGNBQWMsQ0FBQztBQUN0QixrQkFBTTtBQUFBLEFBQ1IsZUFBSyxjQUFjOztBQUVqQixnQkFBSSxJQUFJLENBQUMsdUJBQXVCLEVBQUU7QUFDaEMsa0JBQUksR0FBRyxnQkFBZ0IsQ0FBQzthQUN6QixNQUFNO0FBQ0wsa0JBQUksR0FBRyxxQkFBcUIsQ0FBQzthQUM5QjtBQUNELGtCQUFNO0FBQUEsQUFDUixlQUFLLFlBQVk7QUFDZixnQkFBSSxHQUFHLHFCQUFxQixDQUFDO0FBQzdCLGtCQUFNO0FBQUEsQUFDUjtBQUNFLGdCQUFJLEdBQUcsWUFBWSxDQUFDO0FBQ3BCLGtCQUFNO0FBQUEsU0FDVDtBQUNELFlBQUksQ0FBQyxJQUFJLENBQUMsaUJBQWlCLEVBQUUsRUFBQyxJQUFJLEVBQUosSUFBSSxFQUFFLFlBQVksRUFBWixZQUFZLEVBQUUsT0FBTyxFQUFQLE9BQU8sRUFBQyxDQUFDLENBQUM7T0FDN0Q7S0FDRjs7O1dBRVcsd0JBQVc7QUFDckIsYUFBTyxJQUFJLENBQUMsVUFBVSxDQUFDO0tBQ3hCOzs7V0FFSSxpQkFBRztBQUNOLFVBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDO0FBQ3BCLFVBQUksSUFBSSxDQUFDLFVBQVUsRUFBRTtBQUNuQixZQUFJLENBQUMsV0FBVyxFQUFFLENBQUM7T0FDcEI7QUFDRCxVQUFJLElBQUksQ0FBQyxlQUFlLEVBQUU7QUFDeEIsb0JBQVksQ0FBQyxJQUFJLENBQUMsZUFBZSxDQUFDLENBQUM7T0FDcEM7QUFDRCxVQUFJLENBQUMsZUFBZSxFQUFFLENBQUM7QUFDdkIsVUFBSSxDQUFDLGVBQWUsR0FBRyxFQUFFLENBQUM7QUFDMUIsVUFBSSxDQUFDLGNBQWMsR0FBRyx5QkFBeUIsQ0FBQztBQUNoRCxVQUFJLElBQUksQ0FBQyxrQkFBa0IsSUFBSSxJQUFJLEVBQUU7QUFDbkMscUJBQWEsQ0FBQyxJQUFJLENBQUMsa0JBQWtCLENBQUMsQ0FBQztPQUN4QztLQUNGOzs7V0FFVSx1QkFBWTtBQUNyQixhQUFPLElBQUksQ0FBQyxVQUFVLENBQUM7S0FDeEI7OztTQXhTRyxhQUFhO0dBQVMsWUFBWTs7QUEyU3hDLE1BQU0sQ0FBQyxPQUFPLEdBQUcsYUFBYSxDQUFDIiwiZmlsZSI6Ii92YXIvZm9sZGVycy94Zi9yc3BoNF9jNTczMTVyczU3eHhzZHNrcnhudjM2dDAvVC90bXBwZmw1Mm5wdWJsaXNoX3BhY2thZ2VzL25wbS9udWNsaWRlLXNlcnZlci9saWIvTnVjbGlkZVNvY2tldC5qcyIsInNvdXJjZXNDb250ZW50IjpbIid1c2UgYmFiZWwnO1xuLyogQGZsb3cgKi9cblxuLypcbiAqIENvcHlyaWdodCAoYykgMjAxNS1wcmVzZW50LCBGYWNlYm9vaywgSW5jLlxuICogQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBsaWNlbnNlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUgaW5cbiAqIHRoZSByb290IGRpcmVjdG9yeSBvZiB0aGlzIHNvdXJjZSB0cmVlLlxuICovXG5jb25zdCB1cmwgPSByZXF1aXJlKCd1cmwnKTtcbmNvbnN0IHthc3luY1JlcXVlc3R9ID0gcmVxdWlyZSgnLi91dGlscycpO1xuY29uc3QgV2ViU29ja2V0ID0gcmVxdWlyZSgnd3MnKTtcbmNvbnN0IHV1aWQgPSByZXF1aXJlKCd1dWlkJyk7XG5jb25zdCB7RXZlbnRFbWl0dGVyfSA9IHJlcXVpcmUoJ2V2ZW50cycpO1xuY29uc3QgbG9nZ2VyID0gcmVxdWlyZSgnbnVjbGlkZS1sb2dnaW5nJykuZ2V0TG9nZ2VyKCk7XG5pbXBvcnQge0hFQVJUQkVBVF9DSEFOTkVMfSBmcm9tICcuL2NvbmZpZyc7XG5cbnR5cGUgTnVjbGlkZVNvY2tldE9wdGlvbnMgPSB7XG4gIGNlcnRpZmljYXRlQXV0aG9yaXR5Q2VydGlmaWNhdGU6ID9CdWZmZXI7XG4gIGNsaWVudENlcnRpZmljYXRlOiA/QnVmZmVyO1xuICBjbGllbnRLZXk6ID9CdWZmZXI7XG59O1xuXG5jb25zdCBJTklUSUFMX1JFQ09OTkVDVF9USU1FX01TID0gMTA7XG5jb25zdCBNQVhfUkVDT05ORUNUX1RJTUVfTVMgPSA1MDAwO1xuY29uc3QgSEVBUlRCRUFUX0lOVEVSVkFMX01TID0gNTAwMDtcbmNvbnN0IE1BWF9IRUFSVEJFQVRfQVdBWV9SRUNPTk5FQ1RfTVMgPSA2MDAwMDtcblxuLy8gVE9ETyhtb3N0KTogUmVuYW1lIGNsYXNzIHRvIHJlZmxlY3QgaXRzIG5ldyByZXNwb25zaWJpbGl0aWVzIChub3QganVzdCBXZWJTb2NrZXQgY29ubmVjdGlvbikuXG5jbGFzcyBOdWNsaWRlU29ja2V0IGV4dGVuZHMgRXZlbnRFbWl0dGVyIHtcbiAgaWQ6IHN0cmluZztcblxuICBfc2VydmVyVXJpOiBzdHJpbmc7XG4gIF9vcHRpb25zOiA/TnVjbGlkZVNvY2tldE9wdGlvbnM7XG4gIF9yZWNvbm5lY3RUaW1lOiBudW1iZXI7XG4gIF9yZWNvbm5lY3RUaW1lcjogP251bWJlcjsgLy8gSUQgZnJvbSBhIHNldFRpbWVvdXQoKSBjYWxsLlxuICBfY29ubmVjdGVkOiBib29sZWFuO1xuICBfY2xvc2VkOiBib29sZWFuO1xuICBfcHJldmlvdXNseUNvbm5lY3RlZDogYm9vbGVhbjtcbiAgX2NhY2hlZE1lc3NhZ2VzOiBBcnJheTx7ZGF0YTogYW55fT47XG4gIF93ZWJzb2NrZXRVcmk6IHN0cmluZztcbiAgX3dlYnNvY2tldDogP1dlYlNvY2tldDtcbiAgX2hlYXJ0YmVhdENvbm5lY3RlZE9uY2U6IGJvb2xlYW47XG4gIF9sYXN0SGVhcnRiZWF0OiA/KCdoZXJlJyB8ICdhd2F5Jyk7XG4gIF9sYXN0SGVhcnRiZWF0VGltZTogP251bWJlcjtcbiAgX2hlYXJ0YmVhdEludGVydmFsOiA/bnVtYmVyO1xuXG4gIGNvbnN0cnVjdG9yKHNlcnZlclVyaTogc3RyaW5nLCBvcHRpb25zOiA/TnVjbGlkZVNvY2tldE9wdGlvbnMpIHtcbiAgICBzdXBlcigpO1xuICAgIHRoaXMuX3NlcnZlclVyaSA9IHNlcnZlclVyaTtcbiAgICB0aGlzLl9vcHRpb25zID0gb3B0aW9ucztcbiAgICB0aGlzLmlkID0gdXVpZC52NCgpO1xuICAgIHRoaXMuX3JlY29ubmVjdFRpbWUgPSBJTklUSUFMX1JFQ09OTkVDVF9USU1FX01TO1xuICAgIHRoaXMuX3JlY29ubmVjdFRpbWVyID0gbnVsbDtcbiAgICB0aGlzLl9jb25uZWN0ZWQgPSBmYWxzZTtcbiAgICB0aGlzLl9jbG9zZWQgPSBmYWxzZTtcbiAgICB0aGlzLl9wcmV2aW91c2x5Q29ubmVjdGVkID0gZmFsc2U7XG4gICAgdGhpcy5fY2FjaGVkTWVzc2FnZXMgPSBbXTtcblxuICAgIGNvbnN0IHtwcm90b2NvbCwgaG9zdH0gPSB1cmwucGFyc2Uoc2VydmVyVXJpKTtcbiAgICB0aGlzLl93ZWJzb2NrZXRVcmkgPSBgd3Mke3Byb3RvY29sID09PSAnaHR0cHM6JyA/ICdzJyA6ICcnfTovLyR7aG9zdH1gO1xuXG4gICAgdGhpcy5faGVhcnRiZWF0Q29ubmVjdGVkT25jZSA9IGZhbHNlO1xuICAgIHRoaXMuX2xhc3RIZWFydGJlYXQgPSBudWxsO1xuICAgIHRoaXMuX2xhc3RIZWFydGJlYXRUaW1lID0gbnVsbDtcbiAgICB0aGlzLl9tb25pdG9yU2VydmVySGVhcnRiZWF0KCk7XG5cbiAgICB0aGlzLl9yZWNvbm5lY3QoKTtcbiAgfVxuXG4gIHdhaXRGb3JDb25uZWN0KCk6IFByb21pc2Uge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICBpZiAodGhpcy5fY29ubmVjdGVkKSB7XG4gICAgICAgIHJldHVybiByZXNvbHZlKCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLm9uKCdjb25uZWN0JywgcmVzb2x2ZSk7XG4gICAgICAgIHRoaXMub24oJ3JlY29ubmVjdCcsIHJlc29sdmUpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG5cbiAgX3JlY29ubmVjdCgpIHtcbiAgICBjb25zdCB7Y2VydGlmaWNhdGVBdXRob3JpdHlDZXJ0aWZpY2F0ZSwgY2xpZW50S2V5LCBjbGllbnRDZXJ0aWZpY2F0ZX0gPSB0aGlzLl9vcHRpb25zO1xuICAgIGNvbnN0IHdlYnNvY2tldCA9IG5ldyBXZWJTb2NrZXQodGhpcy5fd2Vic29ja2V0VXJpLCB7XG4gICAgICBjZXJ0OiBjbGllbnRDZXJ0aWZpY2F0ZSxcbiAgICAgIGtleTogY2xpZW50S2V5LFxuICAgICAgY2E6IGNlcnRpZmljYXRlQXV0aG9yaXR5Q2VydGlmaWNhdGUsXG4gICAgfSk7XG5cbiAgICBjb25zdCBvblNvY2tldE9wZW4gPSAoKSA9PiB7XG4gICAgICB0aGlzLl93ZWJzb2NrZXQgPSB3ZWJzb2NrZXQ7XG4gICAgICB0aGlzLl9yZWNvbm5lY3RUaW1lID0gSU5JVElBTF9SRUNPTk5FQ1RfVElNRV9NUztcbiAgICAgIC8vIEhhbmRzaGFrZSB0aGUgc2VydmVyIHdpdGggbXkgY2xpZW50IGlkIHRvIG1hbmFnZSBteSByZS1jb25uZWN0IGF0dGVtcCwgaWYgaXQgaXMuXG4gICAgICB3ZWJzb2NrZXQuc2VuZCh0aGlzLmlkLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2Nvbm5lY3RlZCA9IHRydWU7XG4gICAgICAgIHRoaXMuZW1pdCgnc3RhdHVzJywgdGhpcy5fY29ubmVjdGVkKTtcbiAgICAgICAgaWYgKHRoaXMuX3ByZXZpb3VzbHlDb25uZWN0ZWQpIHtcbiAgICAgICAgICBsb2dnZXIuaW5mbygnV2ViU29ja2V0IHJlY29ubmVjdGVkJyk7XG4gICAgICAgICAgdGhpcy5lbWl0KCdyZWNvbm5lY3QnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBsb2dnZXIuaW5mbygnV2ViU29ja2V0IGNvbm5lY3RlZCcpO1xuICAgICAgICAgIHRoaXMuZW1pdCgnY29ubmVjdCcpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuX3ByZXZpb3VzbHlDb25uZWN0ZWQgPSB0cnVlO1xuICAgICAgICB0aGlzLl9jYWNoZWRNZXNzYWdlcy5zcGxpY2UoMCkuZm9yRWFjaChtZXNzYWdlID0+IHRoaXMuc2VuZChtZXNzYWdlLmRhdGEpKTtcbiAgICAgIH0pO1xuICAgIH07XG4gICAgd2Vic29ja2V0Lm9uKCdvcGVuJywgb25Tb2NrZXRPcGVuKTtcblxuICAgIGNvbnN0IG9uU29ja2V0Q2xvc2UgPSAoKSA9PiB7XG4gICAgICBpZiAodGhpcy5fd2Vic29ja2V0ICE9PSB3ZWJzb2NrZXQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgbG9nZ2VyLmluZm8oJ1dlYlNvY2tldCBjbG9zZWQuJyk7XG4gICAgICB0aGlzLl93ZWJzb2NrZXQgPSBudWxsO1xuICAgICAgdGhpcy5fZGlzY29ubmVjdCgpO1xuICAgICAgaWYgKCF0aGlzLl9jbG9zZWQpIHtcbiAgICAgICAgbG9nZ2VyLmluZm8oJ1dlYlNvY2tldCByZWNvbm5lY3RpbmcgYWZ0ZXIgY2xvc2VkLicpO1xuICAgICAgICB0aGlzLl9zY2hlZHVsZVJlY29ubmVjdCgpO1xuICAgICAgfVxuICAgIH07XG4gICAgd2Vic29ja2V0Lm9uKCdjbG9zZScsIG9uU29ja2V0Q2xvc2UpO1xuXG4gICAgY29uc3Qgb25Tb2NrZXRFcnJvciA9IChlcnJvcikgPT4ge1xuICAgICAgaWYgKHRoaXMuX3dlYnNvY2tldCAhPT0gd2Vic29ja2V0KSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGxvZ2dlci5lcnJvcignV2ViU29ja2V0IEVycm9yIC0gcmVjb25uZWN0aW5nLi4uJywgZXJyb3IpO1xuICAgICAgdGhpcy5fY2xlYW5XZWJTb2NrZXQoKTtcbiAgICAgIHRoaXMuX3NjaGVkdWxlUmVjb25uZWN0KCk7XG4gICAgfTtcbiAgICB3ZWJzb2NrZXQub24oJ2Vycm9yJywgb25Tb2NrZXRFcnJvcik7XG5cbiAgICBjb25zdCBvblNvY2tldE1lc3NhZ2UgPSAoZGF0YSwgZmxhZ3MpID0+IHtcbiAgICAgIC8vIGZsYWdzLmJpbmFyeSB3aWxsIGJlIHNldCBpZiBhIGJpbmFyeSBkYXRhIGlzIHJlY2VpdmVkLlxuICAgICAgLy8gZmxhZ3MubWFza2VkIHdpbGwgYmUgc2V0IGlmIHRoZSBkYXRhIHdhcyBtYXNrZWQuXG4gICAgICBjb25zdCBqc29uID0gSlNPTi5wYXJzZShkYXRhKTtcbiAgICAgIHRoaXMuZW1pdCgnbWVzc2FnZScsIGpzb24pO1xuICAgIH07XG5cbiAgICB3ZWJzb2NrZXQub24oJ21lc3NhZ2UnLCBvblNvY2tldE1lc3NhZ2UpO1xuICAgIC8vIFdlYlNvY2tldCBpbmhlcml0cyBmcm9tIEV2ZW50RW1pdHRlciwgYW5kIGRvZXNuJ3QgZGlzcG9zZSB0aGUgbGlzdGVuZXJzIG9uIGNsb3NlLlxuICAgIC8vIEhlcmUsIEkgYWRkZWQgYW4gZXhwYW5kbyBwcm9wZXJ0eSBmdW5jdGlvbiB0byBhbGxvdyBkaXNwb3NpbmcgdGhvc2UgbGlzdGVuZXJzIG9uIHRoZSBjcmVhdGVkXG4gICAgLy8gaW5zdGFuY2UuXG4gICAgd2Vic29ja2V0LmRpc3Bvc2UgPSAoKSA9PiB7XG4gICAgICB3ZWJzb2NrZXQucmVtb3ZlTGlzdGVuZXIoJ29wZW4nLCBvblNvY2tldE9wZW4pO1xuICAgICAgd2Vic29ja2V0LnJlbW92ZUxpc3RlbmVyKCdjbG9zZScsIG9uU29ja2V0Q2xvc2UpO1xuICAgICAgd2Vic29ja2V0LnJlbW92ZUxpc3RlbmVyKCdlcnJvcicsIG9uU29ja2V0RXJyb3IpO1xuICAgICAgd2Vic29ja2V0LnJlbW92ZUxpc3RlbmVyKCdtZXNzYWdlJywgb25Tb2NrZXRNZXNzYWdlKTtcbiAgICB9O1xuICB9XG5cbiAgX2Rpc2Nvbm5lY3QoKSB7XG4gICAgdGhpcy5fY29ubmVjdGVkID0gZmFsc2U7XG4gICAgdGhpcy5lbWl0KCdzdGF0dXMnLCB0aGlzLl9jb25uZWN0ZWQpO1xuICAgIHRoaXMuZW1pdCgnZGlzY29ubmVjdCcpO1xuICB9XG5cbiAgX2NsZWFuV2ViU29ja2V0KCkge1xuICAgIGNvbnN0IHdlYnNvY2tldCA9IHRoaXMuX3dlYnNvY2tldDtcbiAgICBpZiAod2Vic29ja2V0ICE9IG51bGwpIHtcbiAgICAgIHdlYnNvY2tldC5kaXNwb3NlKCk7XG4gICAgICB3ZWJzb2NrZXQuY2xvc2UoKTtcbiAgICAgIHRoaXMuX3dlYnNvY2tldCA9IG51bGw7XG4gICAgfVxuICB9XG5cbiAgX3NjaGVkdWxlUmVjb25uZWN0KCkge1xuICAgIGlmICh0aGlzLl9yZWNvbm5lY3RUaW1lcikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICAvLyBFeHBvbmVudGlhbCByZWNvbm5lY3QgdGltZSB0cmlhbHMuXG4gICAgdGhpcy5fcmVjb25uZWN0VGltZXIgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgIHRoaXMuX3JlY29ubmVjdFRpbWVyID0gbnVsbDtcbiAgICAgIHRoaXMuX3JlY29ubmVjdCgpO1xuICAgIH0sIHRoaXMuX3JlY29ubmVjdFRpbWUpO1xuICAgIHRoaXMuX3JlY29ubmVjdFRpbWUgPSB0aGlzLl9yZWNvbm5lY3RUaW1lICogMjtcbiAgICBpZiAodGhpcy5fcmVjb25uZWN0VGltZSA+IE1BWF9SRUNPTk5FQ1RfVElNRV9NUykge1xuICAgICAgdGhpcy5fcmVjb25uZWN0VGltZSA9IE1BWF9SRUNPTk5FQ1RfVElNRV9NUztcbiAgICB9XG4gIH1cblxuICBfY2xlYXJSZWNvbm5lY3RUaW1lcigpIHtcbiAgICBpZiAodGhpcy5fcmVjb25uZWN0VGltZXIpIHtcbiAgICAgIGNsZWFyVGltZW91dCh0aGlzLl9yZWNvbm5lY3RUaW1lcik7XG4gICAgICB0aGlzLl9yZWNvbm5lY3RUaW1lciA9IG51bGw7XG4gICAgfVxuICB9XG5cbiAgc2VuZChkYXRhOiBhbnkpOiB2b2lkIHtcbiAgICAvLyBXcmFwIHRoZSBkYXRhIGluIGFuIG9iamVjdCwgYmVjYXVzZSBpZiBgZGF0YWAgaXMgYSBwcmltaXRpdmUgZGF0YSB0eXBlLFxuICAgIC8vIGZpbmRpbmcgaXQgaW4gYW4gYXJyYXkgd291bGQgcmV0dXJuIHRoZSBmaXJzdCBtYXRjaGluZyBpdGVtLCBub3QgbmVjZXNzYXJpbHkgdGhlIHNhbWVcbiAgICAvLyBpbnNlcnRlZCBpdGVtLlxuICAgIGNvbnN0IG1lc3NhZ2UgPSB7ZGF0YX07XG4gICAgdGhpcy5fY2FjaGVkTWVzc2FnZXMucHVzaChtZXNzYWdlKTtcbiAgICBpZiAoIXRoaXMuX2Nvbm5lY3RlZCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIGNvbnN0IHdlYnNvY2tldCA9IHRoaXMuX3dlYnNvY2tldDtcbiAgICBpZiAod2Vic29ja2V0ID09IG51bGwpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgd2Vic29ja2V0LnNlbmQoSlNPTi5zdHJpbmdpZnkoZGF0YSksIChlcnIpID0+IHtcbiAgICAgIGlmIChlcnIpIHtcbiAgICAgICAgbG9nZ2VyLndhcm4oJ1dlYlNvY2tldCBlcnJvciwgYnV0IGNhY2hpbmcgdGhlIG1lc3NhZ2U6JywgZXJyKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2VJbmRleCA9IHRoaXMuX2NhY2hlZE1lc3NhZ2VzLmluZGV4T2YobWVzc2FnZSk7XG4gICAgICAgIGlmIChtZXNzYWdlSW5kZXggIT09IC0xKSB7XG4gICAgICAgICAgdGhpcy5fY2FjaGVkTWVzc2FnZXMuc3BsaWNlKG1lc3NhZ2VJbmRleCwgMSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuXG4gIGFzeW5jIHhoclJlcXVlc3Qob3B0aW9uczogYW55KTogUHJvbWlzZTxzdHJpbmd8YW55PiB7XG4gICAgY29uc3Qge2NlcnRpZmljYXRlQXV0aG9yaXR5Q2VydGlmaWNhdGUsIGNsaWVudEtleSwgY2xpZW50Q2VydGlmaWNhdGV9ID0gdGhpcy5fb3B0aW9ucztcbiAgICBpZiAoY2VydGlmaWNhdGVBdXRob3JpdHlDZXJ0aWZpY2F0ZSAmJiBjbGllbnRLZXkgJiYgY2xpZW50Q2VydGlmaWNhdGUpIHtcbiAgICAgIG9wdGlvbnMuYWdlbnRPcHRpb25zID0ge1xuICAgICAgICBjYTogY2VydGlmaWNhdGVBdXRob3JpdHlDZXJ0aWZpY2F0ZSxcbiAgICAgICAga2V5OiBjbGllbnRLZXksXG4gICAgICAgIGNlcnQ6IGNsaWVudENlcnRpZmljYXRlLFxuICAgICAgfTtcbiAgICB9XG5cbiAgICBvcHRpb25zLnVyaSA9IHRoaXMuX3NlcnZlclVyaSArICcvJyArIG9wdGlvbnMudXJpO1xuICAgIGNvbnN0IHtib2R5fSA9IGF3YWl0IGFzeW5jUmVxdWVzdChvcHRpb25zKTtcbiAgICByZXR1cm4gYm9keTtcbiAgfVxuXG4gIF9tb25pdG9yU2VydmVySGVhcnRiZWF0KCk6IHZvaWQge1xuICAgIHRoaXMuX2hlYXJ0YmVhdCgpO1xuICAgIHRoaXMuX2hlYXJ0YmVhdEludGVydmFsID0gc2V0SW50ZXJ2YWwoKCkgPT4gdGhpcy5faGVhcnRiZWF0KCksIEhFQVJUQkVBVF9JTlRFUlZBTF9NUyk7XG4gIH1cblxuICAvLyBSZXNvbHZlcyBpZiB0aGUgY29ubmVjdGlvbiBsb29rcyBoZWFsdGh5LlxuICAvLyBXaWxsIHJlamVjdCBxdWlja2x5IGlmIHRoZSBjb25uZWN0aW9uIGxvb2tzIHVuaGVhbHRoeS5cbiAgdGVzdENvbm5lY3Rpb24oKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgcmV0dXJuIHRoaXMuX3NlbmRIZWFydEJlYXQoKTtcbiAgfVxuXG4gIF9zZW5kSGVhcnRCZWF0KCk6IFByb21pc2U8dm9pZD4ge1xuICAgIHJldHVybiB0aGlzLnhoclJlcXVlc3Qoe1xuICAgICAgdXJpOiBIRUFSVEJFQVRfQ0hBTk5FTCxcbiAgICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgIH0pO1xuICB9XG5cbiAgYXN5bmMgX2hlYXJ0YmVhdCgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICB0cnkge1xuICAgICAgYXdhaXQgdGhpcy5fc2VuZEhlYXJ0QmVhdCgpO1xuICAgICAgdGhpcy5faGVhcnRiZWF0Q29ubmVjdGVkT25jZSA9IHRydWU7XG4gICAgICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICAgICAgdGhpcy5fbGFzdEhlYXJ0YmVhdFRpbWUgPSB0aGlzLl9sYXN0SGVhcnRiZWF0VGltZSB8fCBub3c7XG4gICAgICBpZiAodGhpcy5fbGFzdEhlYXJ0YmVhdCA9PT0gJ2F3YXknXG4gICAgICAgICAgfHwgKChub3cgLSB0aGlzLl9sYXN0SGVhcnRiZWF0VGltZSkgPiBNQVhfSEVBUlRCRUFUX0FXQVlfUkVDT05ORUNUX01TKSkge1xuICAgICAgICAvLyBUcmlnZ2VyIGEgd2Vic29ja2V0IHJlY29ubmVjdC5cbiAgICAgICAgdGhpcy5fY2xlYW5XZWJTb2NrZXQoKTtcbiAgICAgICAgdGhpcy5fc2NoZWR1bGVSZWNvbm5lY3QoKTtcbiAgICAgIH1cbiAgICAgIHRoaXMuX2xhc3RIZWFydGJlYXQgPSAnaGVyZSc7XG4gICAgICB0aGlzLl9sYXN0SGVhcnRiZWF0VGltZSA9IG5vdztcbiAgICAgIHRoaXMuZW1pdCgnaGVhcnRiZWF0Jyk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICB0aGlzLl9kaXNjb25uZWN0KCk7XG4gICAgICB0aGlzLl9sYXN0SGVhcnRiZWF0ID0gJ2F3YXknO1xuICAgICAgLy8gRXJyb3IgY29kZSBjb3VsZCBjb3VsZCBiZSBvbmUgb2Y6XG4gICAgICAvLyBbJ0VOT1RGT1VORCcsICdFQ09OTlJFRlVTRUQnLCAnRUNPTk5SRVNFVCcsICdFVElNRURPVVQnXVxuICAgICAgLy8gQSBoZXVyaXN0aWMgbWFwcGluZyBpcyBkb25lIGJldHdlZW4gdGhlIHhociBlcnJvciBjb2RlIHRvIHRoZSBzdGF0ZSBvZiBzZXJ2ZXIgY29ubmVjdGlvbi5cbiAgICAgIGNvbnN0IHtjb2RlOiBvcmlnaW5hbENvZGUsIG1lc3NhZ2V9ID0gZXJyO1xuICAgICAgbGV0IGNvZGUgPSBudWxsO1xuICAgICAgc3dpdGNoIChvcmlnaW5hbENvZGUpIHtcbiAgICAgICAgY2FzZSAnRU5PVEZPVU5EJzpcbiAgICAgICAgLy8gQSBzb2NrZXQgb3BlcmF0aW9uIGZhaWxlZCBiZWNhdXNlIHRoZSBuZXR3b3JrIHdhcyBkb3duLlxuICAgICAgICBjYXNlICdFTkVURE9XTic6XG4gICAgICAgIC8vIFRoZSByYW5nZSBvZiB0aGUgdGVtcG9yYXJ5IHBvcnRzIGZvciBjb25uZWN0aW9uIGFyZSBhbGwgdGFrZW4sXG4gICAgICAgIC8vIFRoaXMgaXMgdGVtcG9yYWwgd2l0aCBtYW55IGh0dHAgcmVxdWVzdHMsIGJ1dCBzaG91bGQgYmUgY291bnRlZCBhcyBhIG5ldHdvcmsgYXdheSBldmVudC5cbiAgICAgICAgY2FzZSAnRUFERFJOT1RBVkFJTCc6XG4gICAgICAgIC8vIFRoZSBob3N0IHNlcnZlciBpcyB1bnJlYWNoYWJsZSwgY291bGQgYmUgaW4gYSBWUE4uXG4gICAgICAgIGNhc2UgJ0VIT1NUVU5SRUFDSCc6XG4gICAgICAgIC8vIEEgcmVxdWVzdCB0aW1lb3V0IGlzIGNvbnNpZGVyZWQgYSBuZXR3b3JrIGF3YXkgZXZlbnQuXG4gICAgICAgIGNhc2UgJ0VUSU1FRE9VVCc6XG4gICAgICAgICAgY29kZSA9ICdORVRXT1JLX0FXQVknO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdFQ09OTlJFRlVTRUQnOlxuICAgICAgICAgIC8vIFNlcnZlciBzaHV0IGRvd24gb3IgcG9ydCBubyBsb25nZXIgYWNjZXNzaWJsZS5cbiAgICAgICAgICBpZiAodGhpcy5faGVhcnRiZWF0Q29ubmVjdGVkT25jZSkge1xuICAgICAgICAgICAgY29kZSA9ICdTRVJWRVJfQ1JBU0hFRCc7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvZGUgPSAnUE9SVF9OT1RfQUNDRVNTSUJMRSc7XG4gICAgICAgICAgfVxuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdFQ09OTlJFU0VUJzpcbiAgICAgICAgICBjb2RlID0gJ0lOVkFMSURfQ0VSVElGSUNBVEUnO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgIGNvZGUgPSBvcmlnaW5hbENvZGU7XG4gICAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgICB0aGlzLmVtaXQoJ2hlYXJ0YmVhdC5lcnJvcicsIHtjb2RlLCBvcmlnaW5hbENvZGUsIG1lc3NhZ2V9KTtcbiAgICB9XG4gIH1cblxuICBnZXRTZXJ2ZXJVcmkoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gdGhpcy5fc2VydmVyVXJpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fY2xvc2VkID0gdHJ1ZTtcbiAgICBpZiAodGhpcy5fY29ubmVjdGVkKSB7XG4gICAgICB0aGlzLl9kaXNjb25uZWN0KCk7XG4gICAgfVxuICAgIGlmICh0aGlzLl9yZWNvbm5lY3RUaW1lcikge1xuICAgICAgY2xlYXJUaW1lb3V0KHRoaXMuX3JlY29ubmVjdFRpbWVyKTtcbiAgICB9XG4gICAgdGhpcy5fY2xlYW5XZWJTb2NrZXQoKTtcbiAgICB0aGlzLl9jYWNoZWRNZXNzYWdlcyA9IFtdO1xuICAgIHRoaXMuX3JlY29ubmVjdFRpbWUgPSBJTklUSUFMX1JFQ09OTkVDVF9USU1FX01TO1xuICAgIGlmICh0aGlzLl9oZWFydGJlYXRJbnRlcnZhbCAhPSBudWxsKSB7XG4gICAgICBjbGVhckludGVydmFsKHRoaXMuX2hlYXJ0YmVhdEludGVydmFsKTtcbiAgICB9XG4gIH1cblxuICBpc0Nvbm5lY3RlZCgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5fY29ubmVjdGVkO1xuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gTnVjbGlkZVNvY2tldDtcbiJdfQ==\n","/home/travis/build/npmtest/node-npmtest-nuclide-server/node_modules/nuclide-server/lib/utils.js":"\n/*\n * Copyright (c) 2015-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the license found in the LICENSE file in\n * the root directory of this source tree.\n */\n\nvar url = require('url');\nvar request = require('request');\nvar MAX_REQUEST_LENGTH = 1e6;\n\n/**\n * Promisified version of the request function:\n * https://www.npmjs.com/package/request#requestoptions-callback\n * Defaults to using the node's querystring module to encode the url query parameters.\n * If you want to use the npm's qs module to encode the query parameters, explicitly provide the option:\n * {useQuerystring: false}\n */\nfunction asyncRequest(options) {\n  return new Promise(function (resolve, reject) {\n    if (options.useQuerystring === undefined) {\n      options.useQuerystring = true;\n    }\n    request(options, function (error, response, body) {\n      if (error) {\n        reject(error);\n      } else if (response.statusCode < 200 || response.statusCode >= 300) {\n        var errorJson = body;\n        if (typeof body !== 'object') {\n          try {\n            errorJson = JSON.parse(body);\n          } catch (err) {\n            // 404 responses aren't currently JSON.\n            errorJson = { message: body };\n          }\n        }\n        var err = new Error(errorJson.message);\n        // Success http status codes range from 200 to 299.\n        err.code = errorJson.code || response.statusCode;\n        reject(err);\n      } else {\n        resolve({ body: body, response: response });\n      }\n    });\n  });\n}\n\n/**\n * Write a text or convert to text response with an optional status code.\n */\nfunction sendTextResponse(response, text, statusCode) {\n  if (typeof statusCode === 'number') {\n    response.statusCode = statusCode;\n  }\n  response.write(text || '');\n  response.end();\n}\n\n/**\n * Write a json response text with an optional status code.\n */\nfunction sendJsonResponse(response, json, statusCode) {\n  response.setHeader('Content-Type', 'application/json');\n  sendTextResponse(response, JSON.stringify(json), statusCode);\n}\n\n/**\n  * Parses the request body in an anyc/promise way\n  */\nfunction parseRequestBody(httpRequest, isJson) {\n  return new Promise(function (resolve, reject) {\n    var body = '';\n    httpRequest.on('data', function (data) {\n      body += data;\n      // too much POST data, kill the connection!\n      if (body.length > MAX_REQUEST_LENGTH) {\n        reject(new Error('body is too big'));\n        httpRequest.connection.destroy();\n      }\n    });\n    httpRequest.on('end', function () {\n      return resolve(isJson ? JSON.parse(body) : body);\n    });\n  });\n}\n\n/**\n * Parses the url parameters ?abc=erf&lol=432c\n */\nfunction getQueryParameters(requestUrl) {\n  var _url$parse = url.parse(requestUrl, true);\n\n  var query = _url$parse.query;\n\n  return query;\n}\n\n/**\n * Serializes the method arguments to args and argTypes arrays\n * to send the metadata about the argument types with the data\n * to help the server understand and parse it.\n */\nfunction serializeArgs(args) {\n  var argsOnHttp = [];\n  var argTypes = [];\n  args.forEach(function (arg) {\n    // I do this because nulls are normally sent as empty strings\n    if (arg === undefined) {\n      argsOnHttp.push('');\n      argTypes.push('undefined');\n    } else if (typeof arg === 'string') {\n      argsOnHttp.push(arg);\n      argTypes.push('string');\n    } else {\n      // object, number, boolean null\n      argsOnHttp.push(JSON.stringify(arg));\n      argTypes.push('object');\n    }\n  });\n  return {\n    args: argsOnHttp,\n    argTypes: argTypes\n  };\n}\n\n/**\n * Deserializes a url with query parameters: args, argTypes to an array\n * of the original arguments of the same types the client called the function with.\n */\nfunction deserializeArgs(requestUrl) {\n  var _getQueryParameters = getQueryParameters(requestUrl);\n\n  var args = _getQueryParameters.args;\n  var argTypes = _getQueryParameters.argTypes;\n\n  args = args || [];\n  argTypes = argTypes || [];\n  var argsArray = Array.isArray(args) ? args : [args];\n  var argTypesArray = Array.isArray(argTypes) ? argTypes : [argTypes];\n  return argsArray.map(function (arg, i) {\n    // I do this because nulls are normally sent as empty strings.\n    if (argTypesArray[i] === 'undefined') {\n      return undefined;\n    } else if (argTypesArray[i] === 'string') {\n      return arg;\n    } else {\n      // some methods have options object arguments.\n      return JSON.parse(arg);\n    }\n  });\n}\n\nmodule.exports = {\n  asyncRequest: asyncRequest,\n  deserializeArgs: deserializeArgs,\n  getQueryParameters: getQueryParameters,\n  parseRequestBody: parseRequestBody,\n  sendJsonResponse: sendJsonResponse,\n  sendTextResponse: sendTextResponse,\n  serializeArgs: serializeArgs\n};\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi92YXIvZm9sZGVycy94Zi9yc3BoNF9jNTczMTVyczU3eHhzZHNrcnhudjM2dDAvVC90bXBwZmw1Mm5wdWJsaXNoX3BhY2thZ2VzL25wbS9udWNsaWRlLXNlcnZlci9saWIvdXRpbHMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsV0FBVyxDQUFDOzs7Ozs7Ozs7O0FBV1osSUFBTSxHQUFHLEdBQUcsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDO0FBQzNCLElBQU0sT0FBTyxHQUFHLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FBQztBQUNuQyxJQUFNLGtCQUFrQixHQUFHLEdBQUcsQ0FBQzs7Ozs7Ozs7O0FBYS9CLFNBQVMsWUFBWSxDQUFDLE9BQVksRUFBeUI7QUFDekQsU0FBTyxJQUFJLE9BQU8sQ0FBQyxVQUFDLE9BQU8sRUFBRSxNQUFNLEVBQUs7QUFDdEMsUUFBSSxPQUFPLENBQUMsY0FBYyxLQUFLLFNBQVMsRUFBRTtBQUN4QyxhQUFPLENBQUMsY0FBYyxHQUFHLElBQUksQ0FBQztLQUMvQjtBQUNELFdBQU8sQ0FBQyxPQUFPLEVBQUUsVUFBQyxLQUFLLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBSztBQUMxQyxVQUFJLEtBQUssRUFBRTtBQUNULGNBQU0sQ0FBQyxLQUFLLENBQUMsQ0FBQztPQUNmLE1BQU0sSUFBSSxRQUFRLENBQUMsVUFBVSxHQUFHLEdBQUcsSUFBSSxRQUFRLENBQUMsVUFBVSxJQUFJLEdBQUcsRUFBRTtBQUNsRSxZQUFJLFNBQVMsR0FBRyxJQUFJLENBQUM7QUFDckIsWUFBSSxPQUFPLElBQUksS0FBSyxRQUFRLEVBQUU7QUFDNUIsY0FBSTtBQUNGLHFCQUFTLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQztXQUM5QixDQUFDLE9BQU8sR0FBRyxFQUFFOztBQUVaLHFCQUFTLEdBQUcsRUFBQyxPQUFPLEVBQUUsSUFBSSxFQUFDLENBQUM7V0FDN0I7U0FDRjtBQUNELFlBQU0sR0FBRyxHQUFHLElB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O0FBQ2hCLGVBQWEsRUFBYixhQUFhO0NBQ2QsQ0FBQyIsImZpbGUiOiIvdmFyL2ZvbGRlcnMveGYvcnNwaDRfYzU3MzE1cnM1N3h4c2Rza3J4bnYzNnQwL1QvdG1wcGZsNTJucHVibGlzaF9wYWNrYWdlcy9ucG0vbnVjbGlkZS1zZXJ2ZXIvbGliL3V0aWxzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBiYWJlbCc7XG4vKiBAZmxvdyAqL1xuXG4vKlxuICogQ29weXJpZ2h0IChjKSAyMDE1LXByZXNlbnQsIEZhY2Vib29rLCBJbmMuXG4gKiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIGxpY2Vuc2UgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpblxuICogdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKi9cblxuY29uc3QgdXJsID0gcmVxdWlyZSgndXJsJyk7XG5jb25zdCByZXF1ZXN0ID0gcmVxdWlyZSgncmVxdWVzdCcpO1xuY29uc3QgTUFYX1JFUVVFU1RfTEVOR1RIID0gMWU2O1xuXG50eXBlIFJlc3BvbnNlQm9keSA9IHtib2R5OiBzdHJpbmc7IHJlc3BvbnNlOiBIdHRwUmVzcG9uc2V9O1xudHlwZSBRdWVyeVBhcmFtcyA9IHtba2V5OnN0cmluZ106IGFueX07XG50eXBlIFNlcmlhbGl6ZWRBcmd1bWVudHMgPSB7YXJnczogQXJyYXk8c3RyaW5nPjsgYXJnVHlwZXM6IEFycmF5PHN0cmluZz59O1xuXG4vKipcbiAqIFByb21pc2lmaWVkIHZlcnNpb24gb2YgdGhlIHJlcXVlc3QgZnVuY3Rpb246XG4gKiBodHRwczovL3d3dy5ucG1qcy5jb20vcGFja2FnZS9yZXF1ZXN0I3JlcXVlc3RvcHRpb25zLWNhbGxiYWNrXG4gKiBEZWZhdWx0cyB0byB1c2luZyB0aGUgbm9kZSdzIHF1ZXJ5c3RyaW5nIG1vZHVsZSB0byBlbmNvZGUgdGhlIHVybCBxdWVyeSBwYXJhbWV0ZXJzLlxuICogSWYgeW91IHdhbnQgdG8gdXNlIHRoZSBucG0ncyBxcyBtb2R1bGUgdG8gZW5jb2RlIHRoZSBxdWVyeSBwYXJhbWV0ZXJzLCBleHBsaWNpdGx5IHByb3ZpZGUgdGhlIG9wdGlvbjpcbiAqIHt1c2VRdWVyeXN0cmluZzogZmFsc2V9XG4gKi9cbmZ1bmN0aW9uIGFzeW5jUmVxdWVzdChvcHRpb25zOiBhbnkpOiBQcm9taXNlPFJlc3BvbnNlQm9keT4ge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIGlmIChvcHRpb25zLnVzZVF1ZXJ5c3RyaW5nID09PSB1bmRlZmluZWQpIHtcbiAgICAgIG9wdGlvbnMudXNlUXVlcnlzdHJpbmcgPSB0cnVlO1xuICAgIH1cbiAgICByZXF1ZXN0KG9wdGlvbnMsIChlcnJvciwgcmVzcG9uc2UsIGJvZHkpID0+IHtcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgfSBlbHNlIGlmIChyZXNwb25zZS5zdGF0dXNDb2RlIDwgMjAwIHx8IHJlc3BvbnNlLnN0YXR1c0NvZGUgPj0gMzAwKSB7XG4gICAgICAgIGxldCBlcnJvckpzb24gPSBib2R5O1xuICAgICAgICBpZiAodHlwZW9mIGJvZHkgIT09ICdvYmplY3QnKSB7XG4gICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGVycm9ySnNvbiA9IEpTT04ucGFyc2UoYm9keSk7XG4gICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAvLyA0MDQgcmVzcG9uc2VzIGFyZW4ndCBjdXJyZW50bHkgSlNPTi5cbiAgICAgICAgICAgIGVycm9ySnNvbiA9IHttZXNzYWdlOiBib2R5fTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZXJyID0gbmV3IEVycm9yKGVycm9ySnNvbi5tZXNzYWdlKTtcbiAgICAgICAgLy8gU3VjY2VzcyBodHRwIHN0YXR1cyBjb2RlcyByYW5nZSBmcm9tIDIwMCB0byAyOTkuXG4gICAgICAgIGVyci5jb2RlID0gZXJyb3JKc29uLmNvZGUgfHwgcmVzcG9uc2Uuc3RhdHVzQ29kZTtcbiAgICAgICAgcmVqZWN0KGVycik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXNvbHZlKHtib2R5LCByZXNwb25zZX0pO1xuICAgICAgfVxuICAgIH0pO1xuICB9KTtcbn1cblxuLyoqXG4gKiBXcml0ZSBhIHRleHQgb3IgY29udmVydCB0byB0ZXh0IHJlc3BvbnNlIHdpdGggYW4gb3B0aW9uYWwgc3RhdHVzIGNvZGUuXG4gKi9cbmZ1bmN0aW9uIHNlbmRUZXh0UmVzcG9uc2UocmVzcG9uc2U6IGh0dHAuU2VydmVyUmVzcG9uc2UsIHRleHQ6IGFueSwgc3RhdHVzQ29kZTogP251bWJlcik6IHZvaWQge1xuICBpZiAodHlwZW9mIHN0YXR1c0NvZGUgPT09ICdudW1iZXInKSB7XG4gICAgcmVzcG9uc2Uuc3RhdHVzQ29kZSA9IHN0YXR1c0NvZGU7XG4gIH1cbiAgcmVzcG9uc2Uud3JpdGUodGV4dCB8fCAnJyk7XG4gIHJlc3BvbnNlLmVuZCgpO1xufVxuXG4vKipcbiAqIFdyaXRlIGEganNvbiByZXNwb25zZSB0ZXh0IHdpdGggYW4gb3B0aW9uYWwgc3RhdHVzIGNvZGUuXG4gKi9cbmZ1bmN0aW9uIHNlbmRKc29uUmVzcG9uc2UocmVzcG9uc2U6IGh0dHAuU2VydmVyUmVzcG9uc2UsIGpzb246IGFueSwgc3RhdHVzQ29kZTogP251bWJlcik6IHZvaWQge1xuICByZXNwb25zZS5zZXRIZWFkZXIoJ0NvbnRlbnQtVHlwZScsICdhcHBsaWNhdGlvbi9qc29uJyk7XG4gIHNlbmRUZXh0UmVzcG9uc2UocmVzcG9uc2UsIEpTT04uc3RyaW5naWZ5KGpzb24pLCBzdGF0dXNDb2RlKTtcbn1cblxuLyoqXG4gICogUGFyc2VzIHRoZSByZXF1ZXN0IGJvZHkgaW4gYW4gYW55Yy9wcm9taXNlIHdheVxuICAqL1xuZnVuY3Rpb24gcGFyc2VSZXF1ZXN0Qm9keShodHRwUmVxdWVzdDogaHR0cC5JbmNvbWluZ01lc3NhZ2UsIGlzSnNvbjogP2Jvb2xlYW4pOiBQcm9taXNlPHN0cmluZz4ge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIGxldCBib2R5ID0gJyc7XG4gICAgaHR0cFJlcXVlc3Qub24oJ2RhdGEnLCAoZGF0YSkgPT4ge1xuICAgICAgYm9keSArPSBkYXRhO1xuICAgICAgLy8gdG9vIG11Y2ggUE9TVCBkYXRhLCBraWxsIHRoZSBjb25uZWN0aW9uIVxuICAgICAgaWYgKGJvZHkubGVuZ3RoID4gTUFYX1JFUVVFU1RfTEVOR1RIKSB7XG4gICAgICAgIHJlamVjdChuZXcgRXJyb3IoJ2JvZHkgaXMgdG9vIGJpZycpKTtcbiAgICAgICAgaHR0cFJlcXVlc3QuY29ubmVjdGlvbi5kZXN0cm95KCk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgaHR0cFJlcXVlc3Qub24oJ2VuZCcsICgpID0+IHJlc29sdmUoaXNKc29uID8gSlNPTi5wYXJzZShib2R5KSA6IGJvZHkpKTtcbiAgfSk7XG59XG5cbi8qKlxuICogUGFyc2VzIHRoZSB1cmwgcGFyYW1ldGVycyA/YWJjPWVyZiZsb2w9NDMyY1xuICovXG5mdW5jdGlvbiBnZXRRdWVyeVBhcmFtZXRlcnMocmVxdWVzdFVybCk6IFF1ZXJ5UGFyYW1zIHtcbiAgY29uc3Qge3F1ZXJ5fSA9IHVybC5wYXJzZShyZXF1ZXN0VXJsLCB0cnVlKTtcbiAgcmV0dXJuIHF1ZXJ5O1xufVxuXG4vKipcbiAqIFNlcmlhbGl6ZXMgdGhlIG1ldGhvZCBhcmd1bWVudHMgdG8gYXJncyBhbmQgYXJnVHlwZXMgYXJyYXlzXG4gKiB0byBzZW5kIHRoZSBtZXRhZGF0YSBhYm91dCB0aGUgYXJndW1lbnQgdHlwZXMgd2l0aCB0aGUgZGF0YVxuICogdG8gaGVscCB0aGUgc2VydmVyIHVuZGVyc3RhbmQgYW5kIHBhcnNlIGl0LlxuICovXG5mdW5jdGlvbiBzZXJpYWxpemVBcmdzKGFyZ3M6IEFycmF5PGFueT4pOiBTZXJpYWxpemVkQXJndW1lbnRzIHtcbiAgY29uc3QgYXJnc09uSHR0cCA9IFtdO1xuICBjb25zdCBhcmdUeXBlcyA9IFtdO1xuICBhcmdzLmZvckVhY2goZnVuY3Rpb24oYXJnKSB7XG4gICAgLy8gSSBkbyB0aGlzIGJlY2F1c2UgbnVsbHMgYXJlIG5vcm1hbGx5IHNlbnQgYXMgZW1wdHkgc3RyaW5nc1xuICAgIGlmIChhcmcgPT09IHVuZGVmaW5lZCkge1xuICAgICAgYXJnc09uSHR0cC5wdXNoKCcnKTtcbiAgICAgIGFyZ1R5cGVzLnB1c2goJ3VuZGVmaW5lZCcpO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGFyZyA9PT0gJ3N0cmluZycpIHtcbiAgICAgIGFyZ3NPbkh0dHAucHVzaChhcmcpO1xuICAgICAgYXJnVHlwZXMucHVzaCgnc3RyaW5nJyk7XG4gICAgfSBlbHNlIHsgLy8gb2JqZWN0LCBudW1iZXIsIGJvb2xlYW4gbnVsbFxuICAgICAgYXJnc09uSHR0cC5wdXNoKEpTT04uc3RyaW5naWZ5KGFyZykpO1xuICAgICAgYXJnVHlwZXMucHVzaCgnb2JqZWN0Jyk7XG4gICAgfVxuICB9KTtcbiAgcmV0dXJuIHtcbiAgICBhcmdzOiBhcmdzT25IdHRwLFxuICAgIGFyZ1R5cGVzLFxuICB9O1xufVxuXG4vKipcbiAqIERlc2VyaWFsaXplcyBhIHVybCB3aXRoIHF1ZXJ5IHBhcmFtZXRlcnM6IGFyZ3MsIGFyZ1R5cGVzIHRvIGFuIGFycmF5XG4gKiBvZiB0aGUgb3JpZ2luYWwgYXJndW1lbnRzIG9mIHRoZSBzYW1lIHR5cGVzIHRoZSBjbGllbnQgY2FsbGVkIHRoZSBmdW5jdGlvbiB3aXRoLlxuICovXG5mdW5jdGlvbiBkZXNlcmlhbGl6ZUFyZ3MocmVxdWVzdFVybDogc3RyaW5nKTogQXJyYXk8YW55PiB7XG4gIGxldCB7YXJncywgYXJnVHlwZXN9ID0gZ2V0UXVlcnlQYXJhbWV0ZXJzKHJlcXVlc3RVcmwpO1xuICBhcmdzID0gYXJncyB8fCBbXTtcbiAgYXJnVHlwZXMgPSBhcmdUeXBlcyB8fCBbXTtcbiAgY29uc3QgYXJnc0FycmF5ID0gQXJyYXkuaXNBcnJheShhcmdzKSA/IGFyZ3MgOiBbYXJnc107XG4gIGNvbnN0IGFyZ1R5cGVzQXJyYXkgPSBBcnJheS5pc0FycmF5KGFyZ1R5cGVzKSA/IGFyZ1R5cGVzIDogW2FyZ1R5cGVzXTtcbiAgcmV0dXJuIGFyZ3NBcnJheS5tYXAoZnVuY3Rpb24oYXJnLCBpKSB7XG4gICAgLy8gSSBkbyB0aGlzIGJlY2F1c2UgbnVsbHMgYXJlIG5vcm1hbGx5IHNlbnQgYXMgZW1wdHkgc3RyaW5ncy5cbiAgICBpZiAoYXJnVHlwZXNBcnJheVtpXSA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfSBlbHNlIGlmIChhcmdUeXBlc0FycmF5W2ldID09PSAnc3RyaW5nJykge1xuICAgICAgcmV0dXJuIGFyZztcbiAgICB9IGVsc2Uge1xuICAgICAgLy8gc29tZSBtZXRob2RzIGhhdmUgb3B0aW9ucyBvYmplY3QgYXJndW1lbnRzLlxuICAgICAgcmV0dXJuIEpTT04ucGFyc2UoYXJnKTtcbiAgICB9XG4gIH0pO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgYXN5bmNSZXF1ZXN0LFxuICBkZXNlcmlhbGl6ZUFyZ3MsXG4gIGdldFF1ZXJ5UGFyYW1ldGVycyxcbiAgcGFyc2VSZXF1ZXN0Qm9keSxcbiAgc2VuZEpzb25SZXNwb25zZSxcbiAgc2VuZFRleHRSZXNwb25zZSxcbiAgc2VyaWFsaXplQXJncyxcbn07XG4iXX0=\n","/home/travis/build/npmtest/node-npmtest-nuclide-server/node_modules/nuclide-server/lib/service-manager.js":"\n/*\n * Copyright (c) 2015-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the license found in the LICENSE file in\n * the root directory of this source tree.\n */\n\nvar logger = require('nuclide-logging').getLogger();\n\n// A cache stores services in form of '$serviceName@$cwd' => $serviceObject.\nvar cachedServices = new Map();\n\nfunction optionsToString(options) {\n  if (!options) {\n    return '';\n  } else if (options instanceof Array) {\n    return '[' + options.map(function (item) {\n      return optionsToString(item);\n    }).join(', ') + ']';\n  } else if (options instanceof Object) {\n    var keys = Object.keys(options).sort();\n    return '{' + keys.map(function (key) {\n      return key + ': ' + optionsToString(options[key]);\n    }).join(', ') + '}';\n  } else if (typeof options === 'number' || typeof options === 'boolean' || typeof options === 'string') {\n    return JSON.stringify(options);\n  } else {\n    throw Error('Can\\'t stringify %o', options);\n  }\n}\n\n/**\n * Create a new or retrieve a cached service instance by serviceName and service options.\n */\nfunction getService(serviceName, options, localImplementationClassPath) {\n  var key = serviceName + '@' + optionsToString(options);\n  if (!cachedServices.has(key)) {\n    logger.debug('Create service instance: ' + key);\n    var serviceInstance = createLocalService(serviceName, localImplementationClassPath, options);\n    cachedServices.set(key, serviceInstance);\n  }\n  return cachedServices.get(key);\n}\n\nfunction createLocalService(serviceName, localImplementationClassPath, options) {\n  var serviceModule = require(localImplementationClassPath);\n  var serviceClass = serviceModule[serviceName] || serviceModule;\n  return new serviceClass(options);\n}\n\nfunction getRemoteEventName(serviceName, eventMethodName, serviceOptions) {\n  return getLocalEventName(serviceName, eventMethodName) + '@' + optionsToString(serviceOptions);\n}\n\nfunction getLocalEventName(serviceName, eventMethodName) {\n  return serviceName + '/' + eventMethodName;\n}\n\nmodule.exports = {\n  getService: getService,\n  getRemoteEventName: getRemoteEventName,\n  optionsToString: optionsToString\n};\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi92YXIvZm9sZGVycy94Zi9yc3BoNF9jNTczMTVyczU3eHhzZHNrcnhudjM2dDAvVC90bXBwZmw1Mm5wdWJsaXNoX3BhY2thZ2VzL25wbS9udWNsaWRlLXNlcnZlci9saWIvc2VydmljZS1tYW5hZ2VyLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLFdBQVcsQ0FBQzs7Ozs7Ozs7OztBQVdaLElBQU0sTUFBTSxHQUFHLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQyxDQUFDLFNBQVMsRUFBRSxDQUFDOzs7QUFHdEQsSUFBTSxjQUFnQyxHQUFHLElBQUksR0FBRyxFQUFFLENBQUM7O0FBRW5ELFNBQVMsZUFBZSxDQUFDLE9BQWEsRUFBVTtBQUM5QyxNQUFJLENBQUMsT0FBTyxFQUFFO0FBQ1osV0FBTyxFQUFFLENBQUM7R0FDWCxNQUFNLElBQUksT0FBTyxZQUFZLEtBQUssRUFBRTtBQUNuQyxXQUFPLEdBQUcsR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLFVBQUEsSUFBSTthQUFJLGVBQWUsQ0FBQyxJQUFJLENBQUM7S0FBQSxDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLEdBQUcsQ0FBQztHQUMxRSxNQUFNLElBQUksT0FBTyxZQUFZLE1BQU0sRUFBRTtBQUNwQyxRQUFNLElBQUksR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksRUFBRSxDQUFDO0FBQ3pDLFdBQU8sR0FBRyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsVUFBQSxHQUFHO2FBQUksR0FBRyxHQUFHLElBQUksR0FBRyxlQUFlLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxDQUFDO0tBQUEsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxHQUFHLENBQUM7R0FDM0YsTUFBTSxJQUFJLE9BQU8sT0FBTyxLQUFLLFFBQVEsSUFBSSxPQUFPLE9BQU8sS0FBSyxTQUFTLElBQUksT0FBTyxPQUFPLEtBQUssUUFBUSxFQUFFO0FBQ3JHLFdBQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQyxPQUFPLENBQUMsQ0FBQztHQUNoQyxNQUFNO0FBQ0wsVUFBTSxLQUFLLENBQUMscUJBQXFCLEVBQUUsT0FBTyxDQUFDLENBQUM7R0FDN0M7Q0FDRjs7Ozs7QUFLRCxTQUFTLFVBQVUsQ0FBQyxXQUFtQixFQUFFLE9BQVksRUFBRSw0QkFBb0MsRUFBTztBQUNoRyxNQUFNLEdBQUcsR0FBRyxXQUFXLEdBQUcsR0FBRyxHQUFHLGVBQWUsQ0FBQyxPQUFPLENBQUMsQ0FBQztBQUN6RCxNQUFJLENBQUMsY0FBYyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsRUFBRTtBQUM1QixVQUFNLENBQUMsS0FBSywrQkFBNkIsR0FBRyxDQUFHLENBQUM7QUFDaEQsUUFBTSxlQUFlLEdBQUcsa0JBQWtCLENBQUMsV0FBVyxFQUFFLDRCQUE0QixFQUFFLE9BQU8sQ0FBQyxDQUFDO0FBQy9GLGtCQUFjLENBQUMsR0FBRyxDQUFDLEdBQUcsRUFBRSxlQUFlLENBQUMsQ0FBQztHQUMxQztBQUNELFNBQU8sY0FBYyxDQUFDLEdBQUcsQ0FBQyxHQUFHLENBQUMsQ0FBQztDQUNoQzs7QUFFRCxTQUFTLGtCQUFrQixDQUFDLFdBQW1CLEVBQUUsNEJBQW9DLEVBQUUsT0FBWSxFQUFPO0FBQ3hHLE1BQU0sYUFBYSxHQUFHLE9BQU8sQ0FBQyw0QkFBNEIsQ0FBQyxDQUFDO0FBQzVELE1BQU0sWUFBWSxHQUFHLGFBQWEsQ0FBQyxXQUFXLENBQUMsSUFBSSxhQUFhLENBQUM7QUFDakUsU0FBTyxJQUFJLFlBQVksQ0FBQyxPQUFPLENBQUMsQ0FBQztDQUNsQzs7QUFFRCxTQUFTLGtCQUFrQixDQUFDLFdBQW1CLEVBQUUsZUFBdUIsRUFBRSxjQUFtQixFQUFVO0FBQ3JHLFNBQU8saUJBQWlCLENBQUMsV0FBVyxFQUFFLGVBQWUsQ0FBQyxHQUFHLEdBQUcsR0FBRyxlQUFlLENBQUMsY0FBYyxDQUFDLENBQUM7Q0FDaEc7O0FBRUQsU0FBUyxpQkFBaUIsQ0FBQyxXQUFtQixFQUFFLGVBQXVCLEVBQVU7QUFDL0UsU0FBTyxXQUFXLEdBQUcsR0FBRyxHQUFHLGVBQWUsQ0FBQztDQUM1Qzs7QUFFRCxNQUFNLENBQUMsT0FBTyxHQUFHO0FBQ2YsWUFBVSxFQUFWLFVBQVU7QUFDVixvQkFBa0IsRUFBbEIsa0JBQWtCO0FBQ2xCLGlCQUFlLEVBQWYsZUFBZTtDQUNoQixDQUFDIiwiZmlsZSI6Ii92YXIvZm9sZGVycy94Zi9yc3BoNF9jNTczMTVyczU3eHhzZHNrcnhudjM2dDAvVC90bXBwZmw1Mm5wdWJsaXNoX3BhY2thZ2VzL25wbS9udWNsaWRlLXNlcnZlci9saWIvc2VydmljZS1tYW5hZ2VyLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBiYWJlbCc7XG4vKiBAZmxvdyAqL1xuXG4vKlxuICogQ29weXJpZ2h0IChjKSAyMDE1LXByZXNlbnQsIEZhY2Vib29rLCBJbmMuXG4gKiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIGxpY2Vuc2UgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpblxuICogdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKi9cblxuY29uc3QgbG9nZ2VyID0gcmVxdWlyZSgnbnVjbGlkZS1sb2dnaW5nJykuZ2V0TG9nZ2VyKCk7XG5cbi8vIEEgY2FjaGUgc3RvcmVzIHNlcnZpY2VzIGluIGZvcm0gb2YgJyRzZXJ2aWNlTmFtZUAkY3dkJyA9PiAkc2VydmljZU9iamVjdC5cbmNvbnN0IGNhY2hlZFNlcnZpY2VzOiBNYXA8c3RyaW5nLCBhbnk+ID0gbmV3IE1hcCgpO1xuXG5mdW5jdGlvbiBvcHRpb25zVG9TdHJpbmcob3B0aW9uczogP2FueSk6IHN0cmluZyB7XG4gIGlmICghb3B0aW9ucykge1xuICAgIHJldHVybiAnJztcbiAgfSBlbHNlIGlmIChvcHRpb25zIGluc3RhbmNlb2YgQXJyYXkpIHtcbiAgICByZXR1cm4gJ1snICsgb3B0aW9ucy5tYXAoaXRlbSA9PiBvcHRpb25zVG9TdHJpbmcoaXRlbSkpLmpvaW4oJywgJykgKyAnXSc7XG4gIH0gZWxzZSBpZiAob3B0aW9ucyBpbnN0YW5jZW9mIE9iamVjdCkge1xuICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhvcHRpb25zKS5zb3J0KCk7XG4gICAgcmV0dXJuICd7JyArIGtleXMubWFwKGtleSA9PiBrZXkgKyAnOiAnICsgb3B0aW9uc1RvU3RyaW5nKG9wdGlvbnNba2V5XSkpLmpvaW4oJywgJykgKyAnfSc7XG4gIH0gZWxzZSBpZiAodHlwZW9mIG9wdGlvbnMgPT09ICdudW1iZXInIHx8IHR5cGVvZiBvcHRpb25zID09PSAnYm9vbGVhbicgfHwgdHlwZW9mIG9wdGlvbnMgPT09ICdzdHJpbmcnKSB7XG4gICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KG9wdGlvbnMpO1xuICB9IGVsc2Uge1xuICAgIHRocm93IEVycm9yKCdDYW5cXCd0IHN0cmluZ2lmeSAlbycsIG9wdGlvbnMpO1xuICB9XG59XG5cbi8qKlxuICogQ3JlYXRlIGEgbmV3IG9yIHJldHJpZXZlIGEgY2FjaGVkIHNlcnZpY2UgaW5zdGFuY2UgYnkgc2VydmljZU5hbWUgYW5kIHNlcnZpY2Ugb3B0aW9ucy5cbiAqL1xuZnVuY3Rpb24gZ2V0U2VydmljZShzZXJ2aWNlTmFtZTogc3RyaW5nLCBvcHRpb25zOiBhbnksIGxvY2FsSW1wbGVtZW50YXRpb25DbGFzc1BhdGg6IHN0cmluZyk6IGFueSB7XG4gIGNvbnN0IGtleSA9IHNlcnZpY2VOYW1lICsgJ0AnICsgb3B0aW9uc1RvU3RyaW5nKG9wdGlvbnMpO1xuICBpZiAoIWNhY2hlZFNlcnZpY2VzLmhhcyhrZXkpKSB7XG4gICAgbG9nZ2VyLmRlYnVnKGBDcmVhdGUgc2VydmljZSBpbnN0YW5jZTogJHtrZXl9YCk7XG4gICAgY29uc3Qgc2VydmljZUluc3RhbmNlID0gY3JlYXRlTG9jYWxTZXJ2aWNlKHNlcnZpY2VOYW1lLCBsb2NhbEltcGxlbWVudGF0aW9uQ2xhc3NQYXRoLCBvcHRpb25zKTtcbiAgICBjYWNoZWRTZXJ2aWNlcy5zZXQoa2V5LCBzZXJ2aWNlSW5zdGFuY2UpO1xuICB9XG4gIHJldHVybiBjYWNoZWRTZXJ2aWNlcy5nZXQoa2V5KTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlTG9jYWxTZXJ2aWNlKHNlcnZpY2VOYW1lOiBzdHJpbmcsIGxvY2FsSW1wbGVtZW50YXRpb25DbGFzc1BhdGg6IHN0cmluZywgb3B0aW9uczogYW55KTogYW55IHtcbiAgY29uc3Qgc2VydmljZU1vZHVsZSA9IHJlcXVpcmUobG9jYWxJbXBsZW1lbnRhdGlvbkNsYXNzUGF0aCk7XG4gIGNvbnN0IHNlcnZpY2VDbGFzcyA9IHNlcnZpY2VNb2R1bGVbc2VydmljZU5hbWVdIHx8IHNlcnZpY2VNb2R1bGU7XG4gIHJldHVybiBuZXcgc2VydmljZUNsYXNzKG9wdGlvbnMpO1xufVxuXG5mdW5jdGlvbiBnZXRSZW1vdGVFdmVudE5hbWUoc2VydmljZU5hbWU6IHN0cmluZywgZXZlbnRNZXRob2ROYW1lOiBzdHJpbmcsIHNlcnZpY2VPcHRpb25zOiBhbnkpOiBzdHJpbmcge1xuICByZXR1cm4gZ2V0TG9jYWxFdmVudE5hbWUoc2VydmljZU5hbWUsIGV2ZW50TWV0aG9kTmFtZSkgKyAnQCcgKyBvcHRpb25zVG9TdHJpbmcoc2VydmljZU9wdGlvbnMpO1xufVxuXG5mdW5jdGlvbiBnZXRMb2NhbEV2ZW50TmFtZShzZXJ2aWNlTmFtZTogc3RyaW5nLCBldmVudE1ldGhvZE5hbWU6IHN0cmluZyk6IHN0cmluZyB7XG4gIHJldHVybiBzZXJ2aWNlTmFtZSArICcvJyArIGV2ZW50TWV0aG9kTmFtZTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSB7XG4gIGdldFNlcnZpY2UsXG4gIGdldFJlbW90ZUV2ZW50TmFtZSxcbiAgb3B0aW9uc1RvU3RyaW5nLFxufTtcbiJdfQ==\n","/home/travis/build/npmtest/node-npmtest-nuclide-server/node_modules/nuclide-server/lib/services/NuclideSearchService.js":"\n/*\n * Copyright (c) 2015-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the license found in the LICENSE file in\n * the root directory of this source tree.\n */\n\n// TODO (mikeo): Make this another search provider\n\nvar doSearchDirectory = _asyncToGenerator(function* (directoryUri, query) {\n  var search = fileSearchers[directoryUri];\n  if (search === undefined) {\n    var directory = remoteUri.parse(directoryUri).path;\n\n    var exists = yield fsPromise.exists(directory);\n    if (!exists) {\n      throw new Error('Could not find directory to search : ' + directory);\n    }\n\n    var stat = yield fsPromise.stat(directory);\n    if (!stat.isDirectory()) {\n      throw new Error('Provided path is not a directory : ' + directory);\n    }\n\n    search = yield fileSearchForDirectory(directoryUri);\n    fileSearchers[directoryUri] = search;\n  }\n\n  return yield search.query(query);\n});\n\nvar getSearchProviders = _asyncToGenerator(function* (cwd) {\n  var checkAvailability = _asyncToGenerator(function* (providerName) {\n    var isAvailable = yield providers[providerName].isAvailable(cwd);\n    return isAvailable ? { name: providerName } : null;\n  });\n\n  var validPromises = [];\n\n  for (var _name in providers) {\n    validPromises.push(checkAvailability(_name));\n  }\n\n  var results = yield Promise.all(validPromises);\n  return results.filter(function (provider) {\n    return !!provider;\n  });\n});\n\nvar doSearchQuery = _asyncToGenerator(function* (cwd, provider, query) {\n  var currentProvider = providers[provider];\n  if (!currentProvider) {\n    throw new Error('Invalid provider: ' + provider);\n  }\n  var results = yield currentProvider.query(cwd, query);\n  return { results: results };\n});\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { var callNext = step.bind(null, 'next'); var callThrow = step.bind(null, 'throw'); function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(callNext, callThrow); } } callNext(); }); }; }\n\nvar _require = require('nuclide-commons');\n\nvar fsPromise = _require.fsPromise;\n\nvar _require2 = require('nuclide-path-search');\n\nvar fileSearchForDirectory = _require2.fileSearchForDirectory;\n\nvar remoteUri = require('nuclide-remote-uri');\n\nvar providers = undefined;\n\n/*\n * TODO(williamsc): This needs to have some better\n *                  managment tools (Adding/removing query sets).\n */\n\n// Cache of previously indexed folders for later use.\nvar fileSearchers = Object.create(null);\n\nfunction addProvider(name, provider) {\n  providers = providers || {};\n  if (providers[name]) {\n    throw new Error(name + ' has already been added as a provider.');\n  }\n  providers[name] = provider;\n}\n\nfunction clearProviders() {\n  providers = undefined;\n}\n\nfunction initialize(server) {}\n\nfunction shutdown(server) {\n  clearProviders();\n  for (var k in fileSearchers) {\n    fileSearchers[k].dispose();\n  }\n  fileSearchers = Object.create(null);\n}\n\nmodule.exports = {\n  initialize: initialize,\n  shutdown: shutdown,\n  addProvider: addProvider,\n  clearProviders: clearProviders,\n  services: {\n    '/search/query': { handler: doSearchQuery, method: 'post' },\n    '/search/listProviders': { handler: getSearchProviders, method: 'post' },\n    '/search/directory': { handler: doSearchDirectory }\n  }\n};\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi92YXIvZm9sZGVycy94Zi9yc3BoNF9jNTczMTVyczU3eHhzZHNrcnhudjM2dDAvVC90bXBwZmw1Mm5wdWJsaXNoX3BhY2thZ2VzL25wbS9udWNsaWRlLXNlcnZlci9saWIvc2VydmljZXMvTnVjbGlkZVNlYXJjaFNlcnZpY2UuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsV0FBVyxDQUFDOzs7Ozs7Ozs7Ozs7SUFrREcsaUJBQWlCLHFCQUFoQyxXQUFpQyxZQUFvQixFQUFFLEtBQWEsRUFBb0M7QUFDdEcsTUFBSSxNQUFNLEdBQUcsYUFBYSxDQUFDLFlBQVksQ0FBQyxDQUFDO0FBQ3pDLE1BQUksTUFBTSxLQUFLLFNBQVMsRUFBRTtBQUN4QixRQUFNLFNBQVMsR0FBRyxTQUFTLENBQUMsS0FBSyxDQUFDLFlBQVksQ0FBQyxDQUFDLElBQUksQ0FBQzs7QUFFckQsUUFBTSxNQUFNLEdBQUcsTUFBTSxTQUFTLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBQ2pELFFBQUksQ0FBQyxNQUFNLEVBQUU7QUFDWCxZQUFNLElBQUksS0FBSyxDQUFDLHVDQUF1QyxHQUFHLFNBQVMsQ0FBQyxDQUFDO0tBQ3RFOztBQUVELFFBQU0sSUFBSSxHQUFHLE1BQU0sU0FBUyxDQUFDLElBQUksQ0FBQyxTQUFTLENBQUMsQ0FBQztBQUM3QyxRQUFJLENBQUMsSUFBSSxDQUFDLFdBQVcsRUFBRSxFQUFFO0FBQ3ZCLFlBQU0sSUFBSSxLQUFLLENBQUMscUNBQXFDLEdBQUcsU0FBUyxDQUFDLENBQUM7S0FDcEU7O0FBRUQsVUFBTSxHQUFHLE1BQU0sc0JBQXNCLENBQUMsWUFBWSxDQUFDLENBQUM7QUFDcEQsaUJBQWEsQ0FBQyxZQUFZLENBQUMsR0FBRyxNQUFNLENBQUM7R0FDdEM7O0FBRUQsU0FBTyxNQUFNLE1BQU0sQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUM7Q0FDbEM7O0lBRWMsa0JBQWtCLHFCQUFqQyxXQUFrQyxHQUFXLEVBQWdDO01BRzVE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IiwiZmlsZSI6Ii92YXIvZm9sZGVycy94Zi9yc3BoNF9jNTczMTVyczU3eHhzZHNrcnhudjM2dDAvVC90bXBwZmw1Mm5wdWJsaXNoX3BhY2thZ2VzL25wbS9udWNsaWRlLXNlcnZlci9saWIvc2VydmljZXMvTnVjbGlkZVNlYXJjaFNlcnZpY2UuanMiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIGJhYmVsJztcbi8qIEBmbG93ICovXG5cbi8qXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTUtcHJlc2VudCwgRmFjZWJvb2ssIEluYy5cbiAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKlxuICogVGhpcyBzb3VyY2UgY29kZSBpcyBsaWNlbnNlZCB1bmRlciB0aGUgbGljZW5zZSBmb3VuZCBpbiB0aGUgTElDRU5TRSBmaWxlIGluXG4gKiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqL1xuXG50eXBlIFNlYXJjaFF1ZXJ5ID0ge1xuICBwcm92aWRlcjogc3RyaW5nO1xuICBxdWVyeTogc3RyaW5nO1xufVxuXG50eXBlIFByb3ZpZGVySW5mbyA9IHtcbiAgbmFtZTogc3RyaW5nO1xufVxuXG50eXBlIFNlYXJjaFF1ZXJ5UmVzdWx0ID0ge1xuICBsaW5lOiBudW1iZXI7XG4gIGNvbHVtbjogbnVtYmVyO1xuICBuYW1lOiBzdHJpbmc7XG4gIHBhdGg6IHN0cmluZztcbiAgbGVuZ3RoOiBudW1iZXI7XG4gIHNjb3BlOiBzdHJpbmc7XG4gIGFkZGl0aW9uYWxJbmZvOiBzdHJpbmc7XG4gIGFjdGlvbjogc3RyaW5nO1xufVxuXG50eXBlIFNlYXJjaFJlc3BvbnNlID0ge1xuICByZXN1bHRzOiBBcnJheTxTZWFyY2hRdWVyeVJlc3VsdD47XG59XG5cbmNvbnN0IHtmc1Byb21pc2V9ID0gcmVxdWlyZSgnbnVjbGlkZS1jb21tb25zJyk7XG5jb25zdCB7ZmlsZVNlYXJjaEZvckRpcmVjdG9yeX0gPSByZXF1aXJlKCdudWNsaWRlLXBhdGgtc2VhcmNoJyk7XG5jb25zdCByZW1vdGVVcmkgPSByZXF1aXJlKCdudWNsaWRlLXJlbW90ZS11cmknKTtcblxubGV0IHByb3ZpZGVycztcblxuLypcbiAqIFRPRE8od2lsbGlhbXNjKTogVGhpcyBuZWVkcyB0byBoYXZlIHNvbWUgYmV0dGVyXG4gKiAgICAgICAgICAgICAgICAgIG1hbmFnbWVudCB0b29scyAoQWRkaW5nL3JlbW92aW5nIHF1ZXJ5IHNldHMpLlxuICovXG5cbi8vIENhY2hlIG9mIHByZXZpb3VzbHkgaW5kZXhlZCBmb2xkZXJzIGZvciBsYXRlciB1c2UuXG5sZXQgZmlsZVNlYXJjaGVyczogYW55ID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcblxuLy8gVE9ETyAobWlrZW8pOiBNYWtlIHRoaXMgYW5vdGhlciBzZWFyY2ggcHJvdmlkZXJcbmFzeW5jIGZ1bmN0aW9uIGRvU2VhcmNoRGlyZWN0b3J5KGRpcmVjdG9yeVVyaTogc3RyaW5nLCBxdWVyeTogc3RyaW5nKTogUHJvbWlzZTxBcnJheTxGaWxlU2VhcmNoUmVzdWx0Pj4ge1xuICBsZXQgc2VhcmNoID0gZmlsZVNlYXJjaGVyc1tkaXJlY3RvcnlVcmldO1xuICBpZiAoc2VhcmNoID09PSB1bmRlZmluZWQpIHtcbiAgICBjb25zdCBkaXJlY3RvcnkgPSByZW1vdGVVcmkucGFyc2UoZGlyZWN0b3J5VXJpKS5wYXRoO1xuXG4gICAgY29uc3QgZXhpc3RzID0gYXdhaXQgZnNQcm9taXNlLmV4aXN0cyhkaXJlY3RvcnkpO1xuICAgIGlmICghZXhpc3RzKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0NvdWxkIG5vdCBmaW5kIGRpcmVjdG9yeSB0byBzZWFyY2ggOiAnICsgZGlyZWN0b3J5KTtcbiAgICB9XG5cbiAgICBjb25zdCBzdGF0ID0gYXdhaXQgZnNQcm9taXNlLnN0YXQoZGlyZWN0b3J5KTtcbiAgICBpZiAoIXN0YXQuaXNEaXJlY3RvcnkoKSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdQcm92aWRlZCBwYXRoIGlzIG5vdCBhIGRpcmVjdG9yeSA6ICcgKyBkaXJlY3RvcnkpO1xuICAgIH1cblxuICAgIHNlYXJjaCA9IGF3YWl0IGZpbGVTZWFyY2hGb3JEaXJlY3RvcnkoZGlyZWN0b3J5VXJpKTtcbiAgICBmaWxlU2VhcmNoZXJzW2RpcmVjdG9yeVVyaV0gPSBzZWFyY2g7XG4gIH1cblxuICByZXR1cm4gYXdhaXQgc2VhcmNoLnF1ZXJ5KHF1ZXJ5KTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gZ2V0U2VhcmNoUHJvdmlkZXJzKGN3ZDogc3RyaW5nKTogUHJvbWlzZTxBcnJheTxQcm92aWRlckluZm8+PiB7XG4gIGNvbnN0IHZhbGlkUHJvbWlzZXMgPSBbXTtcblxuICBhc3luYyBmdW5jdGlvbiBjaGVja0F2YWlsYWJpbGl0eShwcm92aWRlck5hbWUpIHtcbiAgICBjb25zdCBpc0F2YWlsYWJsZSA9IGF3YWl0IHByb3ZpZGVyc1twcm92aWRlck5hbWVdLmlzQXZhaWxhYmxlKGN3ZCk7XG4gICAgcmV0dXJuIGlzQXZhaWxhYmxlID8ge25hbWU6IHByb3ZpZGVyTmFtZX0gOiBudWxsO1xuICB9XG5cbiAgZm9yIChjb25zdCBuYW1lIGluIHByb3ZpZGVycykge1xuICAgIHZhbGlkUHJvbWlzZXMucHVzaChjaGVja0F2YWlsYWJpbGl0eShuYW1lKSk7XG4gIH1cblxuICBjb25zdCByZXN1bHRzID0gYXdhaXQgUHJvbWlzZS5hbGwodmFsaWRQcm9taXNlcyk7XG4gIHJldHVybiByZXN1bHRzLmZpbHRlcigocHJvdmlkZXIpID0+ICEhcHJvdmlkZXIpO1xufVxuXG5hc3luYyBmdW5jdGlvbiBkb1NlYXJjaFF1ZXJ5KGN3ZDogc3RyaW5nLCBwcm92aWRlcjogc3RyaW5nLCBxdWVyeTogc3RyaW5nKTogUHJvbWlzZTxTZWFyY2hSZXNwb25zZT4ge1xuICBjb25zdCBjdXJyZW50UHJvdmlkZXIgPSBwcm92aWRlcnNbcHJvdmlkZXJdO1xuICBpZiAoIWN1cnJlbnRQcm92aWRlcikge1xuICAgIHRocm93IG5ldyBFcnJvcihgSW52YWxpZCBwcm92aWRlcjogJHtwcm92aWRlcn1gKTtcbiAgfVxuICBjb25zdCByZXN1bHRzID0gYXdhaXQgY3VycmVudFByb3ZpZGVyLnF1ZXJ5KGN3ZCwgcXVlcnkpO1xuICByZXR1cm4ge3Jlc3VsdHN9O1xufVxuXG5mdW5jdGlvbiBhZGRQcm92aWRlcihuYW1lOiBzdHJpbmcsIHByb3ZpZGVyKSB7XG4gIHByb3ZpZGVycyA9IHByb3ZpZGVycyB8fCB7fTtcbiAgaWYgKHByb3ZpZGVyc1tuYW1lXSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgJHtuYW1lfSBoYXMgYWxyZWFkeSBiZWVuIGFkZGVkIGFzIGEgcHJvdmlkZXIuYCk7XG4gIH1cbiAgcHJvdmlkZXJzW25hbWVdID0gcHJvdmlkZXI7XG59XG5cbmZ1bmN0aW9uIGNsZWFyUHJvdmlkZXJzKCkge1xuICBwcm92aWRlcnMgPSB1bmRlZmluZWQ7XG59XG5cbmZ1bmN0aW9uIGluaXRpYWxpemUoc2VydmVyKSB7XG59XG5cbmZ1bmN0aW9uIHNodXRkb3duKHNlcnZlcikge1xuICBjbGVhclByb3ZpZGVycygpO1xuICBmb3IgKGNvbnN0IGsgaW4gZmlsZVNlYXJjaGVycykge1xuICAgIGZpbGVTZWFyY2hlcnNba10uZGlzcG9zZSgpO1xuICB9XG4gIGZpbGVTZWFyY2hlcnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgaW5pdGlhbGl6ZSxcbiAgc2h1dGRvd24sXG4gIGFkZFByb3ZpZGVyLFxuICBjbGVhclByb3ZpZGVycyxcbiAgc2VydmljZXM6IHtcbiAgICAnL3NlYXJjaC9xdWVyeSc6IHtoYW5kbGVyOiBkb1NlYXJjaFF1ZXJ5LCBtZXRob2Q6ICdwb3N0J30sXG4gICAgJy9zZWFyY2gvbGlzdFByb3ZpZGVycyc6IHtoYW5kbGVyOiBnZXRTZWFyY2hQcm92aWRlcnMsIG1ldGhvZDogJ3Bvc3QnfSxcbiAgICAnL3NlYXJjaC9kaXJlY3RvcnknOiB7aGFuZGxlcjogZG9TZWFyY2hEaXJlY3Rvcnl9LFxuICB9LFxufTtcbiJdfQ==\n","/home/travis/build/npmtest/node-npmtest-nuclide-server/node_modules/nuclide-server/lib/services/FileSystemService.js":"Object.defineProperty(exports, '__esModule', {\n  value: true\n});\nexports.exists = exists;\nexports.findNearestFile = findNearestFile;\nexports.lstat = lstat;\nexports.mkdir = mkdir;\nexports.mkdirp = mkdirp;\n\n/**\n * If no file (or directory) at the specified path exists, creates the parent\n * directories (if necessary) and then writes an empty file at the specified\n * path.\n *\n * @return A boolean indicating whether the file was created.\n */\n\nvar newFile = _asyncToGenerator(function* (filePath) {\n  var isExistingFile = yield fsPromise.exists(filePath);\n  if (isExistingFile) {\n    return false;\n  }\n  yield fsPromise.mkdirp(pathUtil.dirname(filePath));\n  yield fsPromise.writeFile(filePath, '');\n  return true;\n}\n\n/**\n * The readdir endpoint accepts the following query parameters:\n *\n *   path: path to the folder to list entries inside.\n *\n * Body contains a JSON encoded array of objects with file: and stats: entries.\n * file: has the file or directory name, stats: has the stats of the file/dir,\n * isSymbolicLink: true if the entry is a symlink to another filesystem location.\n */\n);\n\nexports.newFile = newFile;\n\nvar readdir = _asyncToGenerator(function* (path) {\n  var files = yield fsPromise.readdir(path);\n  var entries = yield Promise.all(files.map(_asyncToGenerator(function* (file) {\n    var fullpath = pathUtil.join(path, file);\n    var lstats = yield fsPromise.lstat(fullpath);\n    if (!lstats.isSymbolicLink()) {\n      return { file: file, stats: lstats, isSymbolicLink: false };\n    } else {\n      try {\n        var stats = yield fsPromise.stat(fullpath);\n        return { file: file, stats: stats, isSymbolicLink: true };\n      } catch (error) {\n        return { file: file, stats: undefined, isSymbolicLink: true, error: error };\n      }\n    }\n  })));\n  // TODO: Return entries directly and change client to handle error.\n  return entries.filter(function (entry) {\n    return entry.error === undefined;\n  }).map(function (entry) {\n    return { file: entry.file, stats: entry.stats, isSymbolicLink: entry.isSymbolicLink };\n  });\n}\n\n/**\n * Gets the real path of a file path.\n * It could be different than the given path if the file is a symlink\n * or exists in a symlinked directory.\n */\n);\n\nexports.readdir = readdir;\nexports.realpath = realpath;\nexports.resolveRealPath = resolveRealPath;\nexports.rename = rename;\n\n/**\n * Runs the equivalent of `cp sourcePath destinationPath`.\n */\n\nvar copy = _asyncToGenerator(function* (sourcePath, destinationPath) {\n  var isExistingFile = yield fsPromise.exists(destinationPath);\n  if (isExistingFile) {\n    return false;\n  }\n  yield new Promise(function (resolve, reject) {\n    var fsPlus = require('fs-plus');\n    fsPlus.copy(sourcePath, destinationPath, function (error) {\n      error ? reject(error) : resolve();\n    });\n  });\n  return true;\n}\n\n/**\n * Removes directories even if they are non-empty. Does not fail if the directory doesn't exist.\n */\n);\n\nexports.copy = copy;\nexports.rmdir = rmdir;\nexports.stat = stat;\nexports.unlink = unlink;\nexports.readFile = readFile;\n\n/**\n * The writeFile endpoint accepts the following query parameters:\n *\n *   path: path to the file to read (it must be url encoded).\n *   options: options to pass to fs.writeFile\n *\n * TODO: move to nuclide-commons and rename to writeFileAtomic\n */\n\nvar writeFile = _asyncToGenerator(function* (path, data, options) {\n\n  var complete = false;\n  var tempFilePath = yield fsPromise.tempfile('nuclide');\n  try {\n    yield fsPromise.writeFile(tempFilePath, data, options);\n\n    // Ensure file still has original permissions:\n    // https://github.com/facebook/nuclide/issues/157\n    // We update the mode of the temp file rather than the destination file because\n    // if we did the mv() then the chmod(), there would be a brief period between\n    // those two operations where the destination file might have the wrong permissions.\n    var permissions = null;\n    try {\n      permissions = (yield fsPromise.stat(path)).mode;\n    } catch (e) {\n      // If the file does not exist, then ENOENT will be thrown.\n      if (e.code !== 'ENOENT') {\n        throw e;\n      }\n    }\n    if (permissions != null) {\n      yield fsPromise.chmod(tempFilePath, permissions);\n    }\n\n    // TODO(mikeo): put renames into a queue so we don't write older save over new save.\n    // Use mv as fs.rename doesn't work across partitions.\n    yield mvPromise(tempFilePath, path);\n    complete = true;\n  } finally {\n    if (!complete) {\n      yield fsPromise.unlink(tempFilePath);\n    }\n  }\n});\n\nexports.writeFile = writeFile;\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { var callNext = step.bind(null, 'next'); var callThrow = step.bind(null, 'throw'); function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(callNext, callThrow); } } callNext(); }); }; }\n\n///////////////////\n//\n// Services\n//\n//////////////////\n\n/**\n * Checks a certain path for existence and returns 'true'/'false' accordingly\n */\n'use babel';\n\n/*\n * Copyright (c) 2015-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the license found in the LICENSE file in\n * the root directory of this source tree.\n */\n\n/**\n * This code implements the NuclideFs service.  It exports the FS on http via\n * the endpoint: http://your.server:your_port/fs/method where method is one of\n * readFile, writeFile, etc.\n */\n\nvar mv = require('mv');\nvar fs = require('fs');\nvar pathUtil = require('path');\n\nvar _require = require('nuclide-commons');\n\nvar fsPromise = _require.fsPromise;\n\nfunction exists(path) {\n  return fsPromise.exists(path);\n}\n\nfunction findNearestFile(fileName, pathToDirectory) {\n  return fsPromise.findNearestFile(fileName, pathToDirectory);\n}\n\n/**\n * The lstat endpoint is the same as the stat endpoint except it will return\n * the stat of a link instead of the file the link points to.\n */\n\nfunction lstat(path) {\n  return fsPromise.lstat(path);\n}\n\n/**\n * Creates a new directory with the given path.\n * Throws EEXIST error if the directory already exists.\n * Throws ENOENT if the path given is nested in a non-existing directory.\n */\n\nfunction mkdir(path) {\n  return fsPromise.mkdir(path);\n}\n\n/**\n * Runs the equivalent of `mkdir -p` with the given path.\n *\n * Like most implementations of mkdirp, if it fails, it is possible that\n * directories were created for some prefix of the given path.\n * @return true if the path was created; false if it already existed.\n */\n\nfunction mkdirp(path) {\n  return fsPromise.mkdirp(path);\n}\n\nfunction realpath(path) {\n  return fsPromise.realpath(path);\n}\n\nfunction resolveRealPath(path) {\n  return fsPromise.realpath(fsPromise.expandHomeDir(path));\n}\n\n/**\n * Runs the equivalent of `mv sourcePath destinationPath`.\n */\n\nfunction rename(sourcePath, destinationPath) {\n  return new Promise(function (resolve, reject) {\n    var fsPlus = require('fs-plus');\n    fsPlus.move(sourcePath, destinationPath, function (error) {\n      error ? reject(error) : resolve();\n    });\n  });\n}\n\nfunction rmdir(path) {\n  return fsPromise.rmdir(path);\n}\n\n/**\n * The stat endpoint accepts the following query parameters:\n *\n *   path: path to the file to read\n *\n */\n\nfunction stat(path) {\n  return fsPromise.stat(path);\n}\n\n/**\n * Removes files. Does not fail if the file doesn't exist.\n */\n\nfunction unlink(path) {\n  return fsPromise.unlink(path)['catch'](function (error) {\n    if (error.code !== 'ENOENT') {\n      throw error;\n    }\n  });\n}\n\n/**\n *   path: the path to the file to read\n *   options: options to pass to fs.readFile.\n *      Note that options does NOT include 'encoding' this ensures that the return value\n *      is always a Buffer and never a string.\n *\n *   Callers who want a string should call buffer.toString('utf8').\n */\n\nfunction readFile(path, options) {\n  return fsPromise.readFile(path, options);\n}\n\n// TODO: Move to nuclide-commons\nfunction mvPromise(sourcePath, destinationPath) {\n  return new Promise(function (resolve, reject) {\n    mv(sourcePath, destinationPath, { mkdirp: false }, function (error) {\n      if (error) {\n        reject(error);\n      } else {\n        resolve();\n      }\n    });\n  });\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi92YXIvZm9sZGVycy94Zi9yc3BoNF9jNTczMTVyczU3eHhzZHNrcnhudjM2dDAvVC90bXBwZmw1Mm5wdWJsaXNoX3BhY2thZ2VzL25wbS9udWNsaWRlLXNlcnZlci9saWIvc2VydmljZXMvRmlsZVN5c3RlbVNlcnZpY2UuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7SUE2RXNCLE9BQU8scUJBQXRCLFdBQXVCLFFBQWdCLEVBQW9CO0FBQ2hFLE1BQU0sY0FBYyxHQUFHLE1BQU0sU0FBUyxDQUFDLE1BQU0sQ0FBQyxRQUFRLENBQUMsQ0FBQztBQUN4RCxNQUFJLGNBQWMsRUFBRTtBQUNsQixXQUFPLEtBQUssQ0FBQztHQUNkO0FBQ0QsUUFBTSxTQUFTLENBQUMsTUFBTSxDQUFDLFFBQVEsQ0FBQyxPQUFPLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQztBQUNuRCxRQUFNLFNBQVMsQ0FBQyxTQUFTLENBQUMsUUFBUSxFQUFFLEVBQUUsQ0FBQyxDQUFDO0FBQ3hDLFNBQU8sSUFBSSxDQUFDO0NBQ2I7Ozs7Ozs7Ozs7Ozs7OztJQVdxQixPQUFPLHFCQUF0QixXQUF1QixJQUFZLEVBQWlDO0FBQ3pFLE1BQU0sS0FBSyxHQUFHLE1BQU0sU0FBUyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztBQUM1QyxNQUFNLE9BQU8sR0FBRyxNQUFNLE9BQU8sQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLEdBQUcsbUJBQUMsV0FBTyxJQUFJLEVBQUs7QUFDMUQsUUFBTSxRQUFRLEdBQUcsUUFBUSxDQUFDLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7QUFDM0MsUUFBTSxNQUFNLEdBQUcsTUFBTSxTQUFTLENBQUMsS0FBSyxDQUFDLFFBQVEsQ0FBQyxDQUFDO0FBQy9DLFFBQUksQ0FBQyxNQUFNLENBQUMsY0FBYyxFQUFFLEVBQUU7QUFDNUIsYUFBTyxFQUFDLElBQUksRUFBSixJQUFJLEVBQUUsS0FBSyxFQUFFLE1B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S0FBSyxFQUFJO0FBQ3hELFVBQUksS0FBSyxFQUFFO0FBQ1QsY0FBTSxDQUFDLEtBQUssQ0FBQyxDQUFDO09BQ2YsTUFBTTtBQUNMLGVBQU8sRUFBRSxDQUFDO09BQ1g7S0FDRixDQUFDLENBQUM7R0FDSixDQUFDLENBQUM7Q0FDSiIsImZpbGUiOiIvdmFyL2ZvbGRlcnMveGYvcnNwaDRfYzU3MzE1cnM1N3h4c2Rza3J4bnYzNnQwL1QvdG1wcGZsNTJucHVibGlzaF9wYWNrYWdlcy9ucG0vbnVjbGlkZS1zZXJ2ZXIvbGliL3NlcnZpY2VzL0ZpbGVTeXN0ZW1TZXJ2aWNlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBiYWJlbCc7XG4vKiBAZmxvdyAqL1xuXG4vKlxuICogQ29weXJpZ2h0IChjKSAyMDE1LXByZXNlbnQsIEZhY2Vib29rLCBJbmMuXG4gKiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIGxpY2Vuc2UgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpblxuICogdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKi9cblxuLyoqXG4gKiBUaGlzIGNvZGUgaW1wbGVtZW50cyB0aGUgTnVjbGlkZUZzIHNlcnZpY2UuICBJdCBleHBvcnRzIHRoZSBGUyBvbiBodHRwIHZpYVxuICogdGhlIGVuZHBvaW50OiBodHRwOi8veW91ci5zZXJ2ZXI6eW91cl9wb3J0L2ZzL21ldGhvZCB3aGVyZSBtZXRob2QgaXMgb25lIG9mXG4gKiByZWFkRmlsZSwgd3JpdGVGaWxlLCBldGMuXG4gKi9cblxuY29uc3QgbXYgPSByZXF1aXJlKCdtdicpO1xuY29uc3QgZnMgPSByZXF1aXJlKCdmcycpO1xuY29uc3QgcGF0aFV0aWwgPSByZXF1aXJlKCdwYXRoJyk7XG5jb25zdCB7ZnNQcm9taXNlfSA9IHJlcXVpcmUoJ251Y2xpZGUtY29tbW9ucycpO1xuXG5pbXBvcnQgdHlwZSBGaWxlV2l0aFN0YXRzIGZyb20gJy4vRmlsZVN5c3RlbVNlcnZpY2VUeXBlJztcblxuXG4vLy8vLy8vLy8vLy8vLy8vLy8vXG4vL1xuLy8gU2VydmljZXNcbi8vXG4vLy8vLy8vLy8vLy8vLy8vLy9cblxuLyoqXG4gKiBDaGVja3MgYSBjZXJ0YWluIHBhdGggZm9yIGV4aXN0ZW5jZSBhbmQgcmV0dXJucyAndHJ1ZScvJ2ZhbHNlJyBhY2NvcmRpbmdseVxuICovXG5leHBvcnQgZnVuY3Rpb24gZXhpc3RzKHBhdGg6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICByZXR1cm4gZnNQcm9taXNlLmV4aXN0cyhwYXRoKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGZpbmROZWFyZXN0RmlsZShmaWxlTmFtZTogc3RyaW5nLCBwYXRoVG9EaXJlY3Rvcnk6IHN0cmluZyk6IFByb21pc2U8P3N0cmluZz4ge1xuICByZXR1cm4gZnNQcm9taXNlLmZpbmROZWFyZXN0RmlsZShmaWxlTmFtZSwgcGF0aFRvRGlyZWN0b3J5KTtcbn1cblxuLyoqXG4gKiBUaGUgbHN0YXQgZW5kcG9pbnQgaXMgdGhlIHNhbWUgYXMgdGhlIHN0YXQgZW5kcG9pbnQgZXhjZXB0IGl0IHdpbGwgcmV0dXJuXG4gKiB0aGUgc3RhdCBvZiBhIGxpbmsgaW5zdGVhZCBvZiB0aGUgZmlsZSB0aGUgbGluayBwb2ludHMgdG8uXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBsc3RhdChwYXRoOiBzdHJpbmcpOiBQcm9taXNlPGZzLlN0YXRzPiB7XG4gIHJldHVybiBmc1Byb21pc2UubHN0YXQocGF0aCk7XG59XG5cbi8qKlxuICogQ3JlYXRlcyBhIG5ldyBkaXJlY3Rvcnkgd2l0aCB0aGUgZ2l2ZW4gcGF0aC5cbiAqIFRocm93cyBFRVhJU1QgZXJyb3IgaWYgdGhlIGRpcmVjdG9yeSBhbHJlYWR5IGV4aXN0cy5cbiAqIFRocm93cyBFTk9FTlQgaWYgdGhlIHBhdGggZ2l2ZW4gaXMgbmVzdGVkIGluIGEgbm9uLWV4aXN0aW5nIGRpcmVjdG9yeS5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIG1rZGlyKHBhdGg6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICByZXR1cm4gZnNQcm9taXNlLm1rZGlyKHBhdGgpO1xufVxuXG4vKipcbiAqIFJ1bnMgdGhlIGVxdWl2YWxlbnQgb2YgYG1rZGlyIC1wYCB3aXRoIHRoZSBnaXZlbiBwYXRoLlxuICpcbiAqIExpa2UgbW9zdCBpbXBsZW1lbnRhdGlvbnMgb2YgbWtkaXJwLCBpZiBpdCBmYWlscywgaXQgaXMgcG9zc2libGUgdGhhdFxuICogZGlyZWN0b3JpZXMgd2VyZSBjcmVhdGVkIGZvciBzb21lIHByZWZpeCBvZiB0aGUgZ2l2ZW4gcGF0aC5cbiAqIEByZXR1cm4gdHJ1ZSBpZiB0aGUgcGF0aCB3YXMgY3JlYXRlZDsgZmFsc2UgaWYgaXQgYWxyZWFkeSBleGlzdGVkLlxuICovXG5leHBvcnQgZnVuY3Rpb24gbWtkaXJwKHBhdGg6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICByZXR1cm4gZnNQcm9taXNlLm1rZGlycChwYXRoKTtcbn1cblxuLyoqXG4gKiBJZiBubyBmaWxlIChvciBkaXJlY3RvcnkpIGF0IHRoZSBzcGVjaWZpZWQgcGF0aCBleGlzdHMsIGNyZWF0ZXMgdGhlIHBhcmVudFxuICogZGlyZWN0b3JpZXMgKGlmIG5lY2Vzc2FyeSkgYW5kIHRoZW4gd3JpdGVzIGFuIGVtcHR5IGZpbGUgYXQgdGhlIHNwZWNpZmllZFxuICogcGF0aC5cbiAqXG4gKiBAcmV0dXJuIEEgYm9vbGVhbiBpbmRpY2F0aW5nIHdoZXRoZXIgdGhlIGZpbGUgd2FzIGNyZWF0ZWQuXG4gKi9cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBuZXdGaWxlKGZpbGVQYXRoOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgY29uc3QgaXNFeGlzdGluZ0ZpbGUgPSBhd2FpdCBmc1Byb21pc2UuZXhpc3RzKGZpbGVQYXRoKTtcbiAgaWYgKGlzRXhpc3RpbmdGaWxlKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIGF3YWl0IGZzUHJvbWlzZS5ta2RpcnAocGF0aFV0aWwuZGlybmFtZShmaWxlUGF0aCkpO1xuICBhd2FpdCBmc1Byb21pc2Uud3JpdGVGaWxlKGZpbGVQYXRoLCAnJyk7XG4gIHJldHVybiB0cnVlO1xufVxuXG4vKipcbiAqIFRoZSByZWFkZGlyIGVuZHBvaW50IGFjY2VwdHMgdGhlIGZvbGxvd2luZyBxdWVyeSBwYXJhbWV0ZXJzOlxuICpcbiAqICAgcGF0aDogcGF0aCB0byB0aGUgZm9sZGVyIHRvIGxpc3QgZW50cmllcyBpbnNpZGUuXG4gKlxuICogQm9keSBjb250YWlucyBhIEpTT04gZW5jb2RlZCBhcnJheSBvZiBvYmplY3RzIHdpdGggZmlsZTogYW5kIHN0YXRzOiBlbnRyaWVzLlxuICogZmlsZTogaGFzIHRoZSBmaWxlIG9yIGRpcmVjdG9yeSBuYW1lLCBzdGF0czogaGFzIHRoZSBzdGF0cyBvZiB0aGUgZmlsZS9kaXIsXG4gKiBpc1N5bWJvbGljTGluazogdHJ1ZSBpZiB0aGUgZW50cnkgaXMgYSBzeW1saW5rIHRvIGFub3RoZXIgZmlsZXN5c3RlbSBsb2NhdGlvbi5cbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlYWRkaXIocGF0aDogc3RyaW5nKTogUHJvbWlzZTxBcnJheTxGaWxlV2l0aFN0YXRzPj4ge1xuICBjb25zdCBmaWxlcyA9IGF3YWl0IGZzUHJvbWlzZS5yZWFkZGlyKHBhdGgpO1xuICBjb25zdCBlbnRyaWVzID0gYXdhaXQgUHJvbWlzZS5hbGwoZmlsZXMubWFwKGFzeW5jIChmaWxlKSA9PiB7XG4gICAgY29uc3QgZnVsbHBhdGggPSBwYXRoVXRpbC5qb2luKHBhdGgsIGZpbGUpO1xuICAgIGNvbnN0IGxzdGF0cyA9IGF3YWl0IGZzUHJvbWlzZS5sc3RhdChmdWxscGF0aCk7XG4gICAgaWYgKCFsc3RhdHMuaXNTeW1ib2xpY0xpbmsoKSkge1xuICAgICAgcmV0dXJuIHtmaWxlLCBzdGF0czogbHN0YXRzLCBpc1N5bWJvbGljTGluazogZmFsc2V9O1xuICAgIH0gZWxzZSB7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCBzdGF0cyA9IGF3YWl0IGZzUHJvbWlzZS5zdGF0KGZ1bGxwYXRoKTtcbiAgICAgICAgcmV0dXJuIHtmaWxlLCBzdGF0cywgaXNTeW1ib2xpY0xpbms6IHRydWV9O1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIHtmaWxlLCBzdGF0czogdW5kZWZpbmVkLCBpc1N5bWJvbGljTGluazogdHJ1ZSwgZXJyb3J9O1xuICAgICAgfVxuICAgIH1cbiAgfSkpO1xuICAvLyBUT0RPOiBSZXR1cm4gZW50cmllcyBkaXJlY3RseSBhbmQgY2hhbmdlIGNsaWVudCB0byBoYW5kbGUgZXJyb3IuXG4gIHJldHVybiBlbnRyaWVzLmZpbHRlcihlbnRyeSA9PiBlbnRyeS5lcnJvciA9PT0gdW5kZWZpbmVkKS5cbiAgICBtYXAoZW50cnkgPT4ge1xuICAgICAgcmV0dXJuIHtmaWxlOiBlbnRyeS5maWxlLCBzdGF0czogZW50cnkuc3RhdHMsIGlzU3ltYm9saWNMaW5rOiBlbnRyeS5pc1N5bWJvbGljTGlua307XG4gICAgfSk7XG59XG5cbi8qKlxuICogR2V0cyB0aGUgcmVhbCBwYXRoIG9mIGEgZmlsZSBwYXRoLlxuICogSXQgY291bGQgYmUgZGlmZmVyZW50IHRoYW4gdGhlIGdpdmVuIHBhdGggaWYgdGhlIGZpbGUgaXMgYSBzeW1saW5rXG4gKiBvciBleGlzdHMgaW4gYSBzeW1saW5rZWQgZGlyZWN0b3J5LlxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVhbHBhdGgocGF0aDogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgcmV0dXJuIGZzUHJvbWlzZS5yZWFscGF0aChwYXRoKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlc29sdmVSZWFsUGF0aChwYXRoOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZz4ge1xuICByZXR1cm4gZnNQcm9taXNlLnJlYWxwYXRoKGZzUHJvbWlzZS5leHBhbmRIb21lRGlyKHBhdGgpKTtcbn1cblxuLyoqXG4gKiBSdW5zIHRoZSBlcXVpdmFsZW50IG9mIGBtdiBzb3VyY2VQYXRoIGRlc3RpbmF0aW9uUGF0aGAuXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiByZW5hbWUoc291cmNlUGF0aDogc3RyaW5nLCBkZXN0aW5hdGlvblBhdGg6IHN0cmluZyk6IFByb21pc2Uge1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIGNvbnN0IGZzUGx1cyA9IHJlcXVpcmUoJ2ZzLXBsdXMnKTtcbiAgICBmc1BsdXMubW92ZShzb3VyY2VQYXRoLCBkZXN0aW5hdGlvblBhdGgsIGVycm9yID0+IHtcbiAgICAgIGVycm9yID8gcmVqZWN0KGVycm9yKSA6IHJlc29sdmUoKTtcbiAgICB9KTtcbiAgfSk7XG59XG5cbi8qKlxuICogUnVucyB0aGUgZXF1aXZhbGVudCBvZiBgY3Agc291cmNlUGF0aCBkZXN0aW5hdGlvblBhdGhgLlxuICovXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gY29weShzb3VyY2VQYXRoOiBzdHJpbmcsIGRlc3RpbmF0aW9uUGF0aDogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gIGNvbnN0IGlzRXhpc3RpbmdGaWxlID0gYXdhaXQgZnNQcm9taXNlLmV4aXN0cyhkZXN0aW5hdGlvblBhdGgpO1xuICBpZiAoaXNFeGlzdGluZ0ZpbGUpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgIGNvbnN0IGZzUGx1cyA9IHJlcXVpcmUoJ2ZzLXBsdXMnKTtcbiAgICBmc1BsdXMuY29weShzb3VyY2VQYXRoLCBkZXN0aW5hdGlvblBhdGgsIGVycm9yID0+IHtcbiAgICAgIGVycm9yID8gcmVqZWN0KGVycm9yKSA6IHJlc29sdmUoKTtcbiAgICB9KTtcbiAgfSk7XG4gIHJldHVybiB0cnVlO1xufVxuXG4vKipcbiAqIFJlbW92ZXMgZGlyZWN0b3JpZXMgZXZlbiBpZiB0aGV5IGFyZSBub24tZW1wdHkuIERvZXMgbm90IGZhaWwgaWYgdGhlIGRpcmVjdG9yeSBkb2Vzbid0IGV4aXN0LlxuICovXG5leHBvcnQgZnVuY3Rpb24gcm1kaXIocGF0aDogc3RyaW5nKTogUHJvbWlzZTx2b2lkPiB7XG4gIHJldHVybiBmc1Byb21pc2Uucm1kaXIocGF0aCk7XG59XG5cbi8qKlxuICogVGhlIHN0YXQgZW5kcG9pbnQgYWNjZXB0cyB0aGUgZm9sbG93aW5nIHF1ZXJ5IHBhcmFtZXRlcnM6XG4gKlxuICogICBwYXRoOiBwYXRoIHRvIHRoZSBmaWxlIHRvIHJlYWRcbiAqXG4gKi9cbmV4cG9ydCBmdW5jdGlvbiBzdGF0KHBhdGg6IHN0cmluZyk6IFByb21pc2U8ZnMuU3RhdHM+IHtcbiAgcmV0dXJuIGZzUHJvbWlzZS5zdGF0KHBhdGgpO1xufVxuXG4vKipcbiAqIFJlbW92ZXMgZmlsZXMuIERvZXMgbm90IGZhaWwgaWYgdGhlIGZpbGUgZG9lc24ndCBleGlzdC5cbiAqL1xuZXhwb3J0IGZ1bmN0aW9uIHVubGluayhwYXRoOiBzdHJpbmcpOiBQcm9taXNlIHtcbiAgcmV0dXJuIGZzUHJvbWlzZS51bmxpbmsocGF0aCkuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgaWYgKGVycm9yLmNvZGUgIT09ICdFTk9FTlQnKSB7XG4gICAgICB0aHJvdyBlcnJvcjtcbiAgICB9XG4gIH0pO1xufVxuXG4vKipcbiAqICAgcGF0aDogdGhlIHBhdGggdG8gdGhlIGZpbGUgdG8gcmVhZFxuICogICBvcHRpb25zOiBvcHRpb25zIHRvIHBhc3MgdG8gZnMucmVhZEZpbGUuXG4gKiAgICAgIE5vdGUgdGhhdCBvcHRpb25zIGRvZXMgTk9UIGluY2x1ZGUgJ2VuY29kaW5nJyB0aGlzIGVuc3VyZXMgdGhhdCB0aGUgcmV0dXJuIHZhbHVlXG4gKiAgICAgIGlzIGFsd2F5cyBhIEJ1ZmZlciBhbmQgbmV2ZXIgYSBzdHJpbmcuXG4gKlxuICogICBDYWxsZXJzIHdobyB3YW50IGEgc3RyaW5nIHNob3VsZCBjYWxsIGJ1ZmZlci50b1N0cmluZygndXRmOCcpLlxuICovXG5leHBvcnQgZnVuY3Rpb24gcmVhZEZpbGUocGF0aDogc3RyaW5nLCBvcHRpb25zPzoge2ZsYWc/OiBzdHJpbmd9KTpcbiAgICBQcm9taXNlPEJ1ZmZlcj4ge1xuICByZXR1cm4gZnNQcm9taXNlLnJlYWRGaWxlKHBhdGgsIG9wdGlvbnMpO1xufVxuXG4vLyBUT0RPOiBNb3ZlIHRvIG51Y2xpZGUtY29tbW9uc1xuZnVuY3Rpb24gbXZQcm9taXNlKHNvdXJjZVBhdGg6IHN0cmluZywgZGVzdGluYXRpb25QYXRoOiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICBtdihzb3VyY2VQYXRoLCBkZXN0aW5hdGlvblBhdGgsIHtta2RpcnA6IGZhbHNlfSwgZXJyb3IgPT4ge1xuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICByZXNvbHZlKCk7XG4gICAgICB9XG4gICAgfSk7XG4gIH0pO1xufVxuXG4vKipcbiAqIFRoZSB3cml0ZUZpbGUgZW5kcG9pbnQgYWNjZXB0cyB0aGUgZm9sbG93aW5nIHF1ZXJ5IHBhcmFtZXRlcnM6XG4gKlxuICogICBwYXRoOiBwYXRoIHRvIHRoZSBmaWxlIHRvIHJlYWQgKGl0IG11c3QgYmUgdXJsIGVuY29kZWQpLlxuICogICBvcHRpb25zOiBvcHRpb25zIHRvIHBhc3MgdG8gZnMud3JpdGVGaWxlXG4gKlxuICogVE9ETzogbW92ZSB0byBudWNsaWRlLWNvbW1vbnMgYW5kIHJlbmFtZSB0byB3cml0ZUZpbGVBdG9taWNcbiAqL1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHdyaXRlRmlsZShwYXRoOiBzdHJpbmcsIGRhdGE6IHN0cmluZyxcbiAgICBvcHRpb25zOiA/e2VuY29kaW5nPzogc3RyaW5nOyBtb2RlPzogbnVtYmVyOyBmbGFnPzpzdHJpbmd9KTogUHJvbWlzZTx2b2lkPiB7XG5cbiAgbGV0IGNvbXBsZXRlID0gZmFsc2U7XG4gIGNvbnN0IHRlbXBGaWxlUGF0aCA9IGF3YWl0IGZzUHJvbWlzZS50ZW1wZmlsZSgnbnVjbGlkZScpO1xuICB0cnkge1xuICAgIGF3YWl0IGZzUHJvbWlzZS53cml0ZUZpbGUodGVtcEZpbGVQYXRoLCBkYXRhLCBvcHRpb25zKTtcblxuICAgIC8vIEVuc3VyZSBmaWxlIHN0aWxsIGhhcyBvcmlnaW5hbCBwZXJtaXNzaW9uczpcbiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20vZmFjZWJvb2svbnVjbGlkZS9pc3N1ZXMvMTU3XG4gICAgLy8gV2UgdXBkYXRlIHRoZSBtb2RlIG9mIHRoZSB0ZW1wIGZpbGUgcmF0aGVyIHRoYW4gdGhlIGRlc3RpbmF0aW9uIGZpbGUgYmVjYXVzZVxuICAgIC8vIGlmIHdlIGRpZCB0aGUgbXYoKSB0aGVuIHRoZSBjaG1vZCgpLCB0aGVyZSB3b3VsZCBiZSBhIGJyaWVmIHBlcmlvZCBiZXR3ZWVuXG4gICAgLy8gdGhvc2UgdHdvIG9wZXJhdGlvbnMgd2hlcmUgdGhlIGRlc3RpbmF0aW9uIGZpbGUgbWlnaHQgaGF2ZSB0aGUgd3JvbmcgcGVybWlzc2lvbnMuXG4gICAgbGV0IHBlcm1pc3Npb25zID0gbnVsbDtcbiAgICB0cnkge1xuICAgICAgcGVybWlzc2lvbnMgPSAoYXdhaXQgZnNQcm9taXNlLnN0YXQocGF0aCkpLm1vZGU7XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgLy8gSWYgdGhlIGZpbGUgZG9lcyBub3QgZXhpc3QsIHRoZW4gRU5PRU5UIHdpbGwgYmUgdGhyb3duLlxuICAgICAgaWYgKGUuY29kZSAhPT0gJ0VOT0VOVCcpIHtcbiAgICAgICAgdGhyb3cgZTtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKHBlcm1pc3Npb25zICE9IG51bGwpIHtcbiAgICAgIGF3YWl0IGZzUHJvbWlzZS5jaG1vZCh0ZW1wRmlsZVBhdGgsIHBlcm1pc3Npb25zKTtcbiAgICB9XG5cbiAgICAvLyBUT0RPKG1pa2VvKTogcHV0IHJlbmFtZXMgaW50byBhIHF1ZXVlIHNvIHdlIGRvbid0IHdyaXRlIG9sZGVyIHNhdmUgb3ZlciBuZXcgc2F2ZS5cbiAgICAvLyBVc2UgbXYgYXMgZnMucmVuYW1lIGRvZXNuJ3Qgd29yayBhY3Jvc3MgcGFydGl0aW9ucy5cbiAgICBhd2FpdCBtdlByb21pc2UodGVtcEZpbGVQYXRoLCBwYXRoKTtcbiAgICBjb21wbGV0ZSA9IHRydWU7XG4gIH0gZmluYWxseSB7XG4gICAgaWYgKCFjb21wbGV0ZSkge1xuICAgICAgYXdhaXQgZnNQcm9taXNlLnVubGluayh0ZW1wRmlsZVBhdGgpO1xuICAgIH1cbiAgfVxufVxuIl19\n","/home/travis/build/npmtest/node-npmtest-nuclide-server/node_modules/nuclide-server/lib/services/InfoService.js":"Object.defineProperty(exports, '__esModule', {\n  value: true\n});\n\nvar getServerVersion = _asyncToGenerator(function* () {\n  return (0, _nuclideVersion.getVersion)();\n});\n\nexports.getServerVersion = getServerVersion;\nexports.shutdownServer = shutdownServer;\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { var callNext = step.bind(null, 'next'); var callThrow = step.bind(null, 'throw'); function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(callNext, callThrow); } } callNext(); }); }; }\n\n/*\n * Copyright (c) 2015-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the license found in the LICENSE file in\n * the root directory of this source tree.\n */\n\nvar _nuclideVersion = require('nuclide-version');\n\nvar _NuclideServer = require('../NuclideServer');\n\nvar _NuclideServer2 = _interopRequireDefault(_NuclideServer);\n\n'use babel';\n\nfunction shutdownServer() {\n  _NuclideServer2['default'].shutdown();\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi92YXIvZm9sZGVycy94Zi9yc3BoNF9jNTczMTVyczU3eHhzZHNrcnhudjM2dDAvVC90bXBwZmw1Mm5wdWJsaXNoX3BhY2thZ2VzL25wbS9udWNsaWRlLXNlcnZlci9saWIvc2VydmljZXMvSW5mb1NlcnZpY2UuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7OztJQWNzQixnQkFBZ0IscUJBQS9CLGFBQW1EO0FBQ3hELFNBQU8sb0JBSkQsVUFBVSxHQUlHLENBQUM7Q0FDckI7Ozs7Ozs7Ozs7Ozs7Ozs7OzhCQUx3QixpQkFBaUI7OzZCQUNoQixrQkFBa0I7Ozs7QUFaNUMsV0FBVyxDQUFDOztBQWtCTCxTQUFTLGNBQWMsR0FBUztBQUNyQyw2QkFBYyxRQUFRLEVBQUUsQ0FBQztDQUMxQiIsImZpbGUiOiIvdmFyL2ZvbGRlcnMveGYvcnNwaDRfYzU3MzE1cnM1N3h4c2Rza3J4bnYzNnQwL1QvdG1wcGZsNTJucHVibGlzaF9wYWNrYWdlcy9ucG0vbnVjbGlkZS1zZXJ2ZXIvbGliL3NlcnZpY2VzL0luZm9TZXJ2aWNlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBiYWJlbCc7XG4vKiBAZmxvdyAqL1xuXG4vKlxuICogQ29weXJpZ2h0IChjKSAyMDE1LXByZXNlbnQsIEZhY2Vib29rLCBJbmMuXG4gKiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIGxpY2Vuc2UgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpblxuICogdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKi9cblxuaW1wb3J0IHtnZXRWZXJzaW9ufSBmcm9tICdudWNsaWRlLXZlcnNpb24nO1xuaW1wb3J0IE51Y2xpZGVTZXJ2ZXIgZnJvbSAnLi4vTnVjbGlkZVNlcnZlcic7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBnZXRTZXJ2ZXJWZXJzaW9uKCk6IFByb21pc2U8c3RyaW5nPiB7XG4gIHJldHVybiBnZXRWZXJzaW9uKCk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzaHV0ZG93blNlcnZlcigpOiB2b2lkIHtcbiAgTnVjbGlkZVNlcnZlci5zaHV0ZG93bigpO1xufVxuIl19\n","/home/travis/build/npmtest/node-npmtest-nuclide-server/node_modules/nuclide-server/lib/services/SourceControlService.js":"Object.defineProperty(exports, '__esModule', {\n  value: true\n});\n\n/*\n * Copyright (c) 2015-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the license found in the LICENSE file in\n * the root directory of this source tree.\n */\n\n/**\n * This is a workaround that should be removed when Atom 2.0 comes out.\n * See t6913624.\n */\n\nexports.getHgRepository = getHgRepository;\n'use babel';\n\nfunction getHgRepository(directoryPath) {\n  var _require = require('nuclide-source-control-helpers');\n\n  var findHgRepository = _require.findHgRepository;\n\n  return Promise.resolve(findHgRepository(directoryPath));\n}\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi92YXIvZm9sZGVycy94Zi9yc3BoNF9jNTczMTVyczU3eHhzZHNrcnhudjM2dDAvVC90bXBwZmw1Mm5wdWJsaXNoX3BhY2thZ2VzL25wbS9udWNsaWRlLXNlcnZlci9saWIvc2VydmljZXMvU291cmNlQ29udHJvbFNlcnZpY2UuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsV0FBVyxDQUFDOztBQWtCTCxTQUFTLGVBQWUsQ0FBQyxhQUFxQixFQUFvQztpQkFDNUQsT0FBTyxDQUFDLGdDQUFnQyxDQUFDOztNQUE3RCxnQkFBZ0IsWUFBaEIsZ0JBQWdCOztBQUN2QixTQUFPLE9BQU8sQ0FBQyxPQUFPLENBQUMsZ0JBQWdCLENBQUMsYUFBYSxDQUFDLENBQUMsQ0FBQztDQUN6RCIsImZpbGUiOiIvdmFyL2ZvbGRlcnMveGYvcnNwaDRfYzU3MzE1cnM1N3h4c2Rza3J4bnYzNnQwL1QvdG1wcGZsNTJucHVibGlzaF9wYWNrYWdlcy9ucG0vbnVjbGlkZS1zZXJ2ZXIvbGliL3NlcnZpY2VzL1NvdXJjZUNvbnRyb2xTZXJ2aWNlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBiYWJlbCc7XG4vKiBAZmxvdyAqL1xuXG4vKlxuICogQ29weXJpZ2h0IChjKSAyMDE1LXByZXNlbnQsIEZhY2Vib29rLCBJbmMuXG4gKiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIGxpY2Vuc2UgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpblxuICogdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKi9cblxuLyoqXG4gKiBUaGlzIGlzIGEgd29ya2Fyb3VuZCB0aGF0IHNob3VsZCBiZSByZW1vdmVkIHdoZW4gQXRvbSAyLjAgY29tZXMgb3V0LlxuICogU2VlIHQ2OTEzNjI0LlxuICovXG5cbmltcG9ydCB0eXBlIHtIZ1JlcG9zaXRvcnlEZXNjcmlwdGlvbn0gZnJvbSAnbnVjbGlkZS1zb3VyY2UtY29udHJvbC1oZWxwZXJzL2xpYi9oZy1yZXBvc2l0b3J5JztcblxuZXhwb3J0IGZ1bmN0aW9uIGdldEhnUmVwb3NpdG9yeShkaXJlY3RvcnlQYXRoOiBzdHJpbmcpOiBQcm9taXNlPEhnUmVwb3NpdG9yeURlc2NyaXB0aW9uPiB7XG4gIGNvbnN0IHtmaW5kSGdSZXBvc2l0b3J5fSA9IHJlcXVpcmUoJ251Y2xpZGUtc291cmNlLWNvbnRyb2wtaGVscGVycycpO1xuICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKGZpbmRIZ1JlcG9zaXRvcnkoZGlyZWN0b3J5UGF0aCkpO1xufVxuIl19\n","/home/travis/build/npmtest/node-npmtest-nuclide-server/node_modules/nuclide-server/lib/NuclideClient.js":"\n/*\n * Copyright (c) 2015-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the license found in the LICENSE file in\n * the root directory of this source tree.\n */\n\n/**\n * This code implements the NuclideFs client.  It uses the request module to\n * make XHR requests to the NuclideFS service.  It is a Promise based API.\n */\n\nvar _slicedToArray = (function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i['return']) _i['return'](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError('Invalid attempt to destructure non-iterable instance'); } }; })();\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { var callNext = step.bind(null, 'next'); var callThrow = step.bind(null, 'throw'); function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(callNext, callThrow); } } callNext(); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nvar NuclideClient = (function () {\n  function NuclideClient(id, eventbus) {\n    var options = arguments.length <= 2 || arguments[2] === undefined ? {} : arguments[2];\n\n    _classCallCheck(this, NuclideClient);\n\n    this._id = id;\n    this.eventbus = eventbus;\n    this._options = options;\n    this._searchProviders = {};\n  }\n\n  _createClass(NuclideClient, [{\n    key: 'getID',\n    value: function getID() {\n      return this._id;\n    }\n\n    // Resolves if the connection looks healthy.\n    // Will reject quickly if the connection looks unhealthy.\n  }, {\n    key: 'testConnection',\n    value: function testConnection() {\n      return this.eventbus.testConnection();\n    }\n\n    // Delegate RPC functions to the NuclideRemoteEventbus class.\n  }, {\n    key: 'callRemoteFunction',\n    value: function callRemoteFunction() {\n      for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      return this.eventbus.callRemoteFunction.apply(this.eventbus, args);\n    }\n  }, {\n    key: 'createRemoteObject',\n    value: function createRemoteObject() {\n      for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n\n      return this.eventbus.createRemoteObject.apply(this.eventbus, args);\n    }\n  }, {\n    key: 'callRemoteMethod',\n    value: function callRemoteMethod() {\n      for (var _len3 = arguments.length, args = Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n        args[_key3] = arguments[_key3];\n      }\n\n      return this.eventbus.callRemoteMethod.apply(this.eventbus, args);\n    }\n  }, {\n    key: 'disposeRemoteObject',\n    value: function disposeRemoteObject() {\n      for (var _len4 = arguments.length, args = Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n        args[_key4] = arguments[_key4];\n      }\n\n      return this.eventbus.disposeRemoteObject.apply(this.eventbus, args);\n    }\n\n    // Delegate marshalling to the NuclideRemoteEventbus class.\n  }, {\n    key: 'marshal',\n    value: function marshal() {\n      var _eventbus;\n\n      return (_eventbus = this.eventbus).marshal.apply(_eventbus, arguments);\n    }\n  }, {\n    key: 'unmarshal',\n    value: function unmarshal() {\n      var _eventbus2;\n\n      return (_eventbus2 = this.eventbus).unmarshal.apply(_eventbus2, arguments);\n    }\n  }, {\n    key: 'registerType',\n    value: function registerType() {\n      var _eventbus3;\n\n      return (_eventbus3 = this.eventbus).registerType.apply(_eventbus3, arguments);\n    }\n\n    /**\n     * Make rpc call to service given serviceUri in form of `$serviceName/$methodName` and args as arguments list.\n     */\n  }, {\n    key: 'makeRpc',\n    value: function makeRpc(serviceUri, args, serviceOptions) {\n      var _serviceUri$split = serviceUri.split('/');\n\n      var _serviceUri$split2 = _slicedToArray(_serviceUri$split, 2);\n\n      var serviceName = _serviceUri$split2[0];\n      var methodName = _serviceUri$split2[1];\n\n      return this.eventbus.callServiceFrameworkMethod(serviceName, methodName,\n      /* methodArgs */args,\n      /* serviceOptions */serviceOptions);\n    }\n  }, {\n    key: 'registerEventListener',\n    value: function registerEventListener(eventName, callback, serviceOptions) {\n      return this.eventbus.registerEventListener(eventName, callback, serviceOptions);\n    }\n\n    /**\n     * Searches the contents of `directory` for paths mathing `query`.\n     */\n  }, {\n    key: 'searchDirectory',\n    value: _asyncToGenerator(function* (directory, query) {\n      return yield this.eventbus.callMethod(\n      /*serviceName*/'search',\n      /*methodName*/'directory',\n      /*methodArgs*/[directory, query],\n      /*extraOptions*/{ json: true });\n    })\n  }, {\n    key: 'doSearchQuery',\n    value: function doSearchQuery(rootDirectory, provider, query) {\n      return this.eventbus.callMethod(\n      /*serviceName*/'search',\n      /*methodName*/'query',\n      /*methodArgs*/[rootDirectory, provider, query],\n      /*extraOptions*/{ method: 'POST', json: true });\n    }\n  }, {\n    key: 'getSearchProviders',\n    value: _asyncToGenerator(function* (rootDirectory) {\n      var providers = this._searchProviders[rootDirectory];\n      if (providers) {\n        return providers;\n      }\n      providers = yield this.eventbus.callMethod(\n      /*serviceName*/'search',\n      /*methodName*/'listProviders',\n      /*methodArgs*/[rootDirectory],\n      /*extraOptions*/{ method: 'POST', json: true });\n\n      this._searchProviders[rootDirectory] = providers;\n\n      return providers;\n    })\n  }, {\n    key: 'close',\n    value: function close() {\n      if (this.eventbus) {\n        this.eventbus.close();\n        this.eventbus = null;\n      }\n    }\n  }]);\n\n  return NuclideClient;\n})();\n\nmodule.exports = NuclideClient;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi92YXIvZm9sZGVycy94Zi9yc3BoNF9jNTczMTVyczU3eHhzZHNrcnhudjM2dDAvVC90bXBwZmw1Mm5wdWJsaXNoX3BhY2thZ2VzL25wbS9udWNsaWRlLXNlcnZlci9saWIvTnVjbGlkZUNsaWVudC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxXQUFXLENBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0lBcUJOLGFBQWE7QUFLTixXQUxQLGFBQWEsQ0FLTCxFQUFVLEVBQUUsUUFBeUIsRUFBdUM7UUFBckMsT0FBOEIseURBQUcsRUFBRTs7MEJBTGxGLGFBQWE7O0FBTWYsUUFBSSxDQUFDLEdBQUcsR0FBRyxFQUFFLENBQUM7QUFDZCxRQUFJLENBQUMsUUFBUSxHQUFHLFFBQVEsQ0FBQztBQUN6QixRQUFJLENBQUMsUUFBUSxHQUFHLE9BQU8sQ0FBQztBQUN4QixRQUFJLENBQUMsZ0JBQWdCLEdBQUcsRUFBRSxDQUFDO0dBQzVCOztlQVZHLGFBQWE7O1dBWVosaUJBQUc7QUFDTixhQUFPLElBQUksQ0FBQyxHQUFHLENBQUM7S0FDakI7Ozs7OztXQUlhLDBCQUFrQjtBQUM5QixhQUFPLElBQUksQ0FBQyxRQUFRLENBQUMsY0FBYyxFQUFFLENBQUM7S0FDdkM7Ozs7O1dBR2lCLDhCQUEyQjt3Q0FBdkIsSUFBSTtBQUFKLFlBQUk7OztBQUN4QixhQUFPLElBQUksQ0FBQyxRQUFRLENBQUMsa0JBQWtCLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxRQUFRLEVBQUUsSUFBSSxDQUFDLENBQUM7S0FDcEU7OztXQUNpQiw4QkFBdUM7eUNBQW5DLElBQUk7QUFBSixZQUFJOzs7QUFDeEIsYUFBTyxJQUFJLENBQUMsUUFBUSxDQUFDLGtCQUFrQixDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQyxDQUFDO0tBQ3BFOzs7V0FDZSw0QkFBMkI7eUNBQXZCLElBQUk7QUFBSixZQUFJOzs7QUFDdEIsYUFBTyxJQUFJLENBQUMsUUFBUSxDQUFDLGdCQUFnQixDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsUUFBUSxFQUFFLElBQUksQ0FBQyxDQUFDO0tBQ2xFOzs7V0FDa0IsK0JBQXFDO3lDQUFqQyxJQUFJO0FBQUosWUFBSTs7O0FBQ3pCLGFBQU8sSUFBSSxDQUFDLFFBQVEsQ0FBQyxtQkFBbUIsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLFFBQVEsRUFBRSxJQUFJLENBQUMsQ0FBQztLQUNyRTs7Ozs7V0FHTSxtQkFBZTs7O0FBQ3BCLGFBQU8sYUFBQSxJQUFJLENBQUMsUUFBUSxFQUFDLE9BQU8sTUFBQSxzQkFBUyxDQUFDO0tBQ3ZDOzs7V0FDUSxxQkFBZTs7O0FBQ3RCLGFBQU8sY0FBQSxJQUFJLENBQUMsUUFBUSxFQUFDLFNBQVMsTUFBQSx1QkFBUyxDQUFDO0tBQ3pDOzs7V0FDVyx3QkFBZ0I7OztBQUMxQixhQUFPLGNBQUEsSUFBSSxDQUFDLFFBQVEsRUFBQyxZQUFZLE1BQUEsdUJBQVMsQ0FBQztLQUM1Qzs7Ozs7OztXQUtNLGlCQUFDLFVBQWtCLEVBQUUsSUFBZ0IsRUFBRSxjQUFtQixFQUFnQjs4QkFDN0MsVUFBVSxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUM7Ozs7VUFBaEQsV0FBVztVQUFFLFVBQVU7O0FBQzlCLGFBQU8sSUFBSSxDQUFDLFFBQVEsQ0FBQywwQkFBMEIsQ0FDN0MsV0FBVyxFQUNYLFVBQVU7c0JBQ08sSUFBSTswQkFDQSxjQUFjLENBQ3JDLENBQUM7S0FDRjs7O1dBRW9CLCtCQUFDLFNBQWlCLEVBQUUsUUFBdUMsRUFBRSxjQUFtQixFQUFjO0FBQ2pILGFBQU8sSUFBSSxDQUFDLFFBQVEsQ0FBQyxxQkFBcUIsQ0FBQyxTQUFTLEVBQUUsUUFBUSxFQUFFLGNBQWMsQ0FBQyxDQUFDO0tBQ2pGOzs7Ozs7OzZCQUtvQixXQUFDLFNBQWlCLEVBQUUsS0FBYSxFQUFnQjtBQUNwRSxhQUFPLE1BQU0sSUFBSSxDQUFDLFFBQVEsQ0FBQyxVQUFVO3FCQUNuQixRQUFRO29CQUNULFdBQVc7b0JBQ1gsQ0FBQyxTQUFTLEVBQUUsS0FBSyxDQUFDO3NCQUNoQixFQUFDLElBQUksRUFBRSxJQUFJLEVBQUMsQ0FDOUIsQ0FBQztLQUNIOzs7V0FFWSx1QkFBQyxhQUFvQixFQUFFLFFBQWdCLEVBQUUsS0FBYSxFQUFXO0FBQzVFLGFBQU8sSUFBSSxDQUFDLFFBQVEsQ0FBQyxVQUFVO3FCQUNiLFFBQVE7b0JBQ1QsT0FBTztvQkFDUCxDQUFDLGFBQWEsRUFBRSxRQUFRLEVBQUUsS0FBSyxDQUFDO3NCQUM5QixFQUFDLE1BQU0sRUFBRSxNQUFNLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBQyxDQUM5QyxDQUFDO0tBQ0g7Ozs2QkFFdUIsV0FBQyxhQUFxQixFQUFpQztBQUM3RSxVQUFJLFNBQVMsR0FBRyxJQUFJLENBQUMsZ0JBQWdCLENBQUMsYUFBYSxDQUFDLENBQUM7QUFDckQsVUFBSSxTQUFTLEVBQUU7QUFDYixlQUFPLFNBQVMsQ0FBQztPQUNsQjtBQUNELGVBQVMsR0FBRyxNQUFNLElBQUksQ0FBQyxRQUFRLENBQUMsVUFBVTtxQkFDeEIsUUFBUTtvQkFDVCxlQUFlO29CQUNmLENBQUMsYUFBYSxDQUFDO3NCQUNiLEVBQUMsTUFBTSxFQUFFLE1BQU0sRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFDLENBQzlDLENBQUM7O0FBRUYsVUFBSSxDQUFDLGdCQUFnQixDQUFDLGFBQWEsQ0FBQyxHQUFHLFNBQVMsQ0FBQzs7QUFFakQsYUFBTyxTQUFTLENBQUM7S0FDbEI7OztXQUVJLGlCQUFVO0FBQ2IsVUFBSSxJQUFJLENBQUMsUUFBUSxFQUFFO0FBQ2pCLFlBQUksQ0FBQyxRQUFRLENBQUMsS0FBSyxFQUFFLENBQUM7QUFDdEIsWUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUM7T0FDdEI7S0FDRjs7O1NBM0dHLGFBQWE7OztBQThHbkIsTUFBTSxDQUFDLE9BQU8sR0FBRyxhQUFhLENBQUMiLCJmaWxlIjoiL3Zhci9mb2xkZXJzL3hmL3JzcGg0X2M1NzMxNXJzNTd4eHNkc2tyeG52MzZ0MC9UL3RtcHBmbDUybnB1Ymxpc2hfcGFja2FnZXMvbnBtL251Y2xpZGUtc2VydmVyL2xpYi9OdWNsaWRlQ2xpZW50LmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBiYWJlbCc7XG4vKiBAZmxvdyAqL1xuXG4vKlxuICogQ29weXJpZ2h0IChjKSAyMDE1LXByZXNlbnQsIEZhY2Vib29rLCBJbmMuXG4gKiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIGxpY2Vuc2UgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpblxuICogdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKi9cblxuLyoqXG4gKiBUaGlzIGNvZGUgaW1wbGVtZW50cyB0aGUgTnVjbGlkZUZzIGNsaWVudC4gIEl0IHVzZXMgdGhlIHJlcXVlc3QgbW9kdWxlIHRvXG4gKiBtYWtlIFhIUiByZXF1ZXN0cyB0byB0aGUgTnVjbGlkZUZTIHNlcnZpY2UuICBJdCBpcyBhIFByb21pc2UgYmFzZWQgQVBJLlxuICovXG5cbnR5cGUgRXhlY1Jlc3VsdCA9IHtlcnJvcjogP0Vycm9yOyBzdGRvdXQ6IHN0cmluZzsgc3RkZXJyOiBzdHJpbmd9O1xudHlwZSBOdWNsaWRlQ2xpZW50T3B0aW9ucyA9IHtcbiAgY3dkOiA/c3RyaW5nO1xufTtcblxuY2xhc3MgTnVjbGlkZUNsaWVudCB7XG4gIF9pZDogc3RyaW5nO1xuICBfb3B0aW9uczogTnVjbGlkZUNsaWVudE9wdGlvbnM7XG4gIGV2ZW50YnVzOiBOdWNsaWRlRXZlbnRidXM7XG5cbiAgY29uc3RydWN0b3IoaWQ6IHN0cmluZywgZXZlbnRidXM6IE51Y2xpZGVFdmVudGJ1cywgb3B0aW9uczogP051Y2xpZGVDbGllbnRPcHRpb25zID0ge30pIHtcbiAgICB0aGlzLl9pZCA9IGlkO1xuICAgIHRoaXMuZXZlbnRidXMgPSBldmVudGJ1cztcbiAgICB0aGlzLl9vcHRpb25zID0gb3B0aW9ucztcbiAgICB0aGlzLl9zZWFyY2hQcm92aWRlcnMgPSB7fTtcbiAgfVxuXG4gIGdldElEKCkge1xuICAgIHJldHVybiB0aGlzLl9pZDtcbiAgfVxuXG4gIC8vIFJlc29sdmVzIGlmIHRoZSBjb25uZWN0aW9uIGxvb2tzIGhlYWx0aHkuXG4gIC8vIFdpbGwgcmVqZWN0IHF1aWNrbHkgaWYgdGhlIGNvbm5lY3Rpb24gbG9va3MgdW5oZWFsdGh5LlxuICB0ZXN0Q29ubmVjdGlvbigpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICByZXR1cm4gdGhpcy5ldmVudGJ1cy50ZXN0Q29ubmVjdGlvbigpO1xuICB9XG5cbiAgLy8gRGVsZWdhdGUgUlBDIGZ1bmN0aW9ucyB0byB0aGUgTnVjbGlkZVJlbW90ZUV2ZW50YnVzIGNsYXNzLlxuICBjYWxsUmVtb3RlRnVuY3Rpb24oLi4uYXJnczogQXJyYXk8YW55Pik6IGFueSB7XG4gICAgcmV0dXJuIHRoaXMuZXZlbnRidXMuY2FsbFJlbW90ZUZ1bmN0aW9uLmFwcGx5KHRoaXMuZXZlbnRidXMsIGFyZ3MpO1xuICB9XG4gIGNyZWF0ZVJlbW90ZU9iamVjdCguLi5hcmdzOiBBcnJheTxhbnk+KTogUHJvbWlzZTxudW1iZXI+IHtcbiAgICByZXR1cm4gdGhpcy5ldmVudGJ1cy5jcmVhdGVSZW1vdGVPYmplY3QuYXBwbHkodGhpcy5ldmVudGJ1cywgYXJncyk7XG4gIH1cbiAgY2FsbFJlbW90ZU1ldGhvZCguLi5hcmdzOiBBcnJheTxhbnk+KTogYW55IHtcbiAgICByZXR1cm4gdGhpcy5ldmVudGJ1cy5jYWxsUmVtb3RlTWV0aG9kLmFwcGx5KHRoaXMuZXZlbnRidXMsIGFyZ3MpO1xuICB9XG4gIGRpc3Bvc2VSZW1vdGVPYmplY3QoLi4uYXJnczogQXJyYXk8YW55Pik6IFByb21pc2U8dm9pZD4ge1xuICAgIHJldHVybiB0aGlzLmV2ZW50YnVzLmRpc3Bvc2VSZW1vdGVPYmplY3QuYXBwbHkodGhpcy5ldmVudGJ1cywgYXJncyk7XG4gIH1cblxuICAvLyBEZWxlZ2F0ZSBtYXJzaGFsbGluZyB0byB0aGUgTnVjbGlkZVJlbW90ZUV2ZW50YnVzIGNsYXNzLlxuICBtYXJzaGFsKC4uLmFyZ3MpOiBhbnkge1xuICAgIHJldHVybiB0aGlzLmV2ZW50YnVzLm1hcnNoYWwoLi4uYXJncyk7XG4gIH1cbiAgdW5tYXJzaGFsKC4uLmFyZ3MpOiBhbnkge1xuICAgIHJldHVybiB0aGlzLmV2ZW50YnVzLnVubWFyc2hhbCguLi5hcmdzKTtcbiAgfVxuICByZWdpc3RlclR5cGUoLi4uYXJncyk6IHZvaWQge1xuICAgIHJldHVybiB0aGlzLmV2ZW50YnVzLnJlZ2lzdGVyVHlwZSguLi5hcmdzKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBNYWtlIHJwYyBjYWxsIHRvIHNlcnZpY2UgZ2l2ZW4gc2VydmljZVVyaSBpbiBmb3JtIG9mIGAkc2VydmljZU5hbWUvJG1ldGhvZE5hbWVgIGFuZCBhcmdzIGFzIGFyZ3VtZW50cyBsaXN0LlxuICAgKi9cbiAgbWFrZVJwYyhzZXJ2aWNlVXJpOiBzdHJpbmcsIGFyZ3M6IEFycmF5PGFueT4sIHNlcnZpY2VPcHRpb25zOiBhbnkpOiBQcm9taXNlPGFueT4ge1xuICAgIGNvbnN0IFtzZXJ2aWNlTmFtZSwgbWV0aG9kTmFtZV0gPSBzZXJ2aWNlVXJpLnNwbGl0KCcvJyk7XG4gICAgcmV0dXJuIHRoaXMuZXZlbnRidXMuY2FsbFNlcnZpY2VGcmFtZXdvcmtNZXRob2QoXG4gICAgICBzZXJ2aWNlTmFtZSxcbiAgICAgIG1ldGhvZE5hbWUsXG4gICAgICAvKiBtZXRob2RBcmdzICovIGFyZ3MsXG4gICAgICAvKiBzZXJ2aWNlT3B0aW9ucyAqLyBzZXJ2aWNlT3B0aW9uc1xuICAgKTtcbiAgfVxuXG4gIHJlZ2lzdGVyRXZlbnRMaXN0ZW5lcihldmVudE5hbWU6IHN0cmluZywgY2FsbGJhY2s6ICguLi5hcmdzOiBBcnJheTxhbnk+KSA9PiB2b2lkLCBzZXJ2aWNlT3B0aW9uczogYW55KTogRGlzcG9zYWJsZSB7XG4gICAgcmV0dXJuIHRoaXMuZXZlbnRidXMucmVnaXN0ZXJFdmVudExpc3RlbmVyKGV2ZW50TmFtZSwgY2FsbGJhY2ssIHNlcnZpY2VPcHRpb25zKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBTZWFyY2hlcyB0aGUgY29udGVudHMgb2YgYGRpcmVjdG9yeWAgZm9yIHBhdGhzIG1hdGhpbmcgYHF1ZXJ5YC5cbiAgICovXG4gIGFzeW5jIHNlYXJjaERpcmVjdG9yeShkaXJlY3Rvcnk6IHN0cmluZywgcXVlcnk6IHN0cmluZyk6IFByb21pc2U8YW55PiB7XG4gICAgcmV0dXJuIGF3YWl0IHRoaXMuZXZlbnRidXMuY2FsbE1ldGhvZChcbiAgICAgIC8qc2VydmljZU5hbWUqLyAnc2VhcmNoJyxcbiAgICAgIC8qbWV0aG9kTmFtZSovICdkaXJlY3RvcnknLFxuICAgICAgLyptZXRob2RBcmdzKi8gW2RpcmVjdG9yeSwgcXVlcnldLFxuICAgICAgLypleHRyYU9wdGlvbnMqLyB7anNvbjogdHJ1ZX1cbiAgICApO1xuICB9XG5cbiAgZG9TZWFyY2hRdWVyeShyb290RGlyZWN0b3J5OnN0cmluZywgcHJvdmlkZXI6IHN0cmluZywgcXVlcnk6IHN0cmluZyk6IFByb21pc2Uge1xuICAgIHJldHVybiB0aGlzLmV2ZW50YnVzLmNhbGxNZXRob2QoXG4gICAgICAvKnNlcnZpY2VOYW1lKi8gJ3NlYXJjaCcsXG4gICAgICAvKm1ldGhvZE5hbWUqLyAncXVlcnknLFxuICAgICAgLyptZXRob2RBcmdzKi8gW3Jvb3REaXJlY3RvcnksIHByb3ZpZGVyLCBxdWVyeV0sXG4gICAgICAvKmV4dHJhT3B0aW9ucyovIHttZXRob2Q6ICdQT1NUJywganNvbjogdHJ1ZX1cbiAgICApO1xuICB9XG5cbiAgYXN5bmMgZ2V0U2VhcmNoUHJvdmlkZXJzKHJvb3REaXJlY3Rvcnk6IHN0cmluZyk6IFByb21pc2U8QXJyYXk8e25hbWU6c3RyaW5nfT4+IHtcbiAgICBsZXQgcHJvdmlkZXJzID0gdGhpcy5fc2VhcmNoUHJvdmlkZXJzW3Jvb3REaXJlY3RvcnldO1xuICAgIGlmIChwcm92aWRlcnMpIHtcbiAgICAgIHJldHVybiBwcm92aWRlcnM7XG4gICAgfVxuICAgIHByb3ZpZGVycyA9IGF3YWl0IHRoaXMuZXZlbnRidXMuY2FsbE1ldGhvZChcbiAgICAgIC8qc2VydmljZU5hbWUqLyAnc2VhcmNoJyxcbiAgICAgIC8qbWV0aG9kTmFtZSovICdsaXN0UHJvdmlkZXJzJyxcbiAgICAgIC8qbWV0aG9kQXJncyovIFtyb290RGlyZWN0b3J5XSxcbiAgICAgIC8qZXh0cmFPcHRpb25zKi8ge21ldGhvZDogJ1BPU1QnLCBqc29uOiB0cnVlfVxuICAgICk7XG5cbiAgICB0aGlzLl9zZWFyY2hQcm92aWRlcnNbcm9vdERpcmVjdG9yeV0gPSBwcm92aWRlcnM7XG5cbiAgICByZXR1cm4gcHJvdmlkZXJzO1xuICB9XG5cbiAgY2xvc2UoKSA6IHZvaWQge1xuICAgIGlmICh0aGlzLmV2ZW50YnVzKSB7XG4gICAgICB0aGlzLmV2ZW50YnVzLmNsb3NlKCk7XG4gICAgICB0aGlzLmV2ZW50YnVzID0gbnVsbDtcbiAgICB9XG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBOdWNsaWRlQ2xpZW50O1xuIl19\n","/home/travis/build/npmtest/node-npmtest-nuclide-server/node_modules/nuclide-server/lib/NuclideLocalEventbus.js":"\n/*\n * Copyright (c) 2015-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the license found in the LICENSE file in\n * the root directory of this source tree.\n */\n\nvar _createClass = (function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ('value' in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; })();\n\nvar _get = function get(_x2, _x3, _x4) { var _again = true; _function: while (_again) { var object = _x2, property = _x3, receiver = _x4; desc = parent = getter = undefined; _again = false; if (object === null) object = Function.prototype; var desc = Object.getOwnPropertyDescriptor(object, property); if (desc === undefined) { var parent = Object.getPrototypeOf(object); if (parent === null) { return undefined; } else { _x2 = parent; _x3 = property; _x4 = receiver; _again = true; continue _function; } } else if ('value' in desc) { return desc.value; } else { var getter = desc.get; if (getter === undefined) { return undefined; } return getter.call(receiver); } } };\n\nfunction _asyncToGenerator(fn) { return function () { var gen = fn.apply(this, arguments); return new Promise(function (resolve, reject) { var callNext = step.bind(null, 'next'); var callThrow = step.bind(null, 'throw'); function step(key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(callNext, callThrow); } } callNext(); }); }; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError('Cannot call a class as a function'); } }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== 'function' && superClass !== null) { throw new TypeError('Super expression must either be null or a function, not ' + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar _require = require('events');\n\nvar EventEmitter = _require.EventEmitter;\n\nvar _require2 = require('./config');\n\nvar loadConfigsOfServiceWithoutServiceFramework = _require2.loadConfigsOfServiceWithoutServiceFramework;\n\nvar NuclideLocalEventbus = (function (_EventEmitter) {\n  _inherits(NuclideLocalEventbus, _EventEmitter);\n\n  function NuclideLocalEventbus() {\n    var _this = this;\n\n    var options = arguments.length <= 0 || arguments[0] === undefined ? {} : arguments[0];\n\n    _classCallCheck(this, NuclideLocalEventbus);\n\n    _get(Object.getPrototypeOf(NuclideLocalEventbus.prototype), 'constructor', this).call(this);\n    this._options = options;\n    this._services = {};\n\n    this._enabledServices = loadConfigsOfServiceWithoutServiceFramework();\n\n    this._enabledServices.forEach(function (service_path) {\n      var _require3 = require(service_path);\n\n      var services = _require3.services;\n\n      for (var serviceId in services) {\n        _this._services[serviceId] = services[serviceId];\n      }\n    });\n\n    // Run initialize after all services registered if exists.\n    this._enabledServices.forEach(function (service_path) {\n      var _require4 = require(service_path);\n\n      var initialize = _require4.initialize;\n\n      if (initialize) {\n        initialize(_this);\n      }\n    });\n\n    var _require5 = require('nuclide-commons');\n\n    var fsPromise = _require5.fsPromise;\n\n    // readFile and writeFile aren't exposed as services for performance optimization.\n    this._services['/fs/readFile'] = { handler: fsPromise.readFile };\n    this._services['/fs/writeFile'] = { handler: fsPromise.writeFile };\n  }\n\n  _createClass(NuclideLocalEventbus, [{\n    key: 'testConnection',\n    value: function testConnection() {\n      return Promise.resolve();\n    }\n  }, {\n    key: 'callMethod',\n    value: _asyncToGenerator(function* (serviceName, methodName, methodArgs, extraOptions) {\n\n      var serviceId = '/' + serviceName + '/' + methodName;\n      // extend the default options with the extra options\n      var service = this._services[serviceId];\n      if (!service) {\n        throw new Error('Cannot call a non registered local service with id: ' + serviceId);\n      }\n      return service.handler.apply(this, methodArgs);\n    })\n  }, {\n    key: 'callService',\n    value: function callService(serviceName, args) {\n      var serviceFunction = this._services[serviceName];\n      if (!serviceFunction) {\n        throw Error('No service registered with name: ' + serviceName);\n      }\n      return serviceFunction.handler.apply(this, args);\n    }\n  }, {\n    key: 'close',\n    value: function close() {\n      var _this2 = this;\n\n      this._enabledServices.forEach(function (service_path) {\n        var _require6 = require(service_path);\n\n        var shutdown = _require6.shutdown;\n\n        if (shutdown) {\n          shutdown(_this2);\n        }\n      });\n    }\n  }]);\n\n  return NuclideLocalEventbus;\n})(EventEmitter);\n\nmodule.exports = NuclideLocalEventbus;\n//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi92YXIvZm9sZGVycy94Zi9yc3BoNF9jNTczMTVyczU3eHhzZHNrcnhudjM2dDAvVC90bXBwZmw1Mm5wdWJsaXNoX3BhY2thZ2VzL25wbS9udWNsaWRlLXNlcnZlci9saWIvTnVjbGlkZUxvY2FsRXZlbnRidXMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsV0FBVyxDQUFDOzs7Ozs7Ozs7Ozs7Ozs7Ozs7OztlQVdXLE9BQU8sQ0FBQyxRQUFRLENBQUM7O0lBQWpDLFlBQVksWUFBWixZQUFZOztnQkFFbUMsT0FBTyxDQUFDLFVBQVUsQ0FBQzs7SUFBbEUsMkNBQTJDLGFBQTNDLDJDQUEyQzs7SUFJNUMsb0JBQW9CO1lBQXBCLG9CQUFvQjs7QUFDYixXQURQLG9CQUFvQixHQUNFOzs7UUFBZCxPQUFPLHlEQUFHLEVBQUU7OzBCQURwQixvQkFBb0I7O0FBRXRCLCtCQUZFLG9CQUFvQiw2Q0FFZDtBQUNSLFFBQUksQ0FBQyxRQUFRLEdBQUcsT0FBTyxDQUFDO0FBQ3hCLFFBQUksQ0FBQyxTQUFTLEdBQUcsRUFBRSxDQUFDOztBQUVwQixRQUFJLENBQUMsZ0JBQWdCLEdBQUcsMkNBQTJDLEVBQUUsQ0FBQzs7QUFFdEUsUUFBSSxDQUFDLGdCQUFnQixDQUFDLE9BQU8sQ0FBQyxVQUFDLFlBQVksRUFBSztzQkFDM0IsT0FBTyxDQUFDLFlBQVksQ0FBQzs7VUFBakMsUUFBUSxhQUFSLFFBQVE7O0FBQ2YsV0FBSyxJQUFNLFNBQVMsSUFBSSxRQUFRLEVBQUU7QUFDaEMsY0FBSyxTQUFTLENBQUMsU0FBUyxDQUFDLEdBQUcsUUFBUSxDQUFDLFNBQVMsQ0FBQyxDQUFDO09BQ2pEO0tBQ0YsQ0FBQyxDQUFDOzs7QUFHSCxRQUFJLENBQUMsZ0JBQWdCLENBQUMsT0FBTyxDQUFDLFVBQUMsWUFBWSxFQUFLO3NCQUN6QixPQUFPLENBQUMsWUFBWSxDQUFDOztVQUFuQyxVQUFVLGFBQVYsVUFBVTs7QUFDakIsVUFBSSxVQUFVLEVBQUU7QUFDZCxrQkFBVSxPQUFNLENBQUM7T0FDbEI7S0FDRixDQUFDLENBQUM7O29CQUVpQixPQUFPLENBQUMsaUJBQWlCLENBQUM7O1FBQXZDLFNBQVMsYUFBVCxTQUFTOzs7QUFHaEIsUUFBSSxDQUFDLFNBQVMsQ0FBQyxjQUFjLENBQUMsR0FBRyxFQUFDLE9BQU8sRUFBRSxTQUFTLENBQUMsUUFBUSxFQUFDLENBQUM7QUFDL0QsUUFBSSxDQUFDLFNBQVMsQ0FBQyxlQUFlLENBQUMsR0FBRyxFQUFDLE9BQU8sRUFBRSxTQUFTLENBQUMsU0FBUyxFQUFDLENBQUM7R0FDbEU7O2VBNUJHLG9CQUFvQjs7V0E4QlYsMEJBQWtCO0FBQzlCLGFBQU8sT0FBTyxDQUFDLE9BQU8sRUFBRSxDQUFDO0tBQzFCOzs7NkJBRWUsV0FDWixXQUFtQixFQUNuQixVQUFrQixFQUNsQixVQUF1QixFQUN2QixZQUFrQixFQUNHOztBQUV2QixVQUFNLFNBQVMsR0FBRyxHQUFHLEdBQUcsV0FBVyxHQUFHLEdBQUcsR0FBRyxVQUFVLENBQUM7O0FBRXZELFVBQU0sT0FBTyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUMsU0FBUyxDQUFDLENBQUM7QUFDMUMsVUFBSSxDQUFDLE9BQU8sRUFBRTtBQUNaLGNBQU0sSUFBSSxLQUFLLENBQUMsc0RBQXNELEdBQUcsU0FBUyxDQUFDLENBQUM7T0FDckY7QUFDRCxhQUFPLE9BQU8sQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxVQUFVLENBQUMsQ0FBQztLQUNoRDs7O1dBRVUscUJBQUMsV0FBbUIsRUFBRSxJQUFnQixFQUFnQjtBQUMvRCxVQUFNLGVBQWUsR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQyxDQUFDO0FBQ3BELFVBQUksQ0FBQyxlQUFlLEVBQUU7QUFDcEIsY0FBTSxLQUFLLENBQUMsbUNBQW1DLEdBQUcsV0FBVyxDQUFDLENBQUM7T0FDaEU7QUFDRCxhQUFPLGVBQWUsQ0FBQyxPQUFPLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztLQUNsRDs7O1dBRUksaUJBQVM7OztBQUNaLFVBQUksQ0FBQyxnQkFBZ0IsQ0FBQyxPQUFPLENBQUMsVUFBQyxZQUFZLEVBQUs7d0JBQzNCLE9BQU8sQ0FBQyxZQUFZLENBQUM7O1lBQWpDLFFBQVEsYUFBUixRQUFROztBQUNmLFlBQUksUUFBUSxFQUFFO0FBQ1osa0JBQVEsUUFBTSxDQUFDO1NBQ2hCO09BQ0YsQ0FBQyxDQUFDO0tBQ0o7OztTQWpFRyxvQkFBb0I7R0FBUyxZQUFZOztBQW9FL0MsTUFBTSxDQUFDLE9BQU8sR0FBRyxvQkFBb0IsQ0FBQyIsImZpbGUiOiIvdmFyL2ZvbGRlcnMveGYvcnNwaDRfYzU3MzE1cnM1N3h4c2Rza3J4bnYzNnQwL1QvdG1wcGZsNTJucHVibGlzaF9wYWNrYWdlcy9ucG0vbnVjbGlkZS1zZXJ2ZXIvbGliL051Y2xpZGVMb2NhbEV2ZW50YnVzLmpzIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBiYWJlbCc7XG4vKiBAZmxvdyAqL1xuXG4vKlxuICogQ29weXJpZ2h0IChjKSAyMDE1LXByZXNlbnQsIEZhY2Vib29rLCBJbmMuXG4gKiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICpcbiAqIFRoaXMgc291cmNlIGNvZGUgaXMgbGljZW5zZWQgdW5kZXIgdGhlIGxpY2Vuc2UgZm91bmQgaW4gdGhlIExJQ0VOU0UgZmlsZSBpblxuICogdGhlIHJvb3QgZGlyZWN0b3J5IG9mIHRoaXMgc291cmNlIHRyZWUuXG4gKi9cblxuY29uc3Qge0V2ZW50RW1pdHRlcn0gPSByZXF1aXJlKCdldmVudHMnKTtcblxuY29uc3Qge2xvYWRDb25maWdzT2ZTZXJ2aWNlV2l0aG91dFNlcnZpY2VGcmFtZXdvcmt9ID0gcmVxdWlyZSgnLi9jb25maWcnKTtcblxuXG5cbmNsYXNzIE51Y2xpZGVMb2NhbEV2ZW50YnVzIGV4dGVuZHMgRXZlbnRFbWl0dGVyIHtcbiAgY29uc3RydWN0b3Iob3B0aW9ucyA9IHt9KSB7XG4gICAgc3VwZXIoKTtcbiAgICB0aGlzLl9vcHRpb25zID0gb3B0aW9ucztcbiAgICB0aGlzLl9zZXJ2aWNlcyA9IHt9O1xuXG4gICAgdGhpcy5fZW5hYmxlZFNlcnZpY2VzID0gbG9hZENvbmZpZ3NPZlNlcnZpY2VXaXRob3V0U2VydmljZUZyYW1ld29yaygpO1xuXG4gICAgdGhpcy5fZW5hYmxlZFNlcnZpY2VzLmZvckVhY2goKHNlcnZpY2VfcGF0aCkgPT4ge1xuICAgICAgY29uc3Qge3NlcnZpY2VzfSA9IHJlcXVpcmUoc2VydmljZV9wYXRoKTtcbiAgICAgIGZvciAoY29uc3Qgc2VydmljZUlkIGluIHNlcnZpY2VzKSB7XG4gICAgICAgIHRoaXMuX3NlcnZpY2VzW3NlcnZpY2VJZF0gPSBzZXJ2aWNlc1tzZXJ2aWNlSWRdO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gUnVuIGluaXRpYWxpemUgYWZ0ZXIgYWxsIHNlcnZpY2VzIHJlZ2lzdGVyZWQgaWYgZXhpc3RzLlxuICAgIHRoaXMuX2VuYWJsZWRTZXJ2aWNlcy5mb3JFYWNoKChzZXJ2aWNlX3BhdGgpID0+IHtcbiAgICAgIGNvbnN0IHtpbml0aWFsaXplfSA9IHJlcXVpcmUoc2VydmljZV9wYXRoKTtcbiAgICAgIGlmIChpbml0aWFsaXplKSB7XG4gICAgICAgIGluaXRpYWxpemUodGhpcyk7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICBjb25zdCB7ZnNQcm9taXNlfSA9IHJlcXVpcmUoJ251Y2xpZGUtY29tbW9ucycpO1xuXG4gICAgLy8gcmVhZEZpbGUgYW5kIHdyaXRlRmlsZSBhcmVuJ3QgZXhwb3NlZCBhcyBzZXJ2aWNlcyBmb3IgcGVyZm9ybWFuY2Ugb3B0aW1pemF0aW9uLlxuICAgIHRoaXMuX3NlcnZpY2VzWycvZnMvcmVhZEZpbGUnXSA9IHtoYW5kbGVyOiBmc1Byb21pc2UucmVhZEZpbGV9O1xuICAgIHRoaXMuX3NlcnZpY2VzWycvZnMvd3JpdGVGaWxlJ10gPSB7aGFuZGxlcjogZnNQcm9taXNlLndyaXRlRmlsZX07XG4gIH1cblxuICB0ZXN0Q29ubmVjdGlvbigpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCk7XG4gIH1cblxuICBhc3luYyBjYWxsTWV0aG9kKFxuICAgICAgc2VydmljZU5hbWU6IHN0cmluZyxcbiAgICAgIG1ldGhvZE5hbWU6IHN0cmluZyxcbiAgICAgIG1ldGhvZEFyZ3M6ID9BcnJheTxhbnk+LFxuICAgICAgZXh0cmFPcHRpb25zOiA/YW55XG4gICAgKTogUHJvbWlzZTxzdHJpbmd8YW55PiB7XG5cbiAgICBjb25zdCBzZXJ2aWNlSWQgPSAnLycgKyBzZXJ2aWNlTmFtZSArICcvJyArIG1ldGhvZE5hbWU7XG4gICAgLy8gZXh0ZW5kIHRoZSBkZWZhdWx0IG9wdGlvbnMgd2l0aCB0aGUgZXh0cmEgb3B0aW9uc1xuICAgIGNvbnN0IHNlcnZpY2UgPSB0aGlzLl9zZXJ2aWNlc1tzZXJ2aWNlSWRdO1xuICAgIGlmICghc2VydmljZSkge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKCdDYW5ub3QgY2FsbCBhIG5vbiByZWdpc3RlcmVkIGxvY2FsIHNlcnZpY2Ugd2l0aCBpZDogJyArIHNlcnZpY2VJZCk7XG4gICAgfVxuICAgIHJldHVybiBzZXJ2aWNlLmhhbmRsZXIuYXBwbHkodGhpcywgbWV0aG9kQXJncyk7XG4gIH1cblxuICBjYWxsU2VydmljZShzZXJ2aWNlTmFtZTogc3RyaW5nLCBhcmdzOiBBcnJheTxhbnk+KTogUHJvbWlzZTxhbnk+IHtcbiAgICBjb25zdCBzZXJ2aWNlRnVuY3Rpb24gPSB0aGlzLl9zZXJ2aWNlc1tzZXJ2aWNlTmFtZV07XG4gICAgaWYgKCFzZXJ2aWNlRnVuY3Rpb24pIHtcbiAgICAgIHRocm93IEVycm9yKCdObyBzZXJ2aWNlIHJlZ2lzdGVyZWQgd2l0aCBuYW1lOiAnICsgc2VydmljZU5hbWUpO1xuICAgIH1cbiAgICByZXR1cm4gc2VydmljZUZ1bmN0aW9uLmhhbmRsZXIuYXBwbHkodGhpcywgYXJncyk7XG4gIH1cblxuICBjbG9zZSgpOiB2b2lkIHtcbiAgICB0aGlzLl9lbmFibGVkU2VydmljZXMuZm9yRWFjaCgoc2VydmljZV9wYXRoKSA9PiB7XG4gICAgICBjb25zdCB7c2h1dGRvd259ID0gcmVxdWlyZShzZXJ2aWNlX3BhdGgpO1xuICAgICAgaWYgKHNodXRkb3duKSB7XG4gICAgICAgIHNodXRkb3duKHRoaXMpO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gTnVjbGlkZUxvY2FsRXZlbnRidXM7XG4iXX0=\n","/home/travis/build/npmtest/node-npmtest-nuclide-server/node_modules/nuclide-server/lib/nuclide-main.js":"/*\n * Copyright (c) 2015-present, Facebook, Inc.\n * All rights reserved.\n *\n * This source code is licensed under the license found in the LICENSE file in\n * the root directory of this source tree.\n */\n\n/**\n * This is the main insertion point for starting nuclide-server.\n */\n\n// Set up the on-the-fly transpiler.\nrequire('nuclide-node-transpiler');\n\n// Load the ES6+ server code now that the transpiler is in place.\nrequire('./main');\n"}